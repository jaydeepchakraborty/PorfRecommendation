BibTeX:

Combining a Gauss-Markov model and Gaussian process
for traffic prediction in Dublin city center
FranÃ§ois Schnitzler

Thomas Liebig

Technion
Fishbach Building
32000 Haifa, Israel

TU Dortmund University
Artificial Intelligence Group
Dortmund, Germany

Shie Mannor

thomas.liebig@tudortmund.de
Katharina Morik

Technion
Fishbach Building
32000 Haifa, Israel

TU Dortmund University
Artificial Intelligence Group
Dortmund, Germany

francois@ee.technion.ac.il

shie@ee.technion.ac.il
ABSTRACT
We consider a city where induction-based vehicle count sensors are installed at some, but not all street junctions. Each
sensor regularly outputs a count and a saturation value. We
first use a discrete time Gauss-Markov model based on historical data to predict the evolution of these saturation values, and then a Gaussian Process derived from the street
graph to extend these predictions to all junctions. We construct this model based on real data collected in Dublin city.

Categories and Subject Descriptors
G.3 [Probability and Statistics]: Markov processes, multivariate statistics, stochastic processes, time series analysis;
I.2.6 [Artificial Intelligence]: Learningâ€”parameter learning; J.7 [Computer in Other Systems]: Real time

Keywords
traffic prediction, Gaussian Process, Gauss-Markov, autoregressive, smart cities, time series, spatio-temporal

1.

INTRODUCTION

In the Greater Dublin Area, 750 (4%) junctions are covered by one or several SCATS (Sydney Co-ordinated Adaptive Traffic System) vehicle count sensors. Our goal is to
provide estimates of the saturation at each junction, for the
current and future times, whereas our previous work [1] only
did so for each junction at the current time.
High traffic saturation (cars/km) co-occurs with low traffic flux (cars/hour) and is an indicator for congestions [3].

(c) 2014, Copyright is with the authors. Published in the Workshop Proceedings of the EDBT/ICDT 2014 Joint Conference (March 28, 2014,
Athens, Greece) on CEUR-WS.org (ISSN 1613-0073). Distribution of this
paper is permitted under the terms of the Creative Commons license CCby-nc-nd 4.0.

katharina.morik@tudortmund.de
observed measurement, at current time
predicted measurement for a future time step
predicted value for an unobserved junction
GaussMarkov
Section 2
current time

Gaussian
Process
Section 3
future time steps

Figure 1: Future measurements are estimated by
a Gauss-Markov process (Section 2). Estimates for
junctions without sensors, are provided by a Gaussian Process (Section 3).

Our work can be used for online signaling and trip planning.
The urban street network is a graph (V, E), where the
vertices V are the junctions and the edges E the street segments. Let u be the set of unobserved junctions, with no
SCATS sensor, and âˆ’u = V \u the junctions with sensors.
The saturation of a junction vi at a time t is a continuous
random variable yi,t . Furthermore, yu,t â‰¡ {yi,t }i:vi âˆˆu .
We combine two components to obtain an estimate of the
saturation of all junctions at future time steps, yV,t+âˆ†t , conditioned on the current observations, yâˆ’u,t (âˆ†t âˆˆ N0 ).
The first one, P (yâˆ’u,t+âˆ†t |yâˆ’u,t ), models historical measurements. It can estimate future measurements yÌ‚âˆ’u,t+âˆ†t ,
based on the current observations yÌ‚âˆ’u,t :
yÌ‚âˆ’u,t+âˆ†t = E(yâˆ’u,t+âˆ†t |yÌ‚âˆ’u,t ) .

(1)

The second is a Gaussian Process (GP) based on the street
network and defining a multivariate Gaussian distribution
P (yV,t ) over the saturations at all junctions. Conditioning
this distribution on yâˆ’u provides P (yu,t+âˆ†t |yâˆ’u,t+âˆ†t ) and
allows to estimate saturations at junctions without sensors:
P (yu,t+âˆ†t |yâˆ’u,t ) â‰ˆ P (yu,t+âˆ†t |yÌ‚âˆ’u,t+âˆ†t ) .
Figure 1 illustrates the resulting prediction procedure.

(2)

2.

GAUSS-MARKOV

x1 âˆ¼ N (yÌ„0 , Î£0 ), a multivariate Gaussian distribution of
mean yÌ„0 and covariance matrix Î£0 . The Kalman filter can
compute P (yt+âˆ†t |yt ) = N (yÌ‚t+âˆ†t , Î£Ì‚t+âˆ†t ) recursively.
Sensor measurements were collected from 2013-01-01 to
2013-05-141 by 512 (470 non trivial ones) vehicle count sensors located in central Dublin. We average all measurements
received on non-overlapping 4 minutes intervals, because of
missing values, and model the resulting averages from 5am
to 12am. The parameters At , wÌ„t , Î£wt change for every time
step but are identical for every day. So are yÌ„0 and Î£0 .
Following the methodology of [6], each matrix At is learned
using (averaged) measurements for t0 âˆˆ {t âˆ’ Î´t , . . . , t + Î´t },
weighted by a Gaussian kernel: exp(âˆ’(t âˆ’ t0 )2 /Î´t ). We arbitrarily use Î´t = 3. For each matrix At , each row ri,t is estimated using an elastic net [7] and ten-fold cross-validation.
Î£0 and each Î£wt are diagonal covariance matrices estimated
by maximum likelihood. Alternatively, penalized estimation
algorithms such as the graphical lasso [2] could be used.

A similar approach was proposed to provide dynamic cost
predictions for a trip planner in the same workshop [4]. Instead of a linear dynamical system (LDS), a spatio-temporal
Markov random field (STMRF) is used. It models discretized
saturation values only, and inference is approximated by belief propagation whereas it is computationally tractable and
performed exactly in LDS. Our model also has a finer temporal resolution. Therefore, it can be used for signaling or
online adaptation of the route in addition to offline trip planning. Comparing these two models in terms of precision and
speed would be interesting.
The Gauss Markov model assumes the dynamics are linear, first-order Markov and perturbed by Gaussian noise.
More refined models could be considered and might lead to
better estimations.In particular, we could assume the measurements are noisy observations of a hidden process.
Other information could also be leveraged. For example,
the street network could be used to derive a prior on the coefficient of the transition matrix, influencing the model only.
Irregular, pointwise traffic estimation (for example based on
mobile phones or GPS) could be integrated into the Gaussian Process to produce finer saturation estimates. Finally,
different dynamics could be estimated and used in the presence or the absence of rain, modifying both the model and
the estimation process.

3.

5.

A linear dynamical system models the evolution of a set
of state variables y âˆˆ Rp , where we omit the subscript âˆ’u:
yt+1 = At yt + wt
wt âˆ¼ N (wÌ„t , Î£wt ) .

(3)
(4)

GAUSSIAN PROCESS

P (yu,t+âˆ†t |yâˆ’u,t+âˆ†t ) is derived from a GP regression framework modeling traffic saturation values of all junctions at a
given time, similar to [5]. Multiple sensors at a junction are
averaged. For each vertex vi , we introduce a latent variable
fi , the true traffic saturation at vi :
yi = fi + i

(5)
2

i âˆ¼ N (0, Ïƒ ) .

(6)

We assume that the random vector of all latent variables
follows a GP: any finite set f = {fi }i=1,...,M has a multivariate Gaussian distribution. Therefore, the vector of observed
traffic saturations (yâˆ’u ) and unobserved traffic saturations
(du ) follows a Gaussian distribution


 

yâˆ’u
Kâˆ’u,âˆ’u + Ïƒ 2 I Kâˆ’u,u
âˆ¼ N 0,
,
(7)
du
Ku,âˆ’u
Ku,u
where I is an identity matrix, K the so-called kernel and
Ku,âˆ’u , Kâˆ’u,âˆ’u , Ku,u , and Kâˆ’u,u the corresponding entries
of K. Conditioning on y produces P (yu,t+âˆ†t |yâˆ’u,t+âˆ†t ).
We use the common regularized Laplacian kernel function

âˆ’1
K = Î²(L + I/Î±2 )
,
(8)
where Î± and Î² are hyperparameters. L denotes the combinatorial Laplacian, L = D âˆ’ G. G denotes the adjacency
matrixP
of the graph G and D a diagonal matrix with entries
di,i = j Gi,j . Variables adjacent in G are highly correlated.

4.

DISCUSSION

We have described a combination of two models able to
respectively predict future traffic saturations at junctions
with sensors and to extend these predictions to junctions
without sensors, in a city. To the best of our knowledge, no
similar model has been proposed before.
1

http://dublinked.ie/datastore/datasets/dataset-305.php

ACKNOWLEDGMENTS

This work was supported by the European FP7 project
INSIGHT under grant 318225.

6.

REFERENCES

[1] A. Artikis, M. Weidlich, F. Schnitzler, I. Boutsis,
T. Liebig, N. Piatkowski, C. Bockermann, K. Morik,
V. Kalogeraki, J. Marecek, A. Gal, S. Mannor,
D. Gunopulos, and D. Kinane. Heterogeneous stream
processing and crowdsourcing for urban traffic
management. In Proceedings of the 17th International
Conference on Extending Database Technology, page (to
appear), 2014.
[2] J. Friedman, T. Hastie, and R. Tibshirani. Sparse
inverse covariance estimation with the graphical lasso.
Biostatistics, 9(3):432â€“441, 2008.
[3] W. Leutzbach. Introduction to the Theory of Traffic
Flow. Springer, 1988.
[4] T. Liebig, N. Piatkowski, C. Bokermann, and K. Morik.
Predictive trip planning â€“ smart routing in smart cities.
In Workshop Proceedings of the EDBT/ICDT 2014
Joint Conference, 2014.
[5] T. Liebig, Z. Xu, M. May, and S. Wrobel. Pedestrian
quantity estimation with trajectory patterns. In
Machine Learning and Knowledge Discovery in
Databases, volume 7524 of Lecture Notes in Computer
Science, pages 629â€“643. Springer Berlin Heidelberg,
2012.
[6] L. Song, M. Kolar, and E. P. Xing. Time-varying
dynamic bayesian networks. Advances in Neural
Information Processing Systems, 22:1732â€“1740, 2009.
[7] H. Zou and T. Hastie. Regularization and variable
selection via the elastic net. Journal of the Royal
Statistical Society: Series B (Statistical Methodology),
67(2):301â€“320, 2005.

