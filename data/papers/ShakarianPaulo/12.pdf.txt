Product Offerings in Malicious Hacker Markets
Ericsson Marin, Ahmad Diab and Paulo Shakarian
Arizona State University Tempe, Arizona {ericsson.marin, ahmad.diab, shak}@asu.edu

arXiv:1607.07903v1 [cs.CR] 26 Jul 2016

Abstract--Marketplaces specializing in malicious hacking products - including malware and exploits - have recently become more prominent on the darkweb and deepweb. We scrape 17 such sites and collect information about such products in a unified database schema. Using a combination of manual labeling and unsupervised clustering, we examine a corpus of products in order to understand their various categories and how they become specialized with respect to vendor and marketplace. This initial study presents how we effectively employed unsupervised techniques to this data as well as the types of insights we gained on various categories of malicious hacking products.

not trivial, including effort to answer questions, solve puzzles, mathematical equation or CAPTCHA. Most related work on darkweb markets such as [3] focus on a single market and do not restrict their study to malicious hacking products. Our previous work on markets [4] focused on a game theoretic analysis of a small subset of the data in this paper - and did not attempt to categorize the products for sale. Additionally, there is a complementary lines of work on malicious hacking forums (i.e. [5], [6], [7], [8], [9], [10], [11], [12]) - which is a related but different topic from this paper. II. M ALICIOUS H ACKING P RODUCT C ATEGORIZATION In this section, we describe our malicious hacker product dataset and our use of clustering to identify malicious hacker product categories. We examined 17 malicious hacker marketplaces crawled over a 6 month period. The crawled information was then parsed and stored in a relational database. Relevant tables record the marketplaces themselves, the vendors of the various products and the items/products for sale. Each item is associated with a vendor and a marketplace, allowing for join queries. Some of the more relevant fields for marketplace items include the price, title, description, rating, posting date. In this work, we primarily extract features from the product title/name to generate features. We note that many items are cross-posted and are nearly identical. We show the distribution of vendors who use the same screen-name across multiple marketplaces in Fig. 1(a). To clean our product data, we identify duplicate (cross-posted) products and report on the size of our dataset in Table I. As we collect data from a variety of different sites, there is inconsistency as to how products are categorized on each site - if such non-trivial categorization even exists for a given site. In addition, there is a clear absence of a standardized method for vendors to register their products. As a consequence, the great majority of products are unique when compared with simple matching or regular expression technique. It is valid even in the case where a pair of vendors with different screen names post what a human would determine to be the same product. Fig. 1(b) shows the distribution of products and number of vendors sharing each product. The distribution follows a power-law. Note that about 57% of products are unique by simple comparison methods. Clustering approach. Using product names, we engineer features that represent each product as a vector. A set of pilot experiments suggests that word and character n-grams

I. I NTRODUCTION Websites on the deepweb and darkweb specializing in the sale of malicious hacking products - such as malware platforms, software exploits and botnet rental - have become the venue of choice for online purchase of these items by cyber criminals. In this paper, we leverage unsupervised learning to categorize and study the product offerings of 17 of these online markets. Specifically, we describe how we used manual labeling combined with clustering techniques to identify product categories (Section II), and then we analyze the results both quantitatively and qualitatively (Section III). We identify categories of products that are highly specialized with respect to particular vendors and markets. We also highlight other interesting facets of this ecosystem - for instance, vendors who habitually cross-list products on multiple sites and nearly identical products for sale by multiple vendors. Background and Related Work. The darkweb refers to the anonymous communication provided by crypto-network tools such as "The Onion Router" (Tor), which is free software dedicated to protect the privacy of its users by obscuring traffic analysis as a form of network surveillance [1]. On the other hand, the deepweb refers to sites not indexed by common search engines due to a variety of reasons (e.g. password protections), that not necessarily rely on additional protocols. The sites on the darkweb and deepweb explored in this study comprise marketplaces [2]. In these websites, vendors advertise and sell their goods and services relating to malicious hacking, drugs, pornography, weapons and software services. Products are most often verified before any funds are released to the seller. The main engine of these environments is trust. If a seller is misleading or fails to deliver the appropriate item, he is banned from the site. Similarly, buyers can be banned for not complying with the transaction rules. Basically, all marketplaces in darkweb require a registration and a valid account to get access. Sometimes, this registration process is

TABLE I S CRAPED DATA FROM M ARKETPLACES IN DARKWEB . Marketplaces Products (Total) Products (Distinct) Vendors
60
10000

17 16122 9093 1332

50
1000

30
20 10 0 0 2 4 6

Number of Products

40

100

10

1

Markets
(a)

8

10 12 14 16 18

0 2 4 6 8 10 12 14 16 18 20 22 24

Number of Shared Vendors
(b)

Fig. 1. Distribution of (a) Shared Vendors over Markets. (b) Products over Shared Vendors.

Table II shows the performance of each TF-IDF vectorization using Rand-index and entropy, when K-means starts with the 34 fixed centroids. For Rand-index, character ngrams in the range from 3 to 4, 3 to 5, and 3 to 6, when Kmeans used cosine similarity reached a high best performance (0.986). In addition, we also found the best entropy (0.067) when K-means uses the same specification. This way, K-means configuration with character n-grams in the range from 3 to 6 for vectorization, cosine similarity for distance function and the 34 points for the starting centroids was our natural choice to produce the clusters in the entire dataset. We also examined the performance of our approach using random centroids. As expected, it performs worse than using the centroids derived from products. Additionally, we examined products (from the full dataset) with a cosine similarity of less than 0.1 from the calculated centroids. There were 410 such distinct products (4.51% of the dataset). These were then manually examined and most were found to be irrelevant to our target domain - and we did not consider them further. III. A NALYST I NTERPRETATION OF P RODUCT C LUSTERS

would provide more pure clusters compared with other feature engineering methods, such as meta-data or domain-specific keywords. These features were valued using standard term frequency - inverse document frequency (TF-IDF), after the elimination of stopping words and the execution of steaming. We evaluated word n-gram feature vectors of length up to 1 and up to 2 words and many character n-gram features in the ranges from 3 to 7 and from 4 to 7. This gave us 10 different feature vectors in all. To verify which of these strategies could reach the best performance in our dataset, we evaluated the effect of the different types of feature vectors on the accuracy and purity of clusters produced by the K-means algorithm. To determine the best feature vector, we manually labeled 500 samples using 34 labeled groups (listed in Table III). We used 400 of the samples to determine centroids for each of the 34 groups, and then we evaluated the resulting clustering on the remaining 100 samples. We examined the accuracy of the different approaches when compared to ground truth using the Rand-index method [13]. This method is defined as the number of pairs correctly considered in the same class or correctly considered in different classes divided by n 2 , where n is the number of samples. In addition, we used standard entropy measurements to examine the purity of the clusters. Entropy measures the amount of disorder in a cluster. A zerovalue for this metric means the clusters are formed by just one class. The formal definition is as follows:
k

Number of Shared Vendors

entropy (Di ) = -
i=1

P ri (cj ) log2 P ri (cj ),

(1)

where P ri (cj ) is the proportion of class cj data points in cluster i or Di . The total entropy (considering all clusters) is:
k

entropytotal (D) =
i=1

|Di | x entropy (Di ) |D |

(2)

In this section, we examine the results of clustering based on character n-grams in the range 3 to 6 using initial centroids determined from the labeled data. In order to analyze the information of these clusters, we calculated their entropy with respect to two different criteria: marketplaces and vendors. We also checked in the database the number of distinct marketplaces and vendors inside each cluster. The idea was to understand the diversity of the clusters regarding these two facets. A low marketplace entropy for a given cluster would mean its products were mainly found in a particular marketplace. Similarly, low vendor entropy would mean the cluster's products were mainly sold by a particular vendor. Table III presents the results. As shown in Table III, Links holds the lowest entropy when we analyzed the marketplaces, suggesting the great majority of products come from the same market. In this cluster, 80% of products came from only 2 markets. However, when we check the vendor entropy for this same cluster, we can observe a higher value, suggesting that many vendors are actually offering products related to Links. It is possible that many markets discourage the re-selling of lists of links, as much of this information can be found on darkweb Wiki's for free. Similarly, Hacking Tools holds the lowest entropy for the vendor criteria. This suggest that only a few vendors are present in that cluster. Specifically, only 2 vendors author 416(50%) of this type of products. At first glance, this may be surprising as this appears to be a very general group. However, upon inspection of the contents, we find that many authors of these products are actually organizations. These organizations use similar language in their product description in an effort to brand their wares. This could indicate the presence of hackingcollectives that author products as well as the limitations of our text-based approach - which can potentially cluster products branded in a similar fashion. We also note one of the most

TABLE II K- MEANS E VALUATION (F IXED C ENTROIDS ).
word(1,1) 0.986 0.986 0.075 0.224 word(1,2) 0.985 0.977 0.079 0.110 char(3,4) 0.986 0.976 0.067 0.153 char(3,5) 0.986 0.973 0.067 0.156 Rand-index char(3,6) char(3,7) 0.986 0.985 0.973 0.974 Entropy 0.067 0.075 0.156 0.141 char(4,4) 0.985 0.975 0.072 0.134 char(4,5) 0.985 0.975 0.079 0.134 char(4,6) 0.984 0.977 0.088 0.137 char(4,7) 0.982 0.971 0.088 0.175 Random 0.933 0.933 0.423 0.423

Cosine Euclidean Cosine Euclidean

TABLE III C LUSTERS E NTROPY.
Rank 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 Cluster Name Carding PayPal-related Cashing Credit Cards PGP Netflix-related Hacking Tools - General Dumps - General Linux-related Email Hacking Tools Network Security Tools Ebay-related Amazon-related Bitcoin Links (Lists) Banking Point of Sale VPN Botnet Hacking Groups Invitation RATs Browser-related Physical Layer Hacking Password Cracking Smartphone - General Wireless Hacking Phishing Exploit Kits Viruses/Counter AntiVirus Network Layer Hacking RDP Servers Android-related Keyloggers Windows-related Facebook-related No of Products 1263 1103 867 865 846 825 749 561 547 539 472 456 443 422 384 375 272 257 251 249 249 237 230 223 222 218 218 210 205 191 156 143 119 119 No of Markets 16 16 16 15 14 15 12 16 13 15 15 16 15 12 13 15 12 12 14 15 12 13 13 14 13 13 14 14 14 12 11 13 12 15 Market Entropy 0.320 0.340 0.351 0.347 0.270 0.331 0.289 0.372 0.335 0.366 0.385 0.391 0.360 0.211 0.349 0.384 0.413 0.291 0.387 0.453 0.380 0.408 0.434 0.408 0.389 0.403 0.413 0.413 0.459 0.405 0.429 0.496 0.464 0.501 No of Vendors 315 335 256 203 351 132 280 117 196 117 163 197 201 221 186 181 130 110 143 99 134 122 100 110 56 111 91 60 60 124 60 77 50 67 Vendor Entropy 0.720 0.754 0.738 0.696 0.805 0.516 0.777 0.758 0.738 0.621 0.772 0.825 0.823 0.838 0.840 0.841 0.827 0.796 0.865 0.797 0.857 0.856 0.781 0.816 0.601 0.849 0.795 0.684 0.716 0.895 0.770 0.862 0.717 0.876

hacking products with respect to vendor and marketplace, and finally, we identified several interesting characteristics of how the products were grouped. Currently, we are examining other methods for grouping these products using matrix factorization and supervised techniques. Additionally, we are studying the underlying social network of vendors through relationships based on similar product offerings.
Acknowledgments. Some of the authors were supported by the Office of Naval Research (ONR) Neptune program, the Arizona State University Global Security Initiative (ASU GSI), and CNPq-Brazil.

R EFERENCES
[1] R. Dingledine, N. Mathewson, and P. Syverson, "Tor: The Secondgeneration Onion Router," in Proceedings of the 13th Conference on USENIX Security Symposium - Volume 13, ser. SSYM'04. Berkeley, CA, USA: USENIX Association, 2004, pp. 21­21. [2] V. Ciancaglini, M. Balduzzi, R. McArdle, and M. R¨ osler, "Below the Surface: Exploring the Deep Web," 2015. [3] N. Christin, "Traveling the silk road: A measurement analysis of a large anonymous online marketplace," in Proceedings of the 22Nd International Conference on World Wide Web, ser. WWW '13. New York, NY, USA: ACM, 2013, pp. 213­224. [4] J. Robertson, V. Paliath, J. Shakarian, A. Thart, and P. Shakarian, "Data Driven Game Theoretic Cyber Threat Mitigation," in Proc. 28th Innovative Applications of Artificial Intelligence (IAAI-16), 2016. [5] C. C. Yang, X. Tang, and X. Gong, "Identifying dark web clusters with temporal coherence analysis," in Intelligence and Security Informatics (ISI), 2011 IEEE International Conference on, July 2011, pp. 167­172. [6] V. Benjamin, W. Li, T. Holt, and H. Chen, "Exploring threats and vulnerabilities in hacker web: Forums, irc and carding shops," in Intelligence and Security Informatics (ISI), 2015 IEEE International Conference on, May 2015, pp. 85­90. [7] M. Macdonald, R. Frank, J. Mei, and B. Monk, "Identifying digital threats in a hacker web forum," in Proceedings of the 2015 IEEE/ACM International Conference on Advances in Social Networks Analysis and Mining 2015, ser. ASONAM '15. New York, NY, USA: ACM, 2015, pp. 926­933. [8] Z. Zhao, G.-J. Ahn, H. Hu, and D. Mahi, "SocialImpact: Systematic Analysis of Underground Social Dynamics." in ESORICS, ser. Lecture Notes in Computer Science, S. Foresti, M. Yung, and F. Martinelli, Eds., vol. 7459. Springer, 2012, pp. 877­894. [9] H. Chen, "Dark web: Exploring and mining the dark side of the web," in Intelligence and Security Informatics Conference (EISIC), 2011 European, Sept 2011, pp. 1­2. [10] J. Shakarian, P. Shakarian, and A. Ruef, "Cyber attacks and public embarrassment: A survey of some notable hacks," Elsevier SciTechConnect, 2015. [11] P. Shakarian and J. Shakarian, "Socio-cultural modeling for cyber threat actors," in AAAI Workshop on Artificial Intelligence and Cyber Security (AICS), 2016. [12] J. Shakarian, A. Gunn, and P. Shakarian, "Exploring malicious hacker forums," in Cyber Deception: Building the Scientific Foundation, S. Jajodia, V. Subrahmanian, V. Swarup, and C. Wang, Eds. Springer, 2016. [13] W. M. Rand, "Objective Criteria for the Evaluation of Clustering Methods," Journal of the American Statistical Association, vol. 66, no. 336, pp. 846­850, Dec. 1971.

prominent vendor in this cluster was itself a marketplace which is also reflected in the low marketplace entropy. In our analysis of the Facebook and Keylogger clusters, we can see that they point to the other direction. They have high values for both entropy, a clear sign about the diversity with respect to both vendors and markets. For example, in cluster Facebook, there were 119 products and 67 vendors, and the most prolific vendor for this cluster authored only 8 products. In the same cluster, products were also spread across 15 markets - and the most well-represented market was associated with 30 products. This analysis also indicates widespread prevalence of keyloggers - which is not surprising as it is a well established hacking technique. However, observing the similar trend for the Facebook cluster could be indicative of an increase in demand for Facebook-directed social media hacking products and information. Conclusion and Future Work. In this paper, we conducted an initial examination of malware products from 17 malicious hacker markets through unsupervised learning. Using manually-labeled data, we studied the effect of feature vector on cluster purity using text-based features. We then analyzed the impurity of clusters in our corpus of over 8, 000 malicious

