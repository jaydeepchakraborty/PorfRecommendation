1

Optimal estimation with missing observations via balanced time-symmetric stochastic models
Tryphon T. Georgiou, Fellow, IEEE and Anders Lindquist, Life Fellow, IEEE

arXiv:1503.06014v2 [math.OC] 18 Aug 2015

Abstract--We consider data fusion for the purpose of smoothing and interpolation based on observation records with missing data. Stochastic processes are generated by linear stochastic models. The paper begins by drawing a connection between time reversal in stochastic systems and all-pass extensions. A particular normalization (choice of basis) between the two timedirections allows the two to share the same orthonormalized state process and simplifies the mathematics of data fusion. In this framework we derive symmetric and balanced MayneFraser-like formulas that apply simultaneously to smoothing and interpolation.

overview of smoothing and interpolation theory in the context of stochastic realization theory see [18, Chapter 15]. In the present paper we are taking this program several steps further. Given intermittent observations of the output of a linear stochastic system over a finite interval, we want to determine the linear least-squares estimate of the state of the system in an arbitrary point in the interior of the interval, which may either be in a subinterval of missing data or in one where observations are available. Hence, this combines smoothing and interpolation over general patterns of available observations. Our main interest is in continuous-time (possibly time-varying) systems. However, the absence of data over subintervals, depending on the information pattern, may necessitate a hybrid approach involving discrete-time filtering steps. In studying the statistics of a process over an interval, it is natural to decompose the interface between past and future in a time-symmetric manner. This gives rise to systems representations of the process running in either time direction, forward or backward in time. This point was fundamental in early work in stochastic realization; see [18] and references therein. In a different context [19] a certain duality between the two timedirections in modeling a stochastic process was introduced in order to characterize solutions to moment problems. In this new setting the noise-process was general (not necessarily white), and the correspondence between the driving inputs to the two time-opposite models was shown to be captured by suitable dual all-pass dynamics. Here, we begin by combining these two sets of ideas to develop a general framework where two time-opposite stochastic systems model a given stochastic process. We study the relationship between these systems and the corresponding processes. In particular, we recover as a special case certain results of stochastic realization theory [11], [5], [6], [4] from the 1970's using a novel procedure. This theory provides a normalized and balanced version of the forward-backward duality which is essential for our new formulation of the two-filter Mayne-Fraser-like formula uniformly applicable to intervals with or without observations. The paper is structured as follows. In Section II we explain how a lifting of state-dynamics into an all-pass system allows direct correspondence between sample-paths of driving

I. I NTRODUCTION Data fusion is the process of integrating different data sets, or statistics, into a more accurate representation for a quantity of interest. A case in point in the context of systems and control is provided by the Mayne-Fraser two-filter formula [1], [2] in which the estimates generated by two different filters are merged into a combined more reliable estimate in fixed-interval smoothing. The purpose of this paper is to develop such a two-filter formula that is universally applicable to smoothing and interpolation based on general records with missing observations. In [3], [4] the Mayne-Fraser formula was analyzed in the context of stochastic realization theory and was shown that it can be formulated in terms a forward and a backward Kalman filter. In a subsequent series of papers, Pavon [5], [6] addressed in a similar manner the hitherto challenging problem of interpolation [7], [8], [9], [10]. This latter problem consists of reconstructing missing values of a stochastic process over a given interval. In departure from the earlier statistical literature, [5], [6] considered a stationary process with rational spectral density and, therefore, reliazable as the output of a linear stochastic system. Interpolation was then cast as seeking an estimate of the state process based on an incomplete observation record. A basic tool in these works is the concept of time-reversal in stochastic systems which has been central in stochastic realization theory (see, e.g., [11], [12], [13], [14], [5], [6], [15], [16], [17]). For a recent
Research supported by grants from AFOSR, NSF, VR, and the SSF. T.T. Georgiou is with the Department of Electrical & Computer Engineering, University of Minnesota, Minneapolis, Minnesota; email: tryphon@umn.edu and A. Lindquist is with the Department of Automation and the Department of Mathematics, Shanghai Jiao Tong University, Shanghai, China, and the Center for Industrial and Applied Mathematics and ACCESS Linnaeus Center, KTH Royal Institute of Technology, Stockholm, Sweden; email: alq@kth.se

2

generating processes, in opposite time-directions, via causal and anti-causal mappings, respectively. This is most easily understood and explained in discrete-time and hence we begin with that. In Section III we utilize this mechanism in the context of general output processes and, similarly, introduce a pair of time-opposite models. These two introductory sections, II and III, deal with stationary models for simplicity and are largely based on [20]. The corresponding generalizations to time-varying systems are given in Section IV and in the appendix, in continuous and discrete-time, respectively. In Section V we explain Kalman filtering for problems with missing information in the continuous-time setting. In this, we first consider the case where increments of the output process across intervals of no information are unavailable as a simplified preliminary, after which we focus on the central problem where the output process is the object of observation. Section VI deals with the geometry of information fusion. In Section VII we present a generalized balanced two-filter formula that applies uniformly over intervals where data is or is not available. We summarize the computational steps of this approach in Section VIII. Finally, we highlight the use of the two-filter formula with a numerical example given in Section IX and provide concluding remarks in Section X. II. S TATE DYNAMICS AND ALL - PASS EXTENSION In this paper we consider discrete-time as well as continuous-time stochastic linear state-dynamics. We begin by explaining basic ideas in a stationary setting. In discrete-time systems take the form of a set of difference equations x(t + 1) = Ax(t) + Bw(t)
n×n n×p

this is identical to the one for discrete-time given above (as is well known). In continuous time, stability of the system of equations is equivalent to A having only eigenvalues with negative real part. In either case, discrete-time or continuous-time, it is possible to define an output equation so that the overall system is all-pass. This is done next.

A. All-pass extension in discrete-time Consider the discrete-time Lyapunov equation P = AP A + BB . (6)

Since A has all eigenvalues inside the unit disc of the complex plane and (3) holds, (6) has as solution a matrix P which is positive definite. The state transformation  = P - 2 x, and F = P - 2 AP 2 , G = P - 2 B, brings (1) into  (t + 1) = F  (t) + Gw(t). (9)
1 1 1 1

(7)

(8)

For this new system, the corresponding Lyapunov equation X = F XF + GG has In as solution, where In denotes the (n × n) identity matrix. This fact, namely, that In = F F + GG (10)

(1)

where t  Z, A  R ,B  R , A has all eigenvalues in the open unit disc D = {z | |z | < 1}, and w(t), x(t) are (centered) stationary vector-valued stochastic processes with w(t) normalized white noise; i.e., E{w(t)w(s) } = Ip ts , (2)

implies that this [F, G] can be embedded as part of an orthogonal matrix U= F H G J , (11)

i.e., a matrix such that U U = U U = In+p . Define the transfer function U(z ) := H (zIn - F )-1 G + J corresponding to  (t + 1) = F  (t) + Gw(t) w ¯ (t) = H (t) + Jw(t). This is also the transfer function of x(t + 1) = Ax(t) + Bw(t) ¯ x(t) + Jw(t), w ¯ (t) = B
1 -2

where E denotes mathematical expectation. The system of equations is assumed to be reachable, i.e., rank B, AB, . . . An-1 B = n. (3)

(12)

In continuous-time, state-dynamics take the form of a system of stochastic differential equations dx(t) = Ax(t)dt + Bdw(t) (4)

(13a) (13b)

where, here, x(t) is a stationary continuous-time vector-valued stochastic process and w(t) is a vector-valued process with orthogonal increments with the property E{dwdw } = Ip dt, (5)

(14a) (14b)

¯ := P H , since the two systems are related by a where B similarity transformation. Hence, ¯ (zIn - A)-1 B + J. U( z ) = B (15)

where Ip is the p × p identity matrix. Reachability of the pair (A, B ) is also assumed throughout and the condition for

3

Now, using the identity We claim that U(z ) is a stable all-pass transfer function (with respect to the unit disc), i.e., that U(z ) is a transfer function of a stable system and that U(z )U(z
-1

In - F F = (zIn - F )(z -1 In - F ) + (zIn - F )F + F (z -1 In - F ), (10) and GJ = -F H , obtained from U U = In+p , this yields U(z )U(z -1 ) = HH + JJ = In+p , as claimed.

) = U(z

-1

) U(z ) = Ip .

(16)

The latter claim is immediate after we observe that, since U U = In+p , U and hence,  (t) = F  (t + 1) + H w ¯ (t) w(t) = G  (t + 1) + J w ¯ (t) or, equivalently, x(t) = P A P -1 x(t + 1) + P 2 H w ¯ (t) w(t) = B P Setting x ¯(t) := P -1 x(t + 1), (18) can be written ¯w x ¯(t - 1) = A x ¯(t) + B ¯ (t) w(t) = B x ¯(t) + J w ¯ (t) with transfer function ¯ +J . U(z ) = B (z -1 In - A )-1 B (21) (20a) (20b) (19)
-1
1

 (t + 1) w ¯ (t)

=

 (t) w(t)

,

B. All-pass extension in continuous-time Consider the continuous-time Lyapunov equation (17a) (17b) AP + P A + BB = 0. (22)

(18a) (18b)

Since A has all its eigenvalues in the left half of the complex plane and since (3) holds, (22) has as solution a positive definite matrix P . Once again, applying (7-8), the system in (4) becomes d (t) = F  (t)dt + Gdw(t). (23a)

x(t + 1) + J w ¯ (t).

We now seek a completion by adding an output equation dw ¯ (t) = H (t)dt + Jdw(t) so that the transfer function U(s) := H (sIn - F )-1 G + J is all-pass (with respect to the imaginary axis), i.e., U(s)U(-s) = U(-s) U(s) = Ip . (25) (24) (23b)

Either of the above systems inverts the dynamical relation ww ¯ (in (14) or (13)).

For this new system, the corresponding Lyapunov equation has as solution the identity matrix and hence, F + F + GG = 0. Utilizing this relationship we note that (sIn - F )-1 GG (-sIn - F )-1 = (sIn - F )-1 (sIn - F - sIn - F )(-sIn - F )-1 = (sIn - F )-1 + (-sIn - F )-1 , and we calculate that U(s)U(-s) = (H (sIn - F )-1 G + J )(G (-sIn - F )-1 H + J ) = JJ + H (sIn - F )-1 (GJ + H ) (JG + H )(-sIn - F )-1 H . (26)

w(t)
-

U

w ¯ (t)
-

Fig. 1: Realization (14) in the forward time-direction.

w(t)


U

w ¯ (t)


Fig. 2: Realization (20) in the backward time-direction. An algebraic proof of (16) is also quite immediate. In fact, U(z )U(z -1 ) = H (zIn - F )-1 G + J + H (zIn - F )
-1

H (z -1 In - F )-1 G + J
-1

For the product to equal the identity, JJ = Ip

=H (zIn - F )-1 GG (z -1 In - F )-1 H + JJ GJ + JG (z In - F )
-1

H

H = -JG .

4

Thus, we may take J = Ip H = -G , and the forward dynamics d (t) = F  (t)dt + Gdw(t) dw ¯ (t) = -G  (t)dt + dw(t). (27a) (27b)

A. Time-reversal of discrete-time stochastic systems Consider a stochastic linear system x(t + 1) = Ax(t) + Bw(t) y (t) = Cx(t) + Dw(t) (35a) (35b)

with an m-dimensional output process y , and x, u, A, B are defined as in Section II-A. All processes are stationary and the system can be thought as evolving forward in time from the remote past (t = -). To formalize this, we introduce some notation. Let H be the Hilbert space spanned by {wk (t); t  Z, k = 1, 2, . . . , n}, endowed with the inner product , µ = E{µ}, and let + H- t (w ) and Ht (w ) be the (closed) subspaces spanned by {wk (s); s  t - 1, k = 1, . . . , m} and {wk (s); s  t, k = + 1, . . . , m}, respectively. Define H- t (y ) and Ht (y ) accordingly in terms of the output process process y . Then the stochastic system (35) evolves forward in time in the sense that - + H- (36) t (z )  Ht (w )  Ht (w ), where A  B means that elements of the subspaces A and B are mutually orthogonal, and where H- t (z ) is formed as above in terms of z (t) = x(t + 1) ; y (t)

Substituting F = -F - GG from (26) into (27a) we obtain the reverse-time dynamics d (t) = -F  (t)dt + Gdw ¯ (t) dw(t) = G  (t)dt + dw ¯ (t). Now defining x ¯(t) := P -1 x(t) and using (7) and (8), (28) becomes ¯ w dx ¯(t) = -A x ¯(t)dt + Bd ¯ (t) dw(t) = B x ¯(t)dt + dw ¯ (t), with transfer function ¯ U(s) = Ip + B (sIn + A )-1 B, where ¯ := P -1 B. B (32) (31) (30a) (30b) (29) (28a) (28b)

see [18, Chapter 6] for more details. Next we construct a stochastic system ¯w x ¯(t - 1) = A x ¯(t) + B ¯ (t) ¯ ¯ y (t) = C x ¯(t) + Dw ¯ (t), (37a) (37b)

Furthermore, the forward dynamics (27) can be expressed in the form dx(t) = Ax(t)dt + Bdw(t) ¯ x(t)dt + dw(t) dw ¯ (t) = B with transfer function ¯ (sIn - A)-1 B. U(s) = Ip - B (34) (33a) (33b)

which evolves backward in time from the remote future (t = ) in the sense that the processes x ¯, x, w, ¯ w relate as in the previous section. More specifically, as shown in Section II-A, H- (w ¯ )  H- (w) and H+ (w)  H+ (w ¯ ) for all t, as examplified in Figures 1 and 2. In fact, the all-pass extension (14) of (35a) yields ¯ x(t) + Jw(t) w ¯ (t) = B It follows from (20b) that (38) can be inverted to yield (38)

III. T IME - REVERSAL OF STATIONARY LINEAR
STOCHASTIC SYSTEMS

w(t) = B x ¯(t) + J w ¯ (t),

(39)

The development so far allows us to draw a connection between two linear stochastic systems having the same output and driven by a pair of arbitrary, but dual, stationary processes w(t) and w ¯ (t), one evolving forward in time and one evolving backward in time. When one of these two processes is white noise (or, orthogonal increment process, in continuous-time), then so is the other. For this special case we recover results of [11] and [5], [6] in stochastic realization theory.

where x ¯(t) = P -1 x(t + 1), and that we have the reverse-time recursion ¯w x ¯(t - 1) = A x ¯(t) + B ¯ (t). (40a) Then inserting (39) and ¯w x(t) = P x ¯(t - 1) = P A x ¯(t) + P B ¯ (t) into (35b), we obtain ¯x ¯w y (t) = C ¯(t) + D ¯ (t), (40b)

5

¯ := CP B ¯ + DJ and where D ¯ := CP A + DB . C Then, (40) is precisely what we wanted to establish. The white noise w is normalized in the sense of (2). Since U, given by (15), is all-pass, w ¯ is also a normalized white noise process, i.e., E{w ¯ (t)w ¯ (s) } = Ip t-s . From the reverse-time recursion (37a)


(41)

+ same inner product as above, and let H- t (du) and Ht (du) be the (closed) subspaces spanned by the increments of the components of U on (-, t] and [t, ), respectively. Define + H- t (dy ) and Ht (dy ) accordingly in terms of the output process y . All processes have stationary increments and the stochastic system (45) evolves forward in time in the sense that - + H- (46) t (dz )  Ht (dw )  Ht (dw ),

where H- t (dz ) is formed in terms of z (t) = x(t) . y (t) (47)

x ¯(t) =

¯w (A )k-(t+1) B ¯ (k ).
k=t+1

The all-pass extension of Section II-B yields ¯ xdt dw ¯ = dw - B as well as the reverse-time relation ¯ w dx ¯ = -A x ¯dt + Bd ¯ dw = B x ¯dt + dw, ¯ (42) where x ¯(t) = P -1 x(t). Inserting (49b) into dy = CP x ¯dt + Ddw (49a) (49b) (48)

Since, w ¯ is a white noise process, E{x ¯(t)w ¯ (s) } = 0 for all s  t. Consequently, (37) is a backward stochastic realization in the sense defined above. Moreover, the transfer functions W(z ) = C (zIn - A)-1 B + D of (35) and ¯ (z ) = C ¯ (z -1 In - A )-1 B ¯ +D ¯ W of (37) satisfy ¯ (z )U(z ). W(z ) = W (44) (43)

yields ¯x dy = C ¯dt + Ddw, ¯ where ¯ = CP + DB . C Thus, the reverse-time system is ¯ w dx ¯ = -A x ¯dt + Bd ¯ ¯ dy = C x ¯dt + Ddw. ¯ (51a) (51b) (50)

In the context of stochastic realization theory, U(z ) is called structural function ([13], [14]).

w(t)
-

W

y (t)
-

Fig. 3: The forward stochastic system (35).

From this, we deduce that the system (45) has the backward property H+ ¯)  H+ ¯ )  H- ¯ ), (52) t (dz t (dw t (dw where H+ ¯) is formed as above in terms of t (dz

y (t)


¯ W

w ¯ (t)


z ¯(t) =

x ¯(t) . y (t)

We also note that the transfer function Fig. 4: The backward stochastic system (37) W(s) = C (sIn - A)-1 B + D of (45) and the transfer function B. Time-reversal of continuous-time stochastic systems We now turn to the continuous-time case. Let dx = Axdt + Bdw dy = Cxdt + Ddw (45a) (45b) as in discrete-time. Note that the orthogonal-increment process w is normalized in the sense of (5). Since U(s) is all-pass, ¯ xdt dw ¯ = du - B (53) ¯ (s) = C ¯ (sIn + A )-1 B ¯ +D W of (51) also satisfy ¯ (s)U(s) W(s) = W

be a stochastic system with x, w, A, B as in Section II-B, evolving forward in time from the remote past (t = -). Now let H be the Hilbert space spanned by the increments of the components of w on the real line R, endowed with the

6

also defines a stationary orthogonal-increment process w ¯ such that {dw ¯ (t)dw ¯ (t) } = Ip dt. It remains to show that (51) is a backward stochastic realization, that is, at each time t the past increments of w ¯ are orthogonal to x ¯(t). But this follows from the fact that


Differentiating P (t)- 2 P (t)P (t)- 2 = In , we obtain
1 1  P (t)- 2 = -R(t) - R(t) , P (t)- 2 P

1

1

and hence the (55) yields F (t) + F (t) + G(t)G(t) = 0. Using (61) to eliminate F in (57), we obtain d = -F (t)  (t)dt + G(t)dw, ¯ where dw ¯ = dw - G(t)  (t)dt, (63) (62) (61)

x ¯(t) =
t

e

-A (t-s)

¯ w Bd ¯ (s)

and w ¯ has orthogonal increments.

IV. T IME REVERSAL OF NON - STATIONARY STOCHASTIC
SYSTEMS

which can also be written ¯ (t) x(t)dt, dw ¯ = dw - B ¯ (t) := P (t)-1 B (t). where B Proposition 1: A process w ¯ satisfying (63) has orthogonal increments with the normalized property (5). Moreover, E{[w ¯ (t) - w ¯ (s)] (t) } = 0 for all s  t. Proof: As is well-known, the solution of (57) can be written in the form
t

(64)

In a similar manner non-stationary stochastic systems admit unitary extensions which in turn allows us to construct dual time-reversed stochastic models that share the same state process. The case of discrete-time dynamics is documented in the appendix, whereas the continuous-time counterpart is explained next as prelude to smoothing and interpolation that will follow.

(65)

A. Unitary extension The covariance matrix function P (t) := E{x(t)x(t) } of the time-varying state representation dx = A(t)x(t)dt + B (t)dw, x(0) = x0 (54)

 (t) = (t, s) (s) +
s

(t,  )G( )dw,

(66)

where (t, s) is the transition matrix with the property  (t, s) = F (t)(t, s), (s, s) = In (67a) t  (t, s) = -(t, s)F (s), (t, t) = In (67b) s Let s  t. Then, in view of (63), a straight-forward calculation yields w ¯ (t) - w ¯ (s) = w(t) - w(s)
t

with x0 a zero-mean stochastic vector with covariance matrix P0 = E{x0 x0 }, satisfies the matrix-valued differential equation  (t) = A(t)P (t) + P (t)A(t) + B (t)B (t) P (55) with P (0) = P0 . Throughout we assume total reachability [18, Section 15.2], and therefore P (t) > 0 for all t > 0. A unitary extension of (54) is somewhat more complicated than in the discrete time case. In fact, differentiating  (t) = P (t)- 2 x(t) we obtain d = F (t) (t)dt + G(t)dw, where F (t) = P (t)- 2 A(t)P (t) 2 + R(t), G(t) = P (t) with R(t) = In fact, d = P (t)- 2 dx + R(t) (t)dt.
1 1 1 1

- M (t, s) (s) -
s

M (t,  )G( )dw,

(68)

where M (t, s) =
s

t

(56) Therefore, (57)

G( ) (, s)d.

(69)

E{[w ¯ (t) - w ¯ (s)][w ¯ (t) - w ¯ (s)) } = Ip (t - s) + (t, s), where (58a) (58b) (t, s) = M (t, s)M (t, s) +
s t
1 1 d P (t)- 2 P (t) 2 . dt

t

-1 2

B (t)

M (t,  )G( )G( ) M (t,  ) d

- (59)
s

[M (t,  )G( ) + G( ) M (t,  ) ] d.

However, (t, s) is identically zero. To see this, first note that (60) M (t, s) = -M (t, s)F (s) - G(s) . s (70)

7

Then, in view of (61), a simple calculation shows that  (t, s)  0. s Since (t, t) = 0, the assertion follows. Hence the incremental covariance is normalized. Next, we show that w ¯ (t) has orthogonal increments. To this end, choose arbitrary times s  t  a  b on the interval [0, T ], where we choose a and b fixed, and show that Q(t, s) := E{[w ¯ (b) - w ¯ (a)][w ¯ (t) - w ¯ (s)) } is identically zero for all s  t. Using (68) and w ¯ (b) - w ¯ (a) = w(b) - w(s) - M (b, a)(a, s) (s)
b b

B. Time reversal in continuous-time systems Next we derive the backward stochastic system corresponding to the non-stationary forward stochastic system dx = A(t)x(t)dt + B (t)dw, dy = C (t)x(t)dt + D(t)dw, x(0) = x0 y (0) = 0 (75a) (75b)

defined on the finite interval [0, T ], where x0 (with covariance P0 ) and the normalized Wiener process w are uncorrelated. To this end, apply the transformation x ¯(t) = P (t)-1 x(t) together with (74b) to (75b) to obtain ¯ (t)¯ dy = C x(t) + D(t)dw, ¯ where ¯ (t) = C (t)P (t) + D(t)B (t). C (77) This together with (74a) yields the the backward system corresponding to (75), namely ¯ (t)dw dx ¯ = -A(t) x ¯(t)dt + B ¯ ¯ dy = C (t)¯ x(t)dt + D(t)dw. ¯ with end-point condition x ¯(T ) = P (T ) the Wiener process w ¯.
-1

(76)

- M (b, a)
s

(a,  )G( )dw -
a

M (b,  )dw

computed analogously, we obtain
b

Q(t, s) = M (b, a) (a, s)M (t, s) -
s b

(a,  )G( )d

+
s

(a,  )G( )G( ) M (t,  )d .

(78a) (78b)

Then, again using (61), we see that M (t, s)  0, s so, since Q(t, t) = 0, we see that Q(t, s) is identically zero, establishing that w ¯ (t) has orthogonal increments. Finally, we use the same trick to show (65). In fact, for s  t, (66) and (68) yield E{[w ¯ (t) - w ¯ (s)) (t) } = -M (t, s)(t, s)
t t

x(T ) uncorelated to

The backward realization (78) was derived in [3], but in cumbersome way, requiring the proof that w ¯ (t) is a normalized process with orthogonal increments to be suppressed. What is new here is imposing the unitary map between w and w ¯, making the analysis much simpler and more natural. V. K ALMAN FILTERING WITH MISSING OBSERVATIONS We consider the linear stochastic system (75) which does not have a purely deterministic component that enables exact estimation of components of x from y , an assumption that we retain in the rest of the paper. In the engineering literature is often the case that the stochastic system (75) represented as x  (t) = A(t)x(t) + B (t)w  (t), y  (t) = C (t)x(t) + D(t)w  (t) x(0) = x0 (79a) (79b)

+
s

G( ) (t,  ) d -
s

M (t,  )G( )G( ) )(t,  ) d,

the partial derivative of which with respect to s is identical zero; this is seen by again using (61). Therefore, since (65) is zero for s = t, it is identical zero for all s  t, as claimed. This concludes the proof of Proposition 1. Consequently, (57) and (64) form a forward unitary system dx = A(t)x(t)dt + B (t)dw ¯ (t) x(t)dt, dw ¯ = dw - B (71a) (71b)

The corresponding backward unitary system is obtained through the transformation x ¯(t) = P (t) 2  (t), which yields dx ¯ = P (t)- 2 d + R(t) (t)dt. This together with (62) and (63) yields ¯ (t)dw dx ¯ = -A(t) x ¯(t)dt + B ¯ dw = B (t) x ¯(t)dt + dw, ¯ (74a) (74b)
1 1

(72)

(73)

where the formal "derivative" w  is white noise, i.e., E{w  (t)w  (s) } = I (t - s) with  (t - s) being the Dirac "function". Of course x , y  and w  are to be interpreted as generalized stochastic processes. From a mathematically rigorous point of view, observing y  makes little sense since, for any fixed t, y  (t) has infinite variance and contains no information about the state process x. However, observations of y  could be interpreted as observations of the increments dy of y in a precise meaning to be defined next. On the other hand, one can think of (75) as a system of type dz = M (t)z (t)dt + N (t)dw(t), where z (t) = x(t) , y (t)

8

and one would like to determine the optimal linear leastsquares estimate of x(t) given past observed values of y . Generally this distinction between observing y or dy is not important. However, when there is loss of information over an interval (t1 , t2 ), there are two different information patterns depending on whether dy or y is observed. The difference consists in whether y := y (t2 ) - y (t1 ) is part of the observation record or not. These two cases will be dealt with separately in subsections below. In fact, the former, which is common in engineering applications, is provided as a simplified preliminary, whereas our main interest is in the latter. To this end, we first introduce some notation. Consider the stochastic system (75) on a finite interval [0, T ]. As before, let H be the Hilbert space spanned by {wk (t) - wk (s); s, t  [0, T ], k = 1, 2, . . . , m}, endowed with the inner product , µ = E{µ}. For any   H and any subspace A, let EA denote the orthogonal projection of  onto A. We denote by H[t1 ,t2 ] (dy ) the (closed) subspace generated by the components of the increments of the observation process y over the window [t1 , t2 ]. In particular, we shall also use the notations H- t (dy ) := H[0,t] (dy ) and H+ t (dy ) := H[t,T ] (dy ). Suppose that the output process or its increments are available for observation only on some subintervals of [0, T ],  namely Ik , k = 1, 2, . . . ,  . Next we want to define H as the proper subspace of H[0,T ] (dy ) spanned by the observed data. In the case that only the increments dy or, equivalently, the "derivative" y  is observed, we simply define H := HI1 (dy )  HI2 (dy )  · · ·  HI (dy ), In the case that the process y is observed, we need to expand  H by adding the subspaces spanned by the increments y over the complementary intervals without observation. In either case, we define
- H- t := H  Ht (dy ) and   + H+ t := H  Ht (dy ).   

with R(t) = D(t)D(t) and initial conditions x- (0) = 0 and Q(0) = P0 . Here Q- (t) is the error covariance Q- (t) := E{[x(t) - x- (t)](x(t) - x- (t)] }, (83)

which, by the nondeterministic assumption, is positive definite for all t. Next suppose the observation process becomes unavailable over the interval [t1 , t2 )  [0, T ]. Then the Kalman filter needs to be modified accordingly. In fact, for any t  [t1 , t2 ), (81)
- holds with the space of observations H- t := Ht1 (dy ), and consequently 

a x- (t) = EHt1 (dy) a x(t) = a (t, t1 )x- (t1 ). This corresponds to setting K- (t) = 0 in (82) on the interval [t1 , t) so that dx- = A(t)x- (t)dt (84a) with initial condition x- (t1 ) given by (82a). The error covariance Q- is then given by the Lyapunov equation  - (t) = AQ- + Q- A + BB Q (84b)

-

with initial the condition Q- (t1 ) given by the value produced in the previous interval. Then suppose observations of dy become available again on the interval [t2 , t3 ). Then, for any t  [t2 , t3 ), we have H+ t = H[0,t1 ]  H[t2 ,t] , so the Kalman estimate is generated by (82) but now with initial conditions x- (t2 ) and Q- (t2 ) being those computed in the previous step without observation. In the case there are more intervals, one proceeds similarly by alternating between filters (82) and (84) depending on whether increments dy are available or not. In an identical manner, a cascade of backward Kalman filters generates a process x ¯+ (t) based on the backward stochastic realization (78) and the observation windows [t, T ]. Assuming that there are observations in a final interval ending at t = T , on that interval the Kalman estimate




(80)

Then Kalman filtering with missing observations amounts to determining a recursion for x- where


ax ¯+ (t) = EHt a x ¯(t),


+

(85)

a x- (t) = EHt a x(t),

-

for all a  Rn .

(81)

with initial observation space H+ t := H[t,T ] , is generated by the backward Kalman filter dx ¯+ = -A(t) x ¯+ (t)dt ¯ + (t)(dy (t) - C ¯ (t)¯ +K x+ (t)dt) ¯ + = -(Q ¯+C ¯ - BD ¯ ) R -1 K  = -A Q ¯ ¯+ - Q ¯+A + K ¯ + R(t)K ¯ + (t) - B ¯B ¯ Q +

A. Observing dy only When observations are available on the interval [0, t1 ], the Kalman filter on that interval is given by dx- = A(t)x- (t)dt + K- (t)(dy (t) - C (t)x- (t)dt) (82a) K- = (Q- C + BD )R
-1

(86a) (86b) (86c)

(82b) (82c)

¯ + (T ) = P ¯ (T ) for x and initial conditions x ¯+ (T ) = 0 and Q ¯+ and the error covariance ¯ + (t) := E{[¯ Q x(t) - x ¯+ (t)][¯ x(t) - x ¯+ (t)] }, (87)

 - (t) = AQ- + Q- A - K- RK- + BB Q

9

which like Q- (t) is positive definite for all t. During periods ¯ + = 0. This of no observations of dy , we then set the gain K update is obtained from the backward time stochastic model (74) in an identical manner to that of (84). Consequently, both the underlying process as well as the filter can run in either time-direction. This duality becomes essential in subsequent sections where we will be concerned with smoothing and interpolation. B. Observing y Now consider the case that y , and note merely dy , is available for observation on all intervals Ik , k = 1, 2, . . . ,  . Under this scenario and with a continuous-time process the dynamics of Kalman filtering become hybrid, requiring both continuous-time filtering when data is available as well as a discrete-time update across intervals where measurements are not available. Then on the first interval [0, t1 ] the Kalman estimate (82) will still be valid. However, when t reaches the endpoint t2 of the interval of no information and an observation of y is obtained again, the subspace of observed data becomes
- Ht = H- t1  H(y ), 2 

where u(t1 ) = u1 (t1 ) u2 (t1 ) = Bd v (t1 ) Dd

and Bd and Dd are chosen so that
Bd Dd
t2

Bd , Dd =

t1

(t2 , s)BB (t, s) (t2 , s)BM (s) M (s)B (t2 , s) M (s)M (s)

ds

while E {v (t1 )v (t1 ) } = I . Hence, across the window of missing data the Kalman state estimate x- is now generated by a discrete-time Kalman-filter step x- (t2 ) = Ad x- (t1 ) + Kd (y - Cd x- (t1 )) Kd = (Ad Q(t1 )Cd + Bd Dd ) × (Cd Q(t1 )Cd + Dd Dd )-1 (89b) (89a)

with initial conditions x- (t1 ) and Q(t1 ) given by (82) and the error covariance at t2 by Q(t2 ) = Ad Q(t1 )Ad - Kd (Cd Q(t1 )Cd + Dd Dd )Kd + Bd Bd . (89c)

In the next interval [t2 , t3 ], where observations of y are available, the new Kalman estimate (81) with H+ t = H[0,t1 ]  H(y )  H[t2 ,t] is again generated by the continuous-time Kalman filter (82) starting from x- (t2 ) and Q(t2 ) given by (89). Again given an observation pattern, where intermittently y becomes unavailable for observation, the Kalman estimate (81) can be generated in precisely this manner by a cascade of continuous and discrete-time Kalman filters. Remark 2: The observation pattern of a continuous-time stochastic model, where y becomes unavailable over particular time-windows, is closely related to hybrid stochastic models where continuous-time diffusion is punctuated by discrete-time transitions. Indeed, unless interpolation of the statistics within windows of unavailable data is the goal, the end points of such intervals can be identified and the same hybrid model utilized to capture the dynamics. Remark 3: A common engineering scenario is the case where the signal is lost while the observation noise is still present. This amounts to having C  0 over the corresponding window, and the Kalman estimates are obtained by merely running the filters (82) and (86) in the two time directions with the modified condition on C . This situation does not cover the information patterns discussed above since, whenever BD = 0, the Kalman gains do not vanish and information about the state process is available even when C is zero.


where y := y (t2 ) - y (t1 ). Computing x(t2 ) across the window (t1 , t2 ] as a function of x(t1 ) and the noise components we have that
t2

x(t2 ) = (t2 , t1 ) x(t1 ) +
t1 Ad

(t2 , s)Bdw(s)
u1 (t1 )

while
t2 t2

y (t2 ) = y (t1 ) +
t1

C (t)x(t)dt +
t1

D(t)dw(t).

Therefore,
t2

y =
t1

C (t)(t, t1 )dt) x(t1 ) + u2 (t1 )
Cd

where
t2 t1

u2 (t1 ) =
t1

C (t)
t

(t, s)B (s)dw(s)dt
t2

+
t1 t2 t2

D(s)dw(s)

=
t1 t

C (t)(t, s)dtB (s) + D(s) dw(s).
M (s)

Thus, we obtain the discrete-time update x(t2 ) = Ad x(t1 ) + Bd v (t1 ) y = Cd x(t1 ) + Dd v (t1 ) (88a) (88b)

10

C. Smoothing Given these intermittent forward and backward Kalman estimates, we shall derive a formula for the smoothing estimate


proving condition (i). Condition (ii) follows from a symmetric argument. To prove (iii) we use condition (93). To this end, first note that, by the usual projection formula, ¯+ (t)-1 x EX+ (t) a x- (t) = E{a x- (t)¯ x+ (t)}P ¯+ (t) (94)

ax ^(t) := EH a x(t),

a  Rn ,

(90)

= a E{x- (t)¯ x+ (t) }x+ (t),

valid for both the cases discussed above, where H :=
 - Ht 



+ Ht



 H[0,T ] (dy )

(91)

¯+ (t)-1 x where x+ (t) := P ¯+ (t) is the dual basis in X+ (t) such that E{x+ (t)¯ x+ (t) } = I . Moreover, EX(t) a x- (t) = E {a x- (t)x(t) }P (t)-1 x(t) = a E{x- (t)x(t) }x ¯(t) = a P- (t)¯ x(t), where we have used condition (i) and (76). Next, set b := P- a and form ¯+ (t)-1 x EX+ (t) b x ¯(t) = E{b x ¯(t)¯ x+ (t)}P ¯+ (t) = b E{x ¯(t)¯ x+ (t)}x+ (t) ¯ = b P+ (t)x+ (t), by condition (ii), and consequently ¯+ (t)x+ (t). EX+ (t) E X(t) a x- (t) = a P- (t)P Then condition (iii) follows from (93a), (94) and (95). Remark 5: The proof of condition (iii) in Lemma 4 could be simplified if x ¯+ were a regular backward Kalman estimate without intermittent loss of information. In this case, x+ = ¯ -1 x P + ¯+ would be generated by a forward stochastic realization belonging to the same class as (75) and E{x ¯+ (t)x- (t) } = ¯ ¯ P+ (t) E{x+ (t)x- (t)} = P+ (t) E{x- (t)x- (t)}. Lemma 6: For each t  [0, T ], the smoothing estimate x ^(t), defined by (90), is given by ax ^(t) = E Ht a x(t), a  Rn , (96) (95)

is the complete subspace of observations. This is discussed next. VI. G EOMETRY OF FUSION Consider the system (75), and let X(t) be the (finitedimensional) subspace in H spanned by the components of the stochastic state vector x(t). Then it can be shown [18, Chapter 7] that H[0,t] (dy )  H[t,T ] (dy ) | Xt , where A  B | X denotes the conditional orthogonality  - E ,  - E  = 0 for all   A,   B.
X X

(92)

Next, let X- (t) and X+ (t) be the subspaces spanned by the components of the (intermittent) Kalman estimates x- (t) and  x ¯+ (t), respectively. Then since X- (t)  H- t  H[0,t] (dy ) and X+ (t) 
+ Ht 

 H[t,T ] (dy ), we have X- (t)  X+ (t) | X(t),

which is equivalent to EX+ (t) a x- (t) = EX+ (t) EX(t) a x- (t), [18, Proposition 2.4.2]. Therefore the diagram X-
EX |X- EX+ |X-

a  Rn

(93a)

-

X+
EX+ |X

(93b) where Ht is the subspace Ht = X- (t)  X+ (t).


X commutes, where the argument t has been suppressed. Lemma 4: Let x(t), x ¯(t), x- (t) and x ¯+ (t) be defined as above. Then, for each t  [0, T ], (i) E{x(t)x- (t) } = P- (t) ¯+ (t) (ii) E{x ¯(t)¯ x+ (t) } = P ¯+ (t)P- (t), (iii) E{x ¯+ (t)x- (t) } = P where P- (t) := E{x- (t)x- (t) } is the state covariance of the Kalman estimate x- (t) and P+ (t) := E{x ¯+ (t)¯ x+ (t) } is the covariance of the backward Kalman estimate x ¯+ (t). Proof: By the definition of the Kalman filter, (81) holds, and consequently the components of the estimation error x(t) - x- (t) are orthogonal to H- t and hence to the components of x- (t). Therefore, E{x(t)x- (t) } = E{x- (t)x- (t) } = P- (t),

(97)

Proof: Following [14], [3], [18], define N- (t) := H- t  X- (t) and N+ (t) := H+ X+ (t). Then t
- + H = N (t)  Ht  N (t). 

Now, a (x(t) - x- (t)) is orthogonal to H- t and hence to N- (t). Also a x- (t)  N- (t). Hence a x(t)  N- (t) as well. In the same way we see that a x(t)  N+ (t). Therefore (96) follows. Consequently, the information from the two Kalman filters can be fused into the smoothing estimate ¯ + (t)¯ x ^(t) = L- (t)x- (t) + L x+ (t) ¯+. for some matrix functions L- and L (98)



11

VII. U NIVERSAL TWO - FILTER FORMULA To obtain a robust and particularly simple smoothing formula that works also with an intermittent observation pattern, we assume that the stochastic system (75) has already been transformed via (58) so that, for all t  [0, T ], x(t) = x ¯(t) and therefore ¯ (t). P (t) = E{x(t)x(t) } = I = P (100) (99)

Then (102) follows from (98) and (107). To prove (104) ¯ + in (106) to obtain eliminate L ¯+ ) = Q ¯+, L - ( I - P- P which together with (107) yields
1 ¯ ¯ -1 Q-1 = Q- - (I - P- P+ )Q+ .

However, ¯+ = Q ¯ + + Q- - Q- Q ¯+, I - P- P and hence (104) follows. In the special case with no loss of observation this is a normalized version of the Mayne-Frazer two-filter formula [1], [2], which however in [1], [2] was formulated in terms of x- and x+ rather than x ¯+ , where x+ is the state process of the forward stochastic system of the backward Kalman filter. (For the corresponding formula in terms of x- and x ¯+ , see [3], [18]; also cf. [21], where an independent derivation was given.) With a single interval of loss of observation the formula (102) reduces to a version of the interpolation formulas in [6]. The remarkable fact, discovered here, is that the same formula (102) holds for any intermittent observations structure and by a cascade of continuous and discrete-time forward and backward Kalman filters, as needed depending on the assumed information pattern. VIII. R ECAP OF COMPUTATIONAL STEPS Given a system (75) with state covariance (55), make the normalizing substitution A(t)  P (t)- 2 A(t)P (t) 2 + R(t) B (t)  P (t)- 2 B (t) C (t)  C (t)P (t)
1 1 2 1 1 1 1

Then the error covariances in the filtering formulas of Section V are Q- = I - P- ¯+ = I - P ¯+ . and Q (101)

¯+ (t) are all bounded in Consequently, x(t), x ¯(t), P- (t) and P norm by one for all t  [0, T ]. Theorem 7: Suppose that (99) holds. For every t  [0, T ], we have the formula ¯ + (t)-1 x x ^(t) = Q(t) Q- (t)-1 x- (t) + Q ¯+ (t) (102)

for the smoothing estimate (90), where the estimation error Q(t) := E (x(t) - x ^(t)) (x(t) - x ^(t)) is given by ¯ + (t)-1 - I, Q(t)-1 = Q- (t)-1 + Q (104) (103)

and where x- , x ¯+ , Q- and Q+ are given by (82) and (86) with boundary conditions x- (0) = x ¯+ (T ) = 0 and Q- (0) = Q+ (T ) = I . ¯ + in (98) Proof: Clearly the matrix functions L- and L can be determined from the orthogonality relations E{[x(t) - x ^(t)]x- (t) } = 0 and E{[x(t) - x ^(t)]¯ x+ (t) } = 0. By Lemma 4, (105) yields ¯+P ¯+ P- = 0 P- - L- P- - L ¯+ - L- P- P ¯+ - L ¯+P ¯+ = 0, P ¯+ are positive definite, which, in view of the fact that P- and P yields ¯+P ¯+ = I L- + L (106a) ¯+ = I L- P- + L Again by orthogonality and Lemma 4, ¯+P ¯+ , Q = E {(x - x ^ ) x } = I - L- P - - L which, in view of (106) and the relations (101), yields L- =
1 QQ- -

(108)

(105a) (105b)

-2 with R(t) = d P (t) 2 . Next, we compute the dt P (t) intermittent forward and backward Kalman filter estimates x- and x ¯+ , respectively, along the lines of Section V, where, ¯ + (T ) = In . Then the due to the normalization, Q- (0) = Q smoothing estimate is given by

¯ + (t)-1 x x ^(t) = Q(t) Q- (t)-1 x- (t) + Q ¯+ (t) , where ¯ + (t)-1 - I Q(t) = Q- (t)-1 + Q IX. A N EXAMPLE We now illustrate the results of the paper on a specific numerical example. We consider the continuous-time diffusion process dx1 (t) dx2 (t) (107) dy (t) = x2 (t)dt = -0.3x1 (t)dt - 0.7x2 (t)dt + dw(t) = x1 (t)dt + dv (t)
-1

.

(106b)

and

¯+ = L

¯ -1 . QQ +

12

where w and v are thought to be independent standard Wiener processes. Here, x1 is thought of as position and x2 as velocity of a particle that is steered by stochastic excitation in dw, in the presence of a restoring force 0.3x1 and frictional force 0.7x2 . Then dy/dt represents measurement of the position and dv/dt represents measurement noise (white).
50 0 -50 0.5 0 5 10 15 20 25 30 35 40 45

of intervals, data are not made available for state estimation; these intervals where data are not to be used are marked by a thick blue baseline in the figures. In Figure 5 we display sample paths of the output process y , increments dy , and stateprocesses x1 and x2 .
2 1 0 -1 -2 -3 0 5 10 15 20 25 30 35
x 1,est x1

KF backward estimate x 1 - missing data in blue intervals

Output process and states

dy

y

0 -0.5 5 0 5 10 15 20 25 30 35 40 45

40

45

4 2
0 5 10 15 20 25 30 35 40 45

KF backward estimate x 2 - missing data in blue intervals
x 2,est x2

x1

0 -5 5

0 -2

x2

0 -5 0 5 10 15 20 25 30 35 40 45

-4

0

5

10

15

20

25

30

35

40

45

Fig. 5: Sample paths of output process, increment, and state processes
KF forward estimate x - missing data in blue intervals
2 1 0 -1 -2 -3 0 5 10 15 20 25 30 35 40
x est,1 x1
1

Time [sec]

Fig. 7: Kalman estimates in the backward time direction
2 1 0 -1 -2 -3 0 5 10 15 20 25 30 35
x 1,smooth x1

40

45

45 4 2 0 -2 -4 0 5 10

Smoothed state estimates
x 2,smooth x2

4 2 0 -2 -4 0

KF forward estimate x 2 - missing data in blue intervals
x est,2 x2

15

20

25

30

35

40

45

5

10

15

20

25

30

35

40

45

Time [sec]

Time [sec]

Fig. 6: Kalman estimates in the forward time direction Numerical simulation over [0, T ] with T = 45 (units of time) produces a time-function y (t) which is sampled with integer multiples of t = 0.01 (units). The interval [0, T ] is partitioned into [0, T ] = 9 i=1 [ti-1 , ti ] where t0 = 0 and ti - ti-1 = i (units). Measurements of y are made available for purposes of state estimation over the intervals [ti-1 , ti ] for i = 1, 3, 5, 9. Over the complement set

Fig. 8: Interpolation/smoothed estimates by fusion of Kalman forward and backward estimates The process increments dy over [ti-1 , ti ] for i = 1, 3, 5, 9 as well as the increments y across the [ti-1 , ti ] for i = 2, 4, 6, 8 are used in the two-filter formula for the purpose of smoothing. The Kalman estimates for the states in the forward and backwards in time directions, x- (t) and x ¯+ (t) are shown in Figures 6 and 7, respectively. The fusion of the two using (102) is shown in Figure 8. It is worth observing the nature and fidelity of the estimates. In the forward direction, across intervals where data is not available, x- becomes

13

increasing more unreliable whereas the opposite is true for x ¯+ , as expected. The smoothing estimate is generally an improvement to those of the two Kalman filters as seen in Figure 8. In particular, it is worth noting x2 (in subplot 2), where, over windows of available observations, estimates have considerably less variance in the middle of the interval where ¯ + (t)-1 ) in (102) are the weights (Q(t)Q- (t)-1 and Q(t)Q equalized, whereas sample paths become increasing rugged at the two ends where one of the two Kalman estimates has significantly higher variance, and the corresponding mixing coefficient becomes relatively smaller. X. C ONCLUDING REMARKS Historically the problem of interpolation has been considered from the beginning of the study of stochastic processes [22], [23]. Early accounts and treatments were cumbersome and non-explicit as the problem was considered difficult [7], [8], [9], [10]. In a manner that echoes the development of Kalman filtering, the problem became transparent and computable for ouput processes of linear stochastic systems [5], [6], [18]. This paper builds on developments in stochastic realization theory [11], [24] and presents a unified and generalized twofilter formula for smoothing and interpolation in continuous time for the case of intermittent availability of data over an operating window. The analysis considers two alternative information patterns where increments of the output process or the output process itself is recorded when information becomes available. The second information pattern appears most natural to us in this continuous-time setting, and this is our main problem. Nevertheless, in either case, two Kalman filters run in opposite time-directions, designed on the basis of a forward and a backward model for the process, respectively. Fusion of the respective estimates is effected via linear mixing in a manner similar to the Mayne-Fraser formula and applies to both smoothing and interpolation intermixed. In earlier works, smoothing and interpolation have been considered separate problems [18, Chapter 15]. The balancing normalization also simplifies the mixing formula and makes it completely time symmetric. The theory relies on time-reversal of stochastic models. We provide a new derivation of such a reversal which has the convenient property of being balanced. It is based on lossless imbedding of linear systems and effects the time reversal through a unitary transformation. Interestingly, time symmetry in statistical and physical laws have occupied some of the most prominent minds in science and mathematics. In particular, closer to our immediate interests, dual time-reversed models have been employed to model, in different time-directions, Brownian or Schr¨ odinger bridges [25], [26], a subject which is related to reciprocal processes [27], [28], [29], [30]. A natural

extension of the present work in fact is in the direction of general reciprocal dynamics [28], [29] and the question of whether similar two-filter formula are possible. A PPENDIX : T IME REVERSAL OF NON - STATIONARY DISCRETE - TIME SYSTEMS Next, instead of (1), consider the non-stationary state dynamics x(t + 1) = A(t)x(t) + B (t)w(t), x(0) = x0 , (109)

on a finite time-window [0, T ], where, for simplicity we now assume that the covariance matrix P0 := P (0) of the zero-mean stochastic vector x0 is positive definite, i.e., P0 = E{x0 x0 } > 0. Then the state covariance matrix P (t) := E{x(t)x(t) } will satisfy the Lyapunov difference equation P (t + 1) = A(t)P (t)A(t) + B (t)B (t) . The state transformation  (t) = P (t)- 2 x(t) brings the system (109) into the form  (t + 1) = F (t) (t) + G(t)w(t), where now E{ (t) (t) } = In for all t and F (t) = P (t + 1)- 2 A(t)P (t) 2 , G(t) = P (t + 1)
-1 2
1 1 1

(110)

(111)

(112)

(113a) (113b)

B.

The Lyapunov difference equation then reduces to In = F (t)F (t) + G(t)G(t) (114)

allowing us to embed [F, G] as part of a time-varying orthogonal matrix U (t) = F (t) G(t) H (t) J (t) . (115)

This amounts to extending (112) to  (t + 1) = F (t) (t) + G(t)w(t) w ¯ (t) = H (t) (t) + J (t)w(t), or, in the equivalent form  (t + 1)  (t) = U (t) . w ¯ (t) w(t) (117) (116a) (116b)

Hence, since E{ (t) (t) } = In and E{w(t)w(t) } = Ip , and assuming that E { (t)w(t) } = 0, E  (t + 1) w ¯ (t)  (t + 1) w ¯ (t) = U (t)U (t) = In+p , (118)

which yields E{ (t + 1)w ¯ (t) } = 0, E{w ¯ (t)¯ u(t) } = Ip . (119a) (119b)

14

Moreover, from (116) we have u ¯(t + k ) = H (t + k )(t + k, t) (t)
t+k-1

where x0 and the normalized white-noise process w are uncorrelated and E{x0 x0 } = P0 . In fact, inserting the transformations (122) and (123a) into (124b) yields ¯x ¯w y (t) = C ¯(t) + D ¯ (t), where ¯ = C (t)P (t)A(t) + D(t)B (t) C ¯ = C (t)P (t)B ¯ (t) + D(t)J (t) D From that we have the backward system ¯ (t)w x ¯(t - 1) = A(t) x ¯(t) + B ¯ (t) ¯ ¯ y (t) = C (t)¯ x(t) + D(t)w ¯ (t) (127a) (127b) (125) (126)

+
j =t

H (t + k )(t + k, j + 1)G(j )w(j ) + J (t)w(t)

for k > 0, where (s, t) = F (s - 1)F (s - 2) · · · F (t) for s > t In for s = t.

Therefore, since F (t)H (t) + G(t)J (t) = 0 by the unitarity of U (t), E{u ¯(t + k )¯ u(t) } = H (t + k )(t + k, t + 1)[F (t)H (t) + G(t)J (t) ] = 0. Consequently, u ¯ is a white noise process. Finally, premultiplying (117) by U (t) , we then obtain  (t) = F (t)  (t + 1) + H (t) w ¯ (t) w(t) = G(t)  (t + 1) + J (t) w ¯ (t), (120a) (120b)

with the boundary condition x ¯(T - 1) = P (T )-1 x(T ) being uncorrelated to the white-noise process w ¯.

R EFERENCES
[1] D. Q. Mayne, "A solution of the smoothing problem for linear dynamic systems," Automatica, vol. 4, pp. 73­92, 1966. [2] D. Fraser and J. Potter, "The optimum linear smoother as a combination of two optimum linear filters," Automatic Control, IEEE Transactions on, vol. 14, no. 4, pp. 387­390, 1969. [3] F. A. Badawi, A. Lindquist, and M. Pavon, "A stochastic realization approach to the smoothing problem," IEEE Trans. Automat. Control, vol. 24, no. 6, pp. 878­888, 1979. [4] F. Badawi, A. Lindquist, and M. Pavon, "On the Mayne-Fraser smoothing formula and stochastic realization theory for nonstationary linear stochastic systems," in Decision and Control including the Symposium on Adaptive Processes, 1979 18th IEEE Conference on, vol. 18. IEEE, 1979, pp. 505­510. [5] M. Pavon, "New results on the interpolation problem for continuoustime stationary increments processes," SIAM journal on Control and Optimization, vol. 22, no. 1, pp. 133­142, 1984. [6] ----, "Optimal interpolation for linear stochastic systems," SIAM journal on Control and Optimization, vol. 22, no. 4, pp. 618­629, 1984. [7] K. Karhunen, Zur Interpolation von station¨ aren zuf¨ alligen Funktionen. Suomalainen tiedeakatemia, 1952. [8] Y. Rozanov, Stationary random processes. Holden-Day, San Francisco, 1967. [9] P. Masani, "Review: Yu.A. Rozanov, stationary random processes," The Annals of Mathematical Statistics, vol. 42, no. 4, pp. 1463­1467, 1971. [10] H. Dym and H. P. McKean, Gaussian processes, function theory, and the inverse spectral problem. Courier Dover Publications, 2008. [11] A. Lindquist and G. Picci, "On the stochastic realization problem," SIAM J. Control Optim., vol. 17, no. 3, pp. 365­389, 1979. [12] ----, "Forward and backward semimartingale models for Gaussian processes with stationary increments," Stochastics, vol. 15, no. 1, pp. 1­50, 1985. [13] ----, "Realization theory for multivariate stationary Gaussian processes," SIAM J. Control Optim., vol. 23, no. 6, pp. 809­857, 1985. [14] ----, "A geometric approach to modelling and estimation of linear stochastic systems," J. Math. Systems Estim. Control, vol. 1, no. 3, pp. 241­333, 1991.

which, in view of (119), is a backward stochastic system. Using the transformation (111), (116) yields the forward representation x(t + 1) = A(t)x(t) + B (t)w(t) ¯ (t) x(t) + J (t)w(t), w ¯ (t) = B
1 ¯ (t) := P (t)- 2 H (t) . Likewise (120) and where B

(121a) (121b)

x ¯(t) = P (t + 1)-1 x(t + 1), yields the backward representation ¯ (t)w x ¯(t - 1) = A(t) x ¯(t) + B ¯ (t) w(t) = B (t) x ¯(t) + J (t) w ¯ (t).

(122)

(123a) (123b)

Remark 8: When considered on the doubly infinite time axis, equation (117) defines an isometry. Indeed, assuming that the input is squarely summable, the fact that U (t) is unitary for all t directly implies that
N N

w ¯
-

2

+  (t + 1)

2

=
-

w(t) 2 .

Then,  (t)  0 as t  , provided (t, s)  0 as s  -. It follows that
 

w ¯ (t)
t=-

2

=
t=-

w(t) 2 .

We are now in a position to derive a backward version of a non-stationary stochastic system x(t + 1) = A(t)x(t) + B (t)w(t), y (t) = C (t)x(t) + D(t)w(t) x(0) = x0 (124a) (124b)

15

[15] A. Lindquist and M. Pavon, "On the structure of state-space models for discrete-time stochastic vector processes," IEEE Trans. Automat. Control, vol. 29, no. 5, pp. 418­432, 1984. [16] G. Michaletzky, J. Bokor, and P. V´ arlaki, Representability of stochastic systems. Budapest: Akad´ emiai Kiad´ o, 1998. [17] G. Michaletzky and A. Ferrante, "Splitting subspaces and acausal spectral factors," J. Math. Systems Estim. Control, vol. 5, no. 3, pp. 1­26, 1995. [18] A. Lindquist and G. Picci, Linear Stochastic Systems: A Geometric Approach to Modeling, Estimation and Identification. Springer-Verlag, Berlin Heidelberg, 2015. [19] T. T. Georgiou, "The Carath´ eodory­Fej´ er­Pisarenko decomposition and its multivariable counterpart," Automatic Control, IEEE Transactions on, vol. 52, no. 2, pp. 212­228, 2007. [20] T. Georgiou and A. Lindquist, "On time-reversibility of linear stochastic models," arXiv preprint arXiv:1309.0165, 2013. [21] J. E. Wall Jr, A. S. Willsky, and N. R. Sandell Jr, "On the fixedinterval smoothing problem," Stochastics: An International Journal of Probability and Stochastic Processes, vol. 5, no. 1-2, pp. 1­41, 1981. [22] A. N. Kolmogorov, Stationary sequences in Hilbert space. John Crerar Library National Translations Center, 1978. [23] A. M. Yaglom, "On problems about the linear interpolation of stationary random sequences and processes," Uspekhi Matematicheskikh Nauk,

vol. 4, no. 4, pp. 173­178, 1949. [24] M. Pavon, "Stochastic realization and invariant directions of the matrix Riccati equation," SIAM Journal on Control and Optimization, vol. 18, no. 2, pp. 155­180, 1980. [25] M. Pavon and A. Wakolbinger, "On free energy, stochastic control, and Schr¨ odinger processes," in Modeling, Estimation and Control of Systems with Uncertainty. Springer, 1991, pp. 334­348. [26] P. Dai Pra and M. Pavon, "On the Markov processes of Schr¨ odinger, the Feynman-Kac formula and stochastic control," in Realization and Modelling in System Theory. Springer, 1990, pp. 497­504. [27] B. Jamison, "Reciprocal processes," Probability Theory and Related Fields, vol. 30, no. 1, pp. 65­86, 1974. [28] A. Krener, "Reciprocal processes and the stochastic realization problem for acausal systems," in Modelling, Identification and Robust Control, C. I. Byrnes and A. Lindquist, Eds. Amsterdam: North-Holland, 1986, pp. 197­211. [29] B. C. Levy, R. Frezza, and A. J. Krener, "Modeling and estimation of discrete-time Gaussian reciprocal processes," Automatic Control, IEEE Transactions on, vol. 35, no. 9, pp. 1013­1023, 1990. [30] P. Dai Pra, "A stochastic control approach to reciprocal diffusion processes," Applied mathematics and Optimization, vol. 23, no. 1, pp. 313­329, 1991.

