1688

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

Universal Regulators for Optimal Tracking
in Discrete-Time Systems Affected
by Harmonic Disturbances
Anders Lindquist, Fellow, IEEE, and Vladimir A. Yakubovich, Member, IEEE

Abstract— The authors consider the problem of controlling a
discrete-time linear system by output feedback so as to have a
second output z t track an observed reference signal r t . First, as a
preliminary, we consider the problem of asymptotic tracking, i.e.,
to design a regulator such that jz t 0 rt j ! 0. This problem has
been studied intensely in the literature, mainly in the continuoustime case. It is known that only under very special conditions
does there exist a linear regulator which achieves this design
goal and which is universal in the sense that it works for all
reference signals and does not depend on them. On the other
hand, if rt is a harmonic signal with known frequencies but
with unknown amplitudes and phases, there exist such regulators
under mild conditions, provided the dimension of rt is no larger
than the number of controls. This is true even if the plant itself
is corrupted by an unobserved additive harmonic disturbance wt
of the same type as rt , if the dimension of wt is no larger than
the number of outputs available for feedback control.
However, if the first dimensionality condition is not satisfied,
asymptotic tracking is not possible, but a steady-state tracking
error remains. Therefore, the authors turn to another approach
to the tracking problem, which also allows for damping of
other system and control variables, and this is our main result.
The measure of performance is given by a natural quadratic
cost function. The object is to design an optimal regulator
which is universal in the sense that it does not depend on the
unknown amplitudes and phases of rt and wt and is optimal
for all choices of rt and wt . The authors prove that an optimal
universal regulator exists in a wide class of stabilizing and
possibly nonlinear regulators under natural technical conditions
and that this regulator is in fact linear, provided that the second
dimensionality condition above is satisfied. On the other hand, if
it is not satisfied, the existence of an optimal universal regulator is
not a generic property, so as a rule no optimal universal regulator
exists.
The authors provide complete solutions of all the problems
described above.
Index Terms—Internal model principle, optimal tracking, optimal universal regulators, sinusoidal disturbance.

Fig. 1. Feedback configuration.

(1b)
(1c)
, two vector outputs
and
,
with a state
and an
and two vector inputs, namely a control
which we shall take to be
unobserved disturbance
harmonic with known frequencies but unknown amplitudes
and phases. More precisely
(2)
where the frequencies
(3)
,
,
are known, but the complex vector amplitudes
,
, in which the phases have been absorbed, are either
completely unknown or zero. Consequently, some frequencies
and have been included for
(3) may not be represented in
notational purposes to be explained shortly.
In this paper we consider the problem to control the system
(1) by feedback from the output so as to have the output
track an observed -dimensional real reference signal

I. INTRODUCTION

C

(4)

ONSIDER a discrete-time linear control system
(1a)

Manuscript received January 4, 1996; revised February 1, 1997 and April
6, 1998. Recommended by Associate Editor, S. Weiland. This work was
supported in part by grants from NFR, INTAS, and NUTEK.
A. Lindquist is with the Division of Optimization and Systems Theory,
Royal Institute of Technology, 100 44 Stockholm, Sweden.
V. A. Yakubovich is with the Department of Mathematics and Mechanics,
St. Petersburg University, St. Petersburg 198904, Russia.
Publisher Item Identifier S 0018-9286(99)07132-9.

which is harmonic with the known frequencies (3) but with
,
,
,
which are
complex vector amplitudes
either completely unknown or zero so that certain frequencies
(3) may not occur in . The feedback configuration of this
problem is described in the flow diagram as shown in Fig. 1.
Many important engineering problems could be modeled in
this way. Some examples are connected to industrial machines
and helicopters [2], [9]–[12], [27], [28], control of aircraft in

0018–9286/99$10.00  1999 IEEE

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

the presence of wind shear [19], [23], [31], and control of the
roll motion of a ship [14].
For notational convenience we use a common set of freand , forcing us to set certain complex
quencies (3) for
vector amplitudes equal to zero. To formalize this we introduce
,
of for which
the index sets
and
, respectively, are nonzero and arbitrary. Then
and

(5)

Without loss of generality we assume that

Accordingly, we define the class
of disturbances and the
and ,
class of reference signals consisting of all signals
and
respectively, obtained by letting
vary arbitrarily subject to the constraint that the signals (5)
are real.
, and
are constant
We assume that , , , ,
real matrices of appropriate dimensions such that
is stabilizable and
is detectable. Without loss of
generality we may also assume that
and

(6)

In fact, if the first condition is not satisfied, some components
of could be eliminated. Moreover, if has linearly dependent columns, these could be combined without restriction.
and
.
Clearly, (6) implies that
Now, a possible criterion of performance for the tracking
problem described above is given by
(7)
but, to allow for damping of internal system variables and
the energy of control, we shall also consider a more general
criterion of the type
(8)
where

is a real quadratic form
(9)

with properties to be specified in Section V. [To ensure that the
, we must of course introduce some
infimum of is not
condition on the quadratic form (9).] We note that the second
functional (8) becomes a measure not only of the tracking
accuracy but also of the forced oscillations in the closed-loop
system. For the classes of admissible regulators to be defined
next, these cost functions do not depend on initial conditions.
, a regulator
The object is to find, for suitable ,

1689

satisfies the weak stability condition
as

2) optimal in the sense that the cost function (8) is
minimized;
3) universal in the sense that it simultaneously solves the
complete family of optimization problems corresponding to different values of the complex vector amplitudes
and
and thus does not depend
on these amplitudes.
Such a regulator will be referred to as an optimal universal
regulator (OUR), and the class of regulators (10) satisfying
conditions 1) and 2) will be denoted . The stability condition
(11) may at first sight seem somewhat unnatural, but, as we
shall see in Section VI, it is the natural mathematical condition
for which statements of necessity
defining the largest class
and sufficiency can be made.
Removing the last term of (8) related to tracking we obtain
some special cases of this problem which were studied in [21]
and in [22] for the cases of complete and incomplete state
information, respectively.
In this paper we show that, under suitable technical con, the problem stated above has
ditions and provided
a solution in , and this solution happens to be a linear
stabilizing regulator of type
(12)
is the backward shift
and
,
where
, and
are real matrix polynomials, of dimensions
,
, and
, respectively, with the property that
and
and
are proper rational
functions so that the regulator is nonanticipatory in the sense
does not depend on future values of
and , in
that
the subclass of
harmony with (10). We shall denote by
such linear regulators. Existence of an OUR in the subclass
itself can be established under somewhat milder technical
is important.
conditions. The dimensionality condition
As in [22], it can be shown that if it fails, then the existence of
an optimal universal regulator becomes a nongeneric property.
It means that no optimal universal regulator exists from a
.
practical point of view if
The cost function (7) would of course be minimized if we
could control (1a) so that
as

(13)

In fact, it would be zero. Therefore, asymptotic tracking
appears as a special case in our analysis. This problem has been
studied intensely in the literature, at least in the continuoustime case; see, e.g., [1], [4]–[8], [13], [16], and the references
therein. The connection to this earlier work, developed in
continuous time, is made evident by noting that the disturbance
and reference signals (5) can be modeled as the output of a
critically stable system

(10)
which is:
sat1) stabilizing in the sense that any process
isfying the closed-loop system equations (1), (10) also

(11)

with

having all its eigenvalues on the unit circle.

1690

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

Therefore, we begin by developing our optimization procedure in this well-known setting of asymptotic tracking,
thereby obtaining alternative formulations in the discrete-time
case. Using a very short and simple proof, we are able
to give a complete solution to the problem of finding all
universal tracking regulators, i.e., all regulators which achieve
asymptotic tracking (13) for all values of the complex vector
and
and which do not
amplitudes
depend on these amplitudes. This will be done in Section IV.
As a preliminary for this, and to set up notations, in Section III
), and we
we first consider an undisturbed system (
characterize all regulators (12) achieving the design objective
(13) for all reference signals , not only harmonic ones, and
all initial conditions; we shall refer to this property as Tuniversal. The solution of this problem is certainly known,
but we include it for conceptual reasons.
, i.e., the dimension of
is larger than
However, if
the number of outputs available for feedback, no universal
tracking regulator exists, so a nonzero tracking error remains.
To damp this error we turn to our main problem, namely to
characterize all optimal universal regulators, as defined above.
Also, we may want to use a criterion (8) even if asymptotic
tracing is possible, if it is desirable to damp the control energy
and/or some particular internal system variables. This is the
topic of Section V, where optimality in the linear class is
studied. In Section VI we show that these linear universal
regulators are optimal also in the wider class of nonlinear
regulators satisfying (11), provided slightly stronger technical
conditions are satisfied. The complete solution is given. We
note that a similar but different optimization problem, over a
finite horizon, is considered in [26].
Obviously, there is no a priori guarantee that a regulator
which minimizes (8) will also satisfy other design specifications, and hence we look for complete solutions with many
free parameters which then can be tuned by loop shaping. In
fact, all our results are based on a parameterization derived
in Section II, which is akin to that of Youla and Kuc̆era
and which generalizes some parameterizations previously presented in [21] and [22].
Finally, in Section VII, we give some simple numerical
examples.
II. LINEAR STABILIZING AND REALIZABLE REGULATORS

(15b)
(15c)
so, in particular,
(16)
where

is the

matrix polynomial
(17)
,

Similarly, the transfer functions
respectively, are given by

from

to

which stabilize the control system (1) and which are realizable
in a sense to be defined shortly. As before, is the backward
, and
,
, and
are real matrix
shift
,
, and
, respectively.
polynomials of dimensions
Let us consider a bit closer the meaning of (14) being
,
,
stabilizing. To this end, note that the transfer functions
from
to , , and , respectively, in the closed-loop
system (1), (14) satisfy

which together with (16) yields
(19)
We shall say that the regulator (14) is stabilizing if the matrix
is stable, i.e.,
for
.
polynomial
Next we consider the condition that the regulator be realizable. Clearly (14) must be nonanticipatory in the sense that
does not depend on future values of
and . To ensure
this, we must assume that
and

are proper

(20)

.
requiring in particular that
Let us investigate what properties must have for (20) to
be satisfied. To this end, let us introduce the rational transfer
functions

(21)
from the control signal to the outputs
Then it is easy to see that

and

, respectively.

(22)
and that

(23)
Writing (22) in the alternative form

we see that (20) implies that
is strictly proper and
is proper. In fact,
is strictly proper, making
as well as its inverse proper. Then, it follows from
and
are strictly proper also. Consequently
(23) that
where

(15a)

,

(18)

In order to design universal regulators we need a parameterization of all linear regulators
(14)

and

is finite

(24)

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

so that
and
depend on
for
only and on
for
only. We shall say that the regulator (14) is realizable
if condition (24) is satisfied. At the end of this section we
shall demonstrate that any stabilizing and realizable regulator
satisfies (20) so that the nonanticipatory property is implied
(Corollary 2.3).
We say that two regulators

and

are equivalent if there are stable
and
such that

matrix polynomials
(25)

Hence we allow the systems matrices , , and to have
stable common factors, as coprimeness is not required. Clearly,
,
,
, and
as can be seen from (22) and (23),
are invariant under this equivalence and so are the regulator
transfer functions (20).
is a stable matrix, i.e.,
From now on, we assume that
for all
. Since
is stabilizable
is detectable, this is no restriction. In fact, it is
and
well-known that the system (1) can be replaced by a similar
system having a stable -matrix but, in general, a larger
dimension. (See any standard text, such as [1] and [18].) Only
under special conditions [15], including the case of complete
state observation, is it possible to do this by constant feedback,
but the system can always be stabilized by a dynamic observer.
Then, extending the state space by including this observer, a
system with stable -matrix is obtained. For these reasons we
shall from now on, without loss of generality, assume that
in (1) is a stable matrix.
The following theorem, generalizing a similar result in
[22], provides a parameterization akin to the well-known
Youla–Kuc̆era parameterization. (We note that if is not stable, also the latter parameterization requires an observer-based
prestabilization, increasing the dimension of the regulator; see,
e.g., [32, p. 226].)
be a stable matrix with
Theorem 2.1: Let
being its characteristic polynomial, and let
and
be the matrix polynomials
(26)
be an arbitrary stable scalar polynomial
Moreover, let
and
be arbitrary matrix polynomials of
and let
and
, respectively, such that
dimensions

1691

is stabilizing and realizable, and for this regulator
(30)
and
(31)
is given by (17). Conversely, any stabilizing and
where
realizable regulator (28) is equivalent to one constructed in
this way.
Before turning to the proof of this parameterization, let us
is a
briefly explain the nature of relation (31). Although
for the regulator defined via (29), this is in
factor in
general not the case for an arbitrary regulator belonging the
same equivalence class. In fact, while the closed-loop transfer
and the regulator transfer functions
and
function
are invariant under the equivalence (25),
is not.
Taking the Schur complement, it immediately follows from
(17) that
(32)
is given by (21). Since, in general, the second factor
where
in
is not a polynomial, is of course not a factor in
general. Nevertheless, it will turn out to be useful to represent
each equivalence class by a regulator that has this property.
Proof of Theorem 2.1: In view of (29), we have
(33)
and consequently (30) follows from (22) and (31) follows from
is a stable matrix poly(32). By construction, therefore,
nomial, establishing that the regulator is stabilizing. Moreover,
is strictly proper and
is proper, i.e.,
in view of (27),
and
is finite. It then follows from (23)
and
are strictly proper, and hence the regulator
that
is realizable.
,
,
To prove the converse statement, suppose that
is an arbitrary stabilizing and realizable regulator. Then (32)
may be written

where

is the

matrix polynomial
(34)

which is stable and full rank, since
stable and nontrivial. It follows from (22) that

is
(35)

(27)

and
are the closed-loop transfer functions
where
, ,
. Therefore, setting
corresponding to the regulator

(28)

and

(29)

where
, (35) shows that

Then the regulator

with
is the adjoint matrix polynomial of
and
are given by (30). Since
,

1692

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

,
is a realizable regulator, it follows from (24) that the
and
degree conditions (27) hold. Consequently, defining
via (29), it follows from the first part of the theorem that
, ,
is a stabilizing and realizable regulator with the
and
as
,
,
same closed-loop transfer functions
. It remains to show that
, ,
and
,
,
are
equivalent. To this end, note that

Also it follows from (34) that

Consequently

i.e.,

and

are equivalent as required.

If
so that
, the representation of stabilizing
regulators can be simplified considerably, since and can be
chosen so that cancellations occur. Since this formulation has a
different form and, moreover, will be used later, we state it as
a corollary. Note that, in view of the converse statement, this
corollary is strictly speaking not a special case of Theorem 2.1.
It is in fact a generalization of [21, Lemma 4.3], but the proof
here is new.
Corollary 2.2: Let be a stable matrix, and suppose that
. Let
be an arbitrary real scalar stable polynomial,
and
be arbitrary real matrix polynomials,
and let
and
, respectively, such that
of dimensions
(36)
Then the regulator
(37)

Conversely, by Theorem 2.1, any stabilizing and realizable
regulator (37) is equivalent to some regulator
of
the type described in Theorem 2.1, where we set
everywhere. It remains to show that
is also a
regulator of the type described in the corollary. To this end,
. This implies that
,
define
and hence the equations of Theorem 2.1 become those of the
replaced by . Hence
is also a
corollary with
regulator in the sense of the corollary.
In the beginning of this section we demonstrated that the
realizability condition (24) is a consequence of nonanticipatory
condition (20). Next we show that the converse is also true,
has full rank as assumed in (6).
provided
. Then, for any
Corollary 2.3: Suppose that
stabilizing regulator (28), the realizability condition (24) and
the nonanticipatory condition (20) are equivalent.
Proof: The proof is immediate in the special case
. In fact, for a regulator (37) with
and
given by (38),
condition (20) is a direct consequence of the degree condition
(36). For any other stabilizing regulator (37), it follows from
the definition of equivalence.
The general case follows from the fact that (28) is a subclass
of (37). In fact, writing (28) as

it follows from what has already been proved that
is proper. Since
has full rank, this implies that
is proper follows directly.
proper. That
III.

is

-UNIVERSAL REGULATORS

As a preliminary for the analysis in Sections IV and V,
in this section we consider the problem of controlling the
undisturbed system
(40a)
(40b)
(40c)

with
(38)
is stabilizing and realizable, and, for this regulator
(39)
satisfies (31). Conversely, any stabilizing and
and
realizable regulator (37) is equivalent to one constructed in
this way.
Proof: Let the polynomials and be chosen as in the
and
statement of the corollary, and take
to be the corresponding polynomials
and
in Theorem 2.1. Then, since
, the degree conditions (27) are satisfied for
and .
Moreover, the corresponding regulator polynomials matrices
and
, become
(29), which we denote
and
, where
and
are given by (38). Then,
, the regulator
,
,
is stabilizing and
setting
realizable by Theorem 2.1. Thanks to cancellation, therefore,
is a stabilizing and realizable regulator for the
problem of Corollary 2.2, as claimed.

so that it tracks a given
by feedback from the output
in the sense that
reference signal
as

(41)

As explained in Section II it is no restriction to assume that
is stable if it is assumed that
is stabilizable and
is detectable. The solution of this problem is simple
and certainly known, but we include it for completeness and
for conceptual reasons.
More precisely, we want to find a stabilizing and realizable
regulator of the form
(42)
which is universal for the asymptotic tracking problem in the
sense that (41) holds for all solutions of (40), (42), and all
reference signals . More specifically we shall refer to this
property as T-universal.
Clearly, for (42) to be stabilizing and realizable, the matrix
,
, and
must satisfy the specifipolynomials
cations of Theorem 2.1. It remains to investigate under what

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

conditions the tracking criterion (41) is satisfied and under
what conditions this regulator is T-universal.
We begin by deriving a necessary condition for Tuniversality. Consider a reference signal of the type
(43)
and
are fixed but arbitrary. Then the
where
closed-loop system (40), (42) has solutions

1693

delays between
and . Indeed, the condition (48) for Tuniversality imposes some rather stringent conditions on the
is
and
is
,
system (40). In particular, since
, and
must have full rank.
(48) implies that
Theorem 3.2: Suppose that is stable. Then there exists a
T-universal regulator for the tracking problem if and only if
matrix function
with no
there is a proper rational
which satisfies the equation
poles in the region
(49)

(44)
with

which, in particular, implies that
In this case, let be a stable scalar polynomial such that

.
(50)

(45)
,
where
are defined by (21). Moreover,

, and

and
(46)

But the tracking condition (41) requires that
as
and, since is arbitrary, this implies that
follows from (44) and (46) that

. Therefore, it
(47)

Now, in order for the regulator (42) be T-universal, (47) must
hold for all , that is, for all and . Consequently, we must
have
(48)
on the unit circle and, by analytic continuation, in the rest of
the complex plane.
Lemma 3.1: A stabilizing and realizable regulator (42) is
T-universal if and only if the identity (48) holds.
Proof: We have already proved that (48) is a necessary
condition for (42) to be T-universal, so it remains to prove
that it is also sufficient. To this end, first assume that there are
such that
for all . Then
positive numbers ,
has a -transform

which converges for
. It follows from (45) and
is the transfer function from
to ,
(46) that
with a -transform
and hence (40), (42) has a solution
. But, if (48) holds, then
and hence
for all . Because of stability any other solution
tends asymptotically to this solution, and therefore (41) holds.
If increases so fast that it does not have a -transform, set
for
and
for
, and
be the corresponding -solution. Then it is easy to see
let
for
. Since
is arbitrary, the
that
conclusion follows.
As a corollary we see that
must be full rank, or
else (48) will be violated. This implies that there are no

be a
matrix
is a matrix polynomial, and let
polynomial satisfying the first degree constraint (27). Then, the
and
given by (29), is a T-universal
regulator (28), with
regulator for the tracking problem, and any other T-universal
regulator is equivalent to one obtained in this way.
Proof: First, suppose that there exists a T-universal regulator of the form (42). Then, according to Lemma 3.1, there
to (49) with the prescribed properties,
exists a solution
. In fact, in view of (22), (32) and the fact that
namely
is stable, it follows that
has no poles in the region
. Moreover, since the regulator is realizable,
is
proper.
which is proper
Next, suppose that (49) has a solution
, and let , , and be
with no poles in the region
defined as in the theorem. [Note that in order to satisfy the
first of degree conditions (27) we may need to choose and
which are not coprime.] Then, by Theorem 2.1, the regulator
given by (29) is stabilizing and realizable and
(28) with
(51)
. Consequently, it follows from
i.e., in view of (50),
(49) and Lemma 3.1 that the regulator is T-universal.
It remains to prove the last statement of the theorem. To
this end, suppose that the regulator
(52)
is T-universal. Then, in particular, it is stabilizing and realizable, and thus, by Theorem 2.1, there are some , , and
with the properties specified in Theorem 2.1 such that the
given by (29) is equivalent to (52).
regulator (28) with
is invariant under this equivalence. Therefore, since
Now,
(48) holds for the regulator (52) by Lemma 3.1, (48) also holds
for (28). However, by Theorem 2.1, (51) holds, and hence there
, satisfying (49) and (50).
is an , namely
In general, a solution to (49) cannot be expected to be
, only one solution is possible, namely
unique, but if

and this would require that
is a stable, proper rational
must be minimum phase with
function, implying that
must be
no zeros at infinity. In particular,
nonsingular.

1694

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

Corollary 3.3: Suppose that
is stable and the transfer
is square, i.e.,
.
function
Then there is a T-universal regulator for the tracking problem
is proper with no poles in the region
if and only if
. In this case, let
be a stable scalar polynomial
is a matrix polynomial and
is
such that
matrix polynomial satisfying the degree requirement
a
and
are defined by (29) and by
(27). Then, if
(53)
the regulator (28) is a T-universal regulator, and any other
T-universal regulator is equivalent to one obtained in this way.
A T-universal regulator exists only under rather special
conditions. However, if we restrict our attention to harmonic
reference signals (4), these conditions can be considerably
relaxed and we may also allow for external harmonic disturbances. This is the topic of the next section.

respectively, satisfying the degree requirements (27) and the
interpolation conditions
for
for

(59b)

and
are given by (29), the regulator (28) is a
Then, if
universal tracking regulator, and any other universal tracking
regulator (28) is equivalent to one obtained in this way.
Proof: Whenever a linear stabilizing regulator is applied
tends exponentially to the
to system (1), the process
harmonic steady-state solution
(60)
where
(61a)

IV. UNIVERSAL TRACKING REGULATORS
IN HARMONICALLY DISTURBED SYSTEMS

(61b)

We now return to the situation described in Section I,
where the control system takes the form (1) with a harmonic
disturbance (2) and where there is a harmonic reference signal
to be empty, for
(4). Although we may allow the index set
.
tracking we must take
The first question to be answered is when it is possible to
find a regulator (12) in such that
as

(59a)

,
,
, and
being the closed-loop transfer functions
,
defined in Section II. In fact, for any regulator in ,
defined by (17), is a stable matrix polynomial. In the same
tends exponentially to
way, in view of (1c),

(54)

(62)

which is universal in the sense that (54) holds for all values
and
and does not depend on these
of
vector amplitudes. We shall refer to such a regulator as a
universal tracking regulator. For convenience, in the sequel
we use the notation

Now, the basic idea is that the tracking condition (54) is
achieved precisely when the cost function (7) is zero. It is
easy to see that
(63)

(55)
is stable, and let
Theorem 4.1: Suppose that the matrix
and
be the matrix polynomials defined by (26).
be the
matrix function defined by
Moreover, let
the
matrix polynomial
(21) and

To see this, observe that if
sequences

and

are two harmonic vector

and

(56)
Then, for a universal tracking regulator to exist in
necessary that the rank condition
for all

, it is

with
distinct as in (3), and
appropriate dimensions, then

is an arbitrary matrix of

(57)

holds, and it is sufficient that both rank conditions (57) and
for all

(64)

(58)

, and
hold. In particular, (57) requires that
. More precisely, let
be
(58) that
and
an arbitrary stable scalar real polynomial, and let
be matrix polynomials, of dimensions
and
,

Moreover, in view of (61b) and (62)

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

1695

Remark 4.3—Internal Model Principle: The situation most
often studied in the literature is when
, i.e.,
,
, and
, and when the regulator (28) takes the form

and consequently (63) equals zero for all values of
and
if and only if
(65a)

for
for

(65b)

Theorem 2.1 states that the regulator (28) is stabilizing if
and
are defined by (29) for some stable scalar real
and some real matrix polynomials
polynomial
and
satisfying (27) and that any other stabilizing and
realizable regulator (28) is equivalent to one obtained in this
way. Moreover
(66)
which inserted into (65) yields precisely (59).
If the rank conditions (57) and (58) hold, the interpolation
conditions (59) have a solution, and the general solution is

obtained by setting
. We assume that the rank
.
conditions (57) and (58) are satisfied so that
For robustness it is desirable to include a model of the
disturbance dynamics in the regulator. This is the internal
model principle. Following [3], we replace the matrix fracby the (reachable) matrix fraction
tion representation
so that
. The harmonic
representation
dynamics is then included in the regulator dynamics by setting
, where
and
is a stable matrix polynomial. Then, by (29)

which, in view of the fact that

, yields

for
for
where, for
,
and
are arbitrary matrices
and
. Here
such that
the degree of the stable polynomial is chosen sufficiently
high to satisfy the degree constraints (67). On the other hand,
the rank condition (57) is also necessary for the existence of a
is stable, (65b)
universal tracking regulator. In fact, since
for some
.
cannot hold if
Remark 4.2: The two rank conditions (57) and (58) in
Theorem 4.1, which of course can be stated in terms of zeros
of certain transfer functions, have different status. If (57) is
violated, the interpolation condition (59b) cannot hold, so there
could be no universal tracking regulator. On the other hand,
if (57) holds but (58) does not, interpolation condition (59a)
could still be valid, as the rank of the right member could be
less than . However, this is a nongeneric situation, and hence
it cannot be expected to occur in practice. In fact, if
and
, the following equation must hold:

which will occur only on a lower-dimensional algebraic set in
the parameter space.
Theorem 4.1 provides a complete solution of a problem
studied in various degrees of generality in [4]–[8], [13], [16]
and of course is consistent with the solutions given there,
although given in a different form and in continuous time.
, rank condition (58) becomes void and only (57), a
If
considerably weaker version of condition (49) in Section III,
remains. Hence, for universal tracking regulators to exist the
is necessary, and if there are external
condition
, in practice, we must also have
.
disturbances
Consequently, as also noted in [4], [7], [8], [13], and [16],
asymptotic tracking is only possible under certain specific
conditions.

where we have assumed that
has no zeros in the points
. (Otherwise we include a simple feedback loop to
clearly satisfy the interpolation
move the zeros.) These
,
and
conditions (59). In fact, since
, by (29), these can be written
for
for
Consequently, we see that the internal-model-principle regulators form a subclass of the ones considered above.
, which
The rank condition (58) becomes void if
is equivalent to the case with complete state information, i.e.,
. Then the formulas for the regulator
the case when
also simplify considerably.
so that
.
Theorem 4.4: Suppose that
Moreover, suppose that is stable and that condition (6) holds.
Then, there exists a universal tracking regulator (37) in if
and only if the rank condition (57) holds. In fact, let
be a stable scalar real polynomial, and let
and
be
matrix polynomials satisfying the degree constraints (36) and
the interpolation conditions
for
for

(67a)
(67b)

and
are given by (38), the regulator (37) is a
Then, if
universal tracking regulator, and any other universal tracking
regulator (37) is equivalent to one obtained in this way.

1696

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

Proof: The proof follows the same lines as that of
Theorem 4.1, except that (39) from Corollary 2.2 is used in
,
exists and (67a)
lieu of (66). Since
can be solved.
When
, there are no universal tracking regulators,
and in order to damp the steady-state tracking error we shall
therefore next turn to an optimization procedure. This is the
topic of the next section.
V. LINEAR QUADRATIC OPTIMIZATION
FOR TRACKING AND DAMPING
We now return to the optimization problem stated in
Section I. In this section we consider only linear regulators.
Later, in Section VI, we demonstrate that under slightly
stronger technical conditions the optimal universal regulators
presented here are actually optimal in the much larger class
, which includes nonlinear regulators.
Let us recall that the problem under consideration is to
control the disturbed system (1) by feedback from the output
so as to minimize the cost function
(68)

for all

,

satisfying
(73)

such that
. It can be shown [21]
for all
that if this condition fails in a strong way, i.e., there are
, , and ,
, such that
, then there
such that
. In
is an external disturbance
this section, however, we shall only need the weak frequency
, ,
,
domain condition that (72) and (73) hold for
, defined as in (55).
Both of these conditions are invariant under the action of
the feedback group

where is a nonsingular matrix and is an arbitrary matrix of
appropriate dimensions. Moreover, since has no eigenvalues
on the unit circle, the inverse
(74)
exists for all on the unit circle, and hence
where
is the Hermitian
that
matrix function

so

(75)
is the quadratic form defined by (9). Hence,
where
we may not only want to damp the tracking error, but also
some internal systems variables. As before, both the disturand the reference signal are harmonic and given by
bance
(5), where only the frequencies are known. The optimization is
performed over the class of stabilizing and realizable linear
regulators (12). The problem under consideration is: 1) to find
the conditions under which there are optimal regulators which
are universal in the sense that they are optimal for all choices
of the amplitudes of (5) and independent of these and 2) to
characterize the class of all such universal optimal regulators.
To address this problem, let us first take a closer look at
the cost function (68). A straightforward reformulation taking
(1c) into consideration yields

In this notation the strong frequency domain condition may
be written
for all

is the real quadratic form
(70)

with the real matrices

,

, and

given by

(71)
The quadratic form (70) need not be nonnegative definite but
must of course satisfy some condition ensuring that
. As we shall see, a sufficient condition for this is the
strong frequency domain condition, i.e., that there is a
such that
(72)

(76)

and the weak one as
for

(77)

We now state the main result of this section. It will be
strengthened in Section VI, where we show that under mild
is
technical conditions the optimal universal regulator in
also optimal in the wider class .
,
, and
be the matrix
Theorem 5.1: Let
polynomials defined by (26) and (56). Suppose that the matrix
is stable and that the weak frequency domain condition
(77) holds, and suppose that
for all

(69)
where

on the unit circle

(78)

. Then,
i.e., in particular that
which is universal in
there exists an optimal regulator in
and
the sense that it is optimal for all values of
and does not depend on these vector amplitudes.
be an arbitrary stable scalar real
More precisely, let
and
be matrix polynomials of
polynomial, and let
and
, respectively, satisfying the degree
dimensions
requirements (27) and the interpolation conditions

with

and

for

(79a)

for

(79b)

given by
(80)

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

where
. Then the regulator (28) is an
and
universal regulator, which is optimal in , provided
are given by (29) and any other universal regulator (28), which
is optimal in , is equivalent to one obtained in this way.
is nonsingular for
Since, by assumption,
, (79a) has the solution

1697

(60) of
. In fact, we have the following lemma. The
proof follows from a simple completion-of-squares argument
and is deferred to Appendix A.
be any solution to the closed-loop
Lemma 5.5: Let
system (1), (12), where (12) is a stabilizing and realizable regulator, and suppose that the weak frequency domain condition
(77) holds. Then the cost function (68) exists as a usual limit,
and it takes the value

(81)
, and these are precisely all solutions of (79a).
for
and
Clearly, there are always matrix polynomials
satisfying (81), (79b) and the degree constraints (27), provided
is chosen
the degree of the stable scalar polynomial
sufficiently large.
, there exist optimal regulators, but,
Remark 5.2: If
as explained in Remark 4.2, universality is not a generic
property; therefore, for all practical purposes, there are no
.
optimal universal regulators if
Remark 5.3: Before proceeding to the proof of Theorem
5.1, let us make certain that it is consistent with the results
of Section IV. To this end, let us consider a cost function (7),
. Then
i.e., suppose that

(82)

where, for
(83)
with

and

given by (80) and

by
(84)

where
where the
matrix function
is given by (21). If
, the weak frequency domain condition cannot hold,
so Theorem 5.1 does not apply. Instead, Theorem 4.1 should
, the weak frequency domain condition is
be used. If
a consequence of condition (57), and it is easy to check that
the optimal cost will be zero, as required by Theorem 4.1.
Moreover, interpolation conditions (59) and (79) are identical.
, no universal tracking regulator exists by
Finally, if
Theorem 4.1, and the optimal cost will be nonzero in general.
Remark 5.4—Generalized Internal Model Principle: As in
, so that
Remark 4.3, let us consider the case when
,
,
, and
, and
in the regulator (28). For simplicity, also assume that
.
and
and
, the interpolation
If
conditions (79) can be written

(85)
,
In the expression (82) for the cost function , only
, ,
depend on the regulator to be chosen. They are
defined by (61b), i.e.,
(86)
of external disturbances
Recall that we consider the class
for
and
for
with arbitrary
and the class of reference signals with
for
and
for
.
Consequently, if we could find a stabilizing and realizsatisfy the
able regulator (12) such that
optimality conditions
(87)

for
, as can be seen from (29), (80), and
,
, and
. All of these
the fact that
interpolation conditions are satisfied if the second set is, and
in this case (29) implies that

which could be interpreted as a generalized internal model
principle for the optimization problem.
The basic idea behind the proof of Theorem 5.1 is, as for
Theorem 4.1, that whenever a linear stabilizing regulator is
tends exponenapplied to the system (1), the process
tially to the harmonic steady-state solution (60). Therefore, the
cost function (68) depends only on the harmonic component

which, in view of (86), is the same as
(88)
then this regulator would be optimal. If, in addition, this regu,
lator does not depend on the amplitudes
and
,
and the conditions (88) hold for all
and
, i.e., all disturbances in
and all
reference signals in , then this optimal regulator is also
universal. This condition holds if and only if
for

(89a)

for

(89b)

1698

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

Proof of Theorem 5.1: Theorem 2.1 states that the reguand
are defined by (29) for
lator (28) is stabilizing if
and some real matrix
some stable scalar real polynomial
satisfying (27), and that any other stabilizing
polynomial
and realizable regulator (28) is equivalent to one obtained in
this way. Moreover

Since, by assumption,
is a nonsingular matrix of
, (91a) has the solution
dimension

(92)
. There are always matrix polynomials
and
satisfying (92), (91b), and the degree constraints (36),
is
provided the degree of the stable scalar polynomial
chosen sufficiently large.
for

(90)
We have demonstrated above that (89) is a necessary condition
for the regulator (28) to be an optimal universal regulator, and
inserting (90) into (89) yields precisely (79). Clearly, as we
have already discussed, there are always matrix polynomials
and
satisfying these conditions and the degree
constraints (27), provided the degree of the stable scalar
is chosen sufficiently large, and provided
polynomial
condition (78) is satisfied.
It remains to prove the converse statement. For any optimal
, the value of the cost function
universal regulator
, defined by (84). It follows from (82) and the
(68) equals
, for
, that (87) holds for
fact that
, and
. Therefore, (89) follows from
all
is equivalent to
(88). By Theorem 2.1, the regulator
given by (29) for some
satisfying the
(28) with
requirements of Theorem 5.1. This regulator is also optimal
since equivalent regulators have the same cost . It is also
does not depend on
universal because
and
.
Corollary 5.6: The optimal value of the cost function (68)
, defined by (82) and (83).
in the class is
Note that, although an optimal universal regulator will not
and
, the cost function (84)
depend on
will.
In the special case of complete state information, i.e.,
, condition (78) is always satisfied. In view of Corollary 2.2,
Theorem 5.1 can be considerably simplified in this case, so we
state it separately. The proof is the same as for Theorem 5.1,
except that we now use the equations of Corollary 2.2.
so that
.
Theorem 5.7: Suppose that
Moreover, suppose that is stable and that condition (6) holds.
Then, if the weak frequency domain condition (77) holds, there
exists a universal regulator (37), which is optimal in . In fact,
let
be a stable scalar real polynomial, and let
and
be matrix polynomials satisfying the degree constraints
(36) and the interpolation conditions
for

(91a)

for

(91b)

and
are
where and are defined as in (80). Then, if
given by (38), the regulator (37) is a universal regulator, which
is optimal in . Conversely, any other universal regulator (37),
which is optimal in , is equivalent to one obtained in this
way. Finally, the optimal value of the cost function (68) is
given by (84).

VI. OPTIMALITY IN THE CLASS OF NONLINEAR REGULATORS
In this section we show that the universal optimal linear
regulators described in Theorems 5.1 and 5.7 are actually
optimal in a wide class of nonlinear regulators. We now define
this class.
of
Given the control system (1), consider the class
nonlinear regulators
(93)
of
which is stabilizing in the sense that any solution
the closed-loop system consisting of (1) and (93) satisfies the
condition
as

(94)

This stability condition is quite weak but will suffice for our
purposes. Of course, a weaker condition has the advantage of
allowing for a larger class of controls.
We consider the same problem as in Section V, except that
.
we now optimize over all regulators in . Clearly,
The only price we have to pay for this generalization is that
the weak frequency domain condition needs to be replaced by
the strong one.
be stable, and suppose that the rank
Theorem 6.1: Let
condition (78) holds. Then, if the strong frequency domain
condition (76) holds, the linear optimal universal regulators of
Theorem 5.1 are optimal in the class .
It turns out that Theorem 6.1 is a simple consequence of the
corresponding result for complete state information. In fact, the
class of stabilizing and realizable regulators
with
is a subclass of the class of stabilizing and realizable regulators

in that only a special structure of is required. But, as seen in
Section V, an optimal universal regulator in the former class
is optimal also in the latter, since the same optimal value
is achieved (Corollary 5.6 and Theorem 5.7). (The only
difference between the cases of complete and incomplete state
information is that a higher degree regulator may be required
in the latter case to achieve the optimum.) Consequently, if
we can prove the following theorem, we have also proved
Theorem 6.1.

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

Theorem 6.2: Let
be stable, and suppose that
and that
. Then, if the strong frequency domain
condition (76) holds, the linear optimal universal regulators of
Theorem 5.7 are optimal in the class .
In order to prove this theorem we consider an optimization
problem which unlike that in Section V does not require that
a linear regulator has been applied. More precisely, let us
first consider the problem of finding a process
which minimizes the cost function (8), subject to the constraints (94) and
(95)
and
are arbitrary bounded and
where now
complex-valued vector sequences.
It is well known (see, e.g., [20], [21], [24], [25], and [29])
that if the strong frequency domain condition (76) holds and
is stabilizable, then the algebraic Riccati equation

1699

The optimal value of the cost function is
(103)
where

(104)
exists, any optimal process
If the limit
is produced in this way.
Note that the control (101) cannot in general be used in
and . Even
practice, since it depends on future values of
in the harmonic case when this dependence can be resolved,
this control law has serious disadvantages [21, Sec. III]. It is
developed here as an instrument of proof.
Next, let us return to our original problem and take
and
to be harmonic, given by (5). Then a simple
calculation, using (99) and (100), yields the representation

(96)
has a unique symmetric solution
matrix

with

which renders the feedback

(105)

where

where
(97)
stable in the sense that all eigenvalues of lie strictly inside
the unit circle. We shall refer to this solution as the stabilizing
solution of (96). For this solution we also have that
(98)
is positive definite.1
Then we have the following result, which should be compared to [21, Th. 2.3], the proof of which we defer to
Appendix B.
be stabilizable and suppose that
Lemma 6.3: Let
the strong frequency domain condition (76) holds so that (96)
has a stabilizing solution . Moreover, let

We are now in a position to prove Theorem 6.1.
Proof of Theorem 6.1: Clearly, for any regulator in ,
(103) is a lower bound for the cost . Therefore, if we can
demonstrate that there is a regulator in which achieves the
same value (103) of the cost , this regulator must be optimal
also in , and so must all regulators which are optimal in .
so that
To this end, let us introduce a new control
(106)
transforming the system (1a) to
(107)

(99)
where

We want to find a stabilizing and realizable regulator
(100)

Then the problem to minimize the cost function (8) subject
to constraints (94) and (95) is solved by a process
such that

(108)
so that the closed-loop system (106)–(108) has a solution
satisfying (101) for some with the property (102).
Then, by Lemma 6.3, the regulator (106), (108), i.e.,
(109)

(101)
where is given by (97) and
such that

is any vector sequence

(102)
1 Note that there is a misprint in [21, p. 788]: In Theorem 2.1, replace
“statements hold” for “statements are equivalent.”

is optimal in . Therefore, the optimal linear regulators of
Theorem 2.1 must be optimal also in .
of the closedSince (108) is stabilizing, the solution
loop system (107), (108) tends exponentially to a harmonic
solution

1700

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

which of course yields the same value to
so that
if we can choose

as

. Now,

for

The matrix polynomials (26) are
and

(110)

, then
has the property (102)
and hence
and (106) becomes (101) as required.
such that (110) holds, we
To show that there are
first apply Corollary 2.2 to the system (107), where takes
and
that of . In fact, by Corollary 2.2,
the place of
there is a stable scalar polynomial and matrix polynomials
such that
and
so that
are given by
and

Let us first take
a T-universal regulator

and consider the problem to find
(112)

tends asymptotically to . By Corollary 3.3, a
so that
T-universal regulator exists if and only if
and

stable

(113)

where

and
In fact,
. In this case, (112) is a Tuniversal regulator if and only if
However,
tends exponentially to the harmonic solution
Since therefore

.

and
is given by (105), the optimality condition (110) will
and
if
be satisfied for all

(114)
and
such that
is stable and
for some polynomials
or is equivalent to one obtained in this
. Of course,
way. This corresponds to the choice
asymptotic tracking is achieved for all choices of reference
signal .
If, instead, we consider a reference signal
(115)

Since

is full rank, in view of the discussion in Section V
can be chosen to satisfy these interpolation
conditions.
VII. SOME SIMPLE NUMERICAL EXAMPLES

for

To illustrate the results of this paper, let us consider the
system

is the control,
where
characteristic polynomial

and

where the frequencies , are given, but the amplitudes ,
and the phases ,
are unknown, the class of regulators
(112) which achieve asymptotic tracking is much larger, and
condition (113) need not be satisfied but can be exchanged for
(116)

In fact, by Theorem 4.1, in this case we may choose any
stabilizing regulator

(111)

(117)

are outputs, and the

provided is stable and the degree constraint (27) and the
interpolation conditions
for

is stable with

. Defining the state

the plant equations (111) can be written in state-space form
(1), where

so that

is the characteristic polynomial of

, and

are satisfied. The same regulator is obtained by applying
Theorem 5.1, now observing that (116) is the weak frequency
domain condition; see Remark 5.3. This allows for more tuning
parameters to satisfy other design specifications. Of course, if
condition (113) is fulfilled, the T-universal regulator can still
be used.
,
, and
As a numerical example, suppose that
, and let
and
. Then condition (113)
is satisfied, so a T-universal regulator exists. Such a regulator
and
in
is obtained by, for example, setting
and
and the initial conditions are
(114). If
, this yields the error depicted in Fig. 2. The

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

Fig. 2.

Fig. 3.

dashed line in the same figure is the tracking error obtained
.
by setting
, while and remain the same.
Next, let us take
Then becomes unstable, so a T-universal regulator fails to
exist. Although condition (113) fails, we could still obtain
asymptotic tracking by using a universal tracking regulator,
constructed as in Theorem 4.1, provided condition (116) holds,
and we shall present a simulation for this case in the end of
the section.
We now add an harmonic disturbance

straightforward calculation yields

(118)
and ,
in the system (111), where , are given, but ,
are unknown. Suppose we want to determine an optimal
universal regulator for the cost function

1701

for any on the unit circle. In order to construct an optimal
universal regulator we need to choose a stable polynomial

of degree at least five. The parameters , , , , , as
well as will be available for tuning in order to improve the
overall design. Then, defining the real numbers , , , ,
, , ,
via
for
for

(119)
it is easily seen that the polynomials
Since the matrices

,

, and

in (71) become

a simple calculation yields

will satisfy the interpolation conditions (79a) if and only if its
coefficients satisfy the linear system of equations

for (75), and therefore the strong frequency domain condition
, so any optimal universal
(76) is always satisfied if
of possibly
regulator (112) is optimal in the larger class
, the
nonlinear regulators described in Section VI. If
strong frequency domain condition will fail if and only if the
has a root on the unit circle, while the weak
polynomial
frequency condition (77) will still hold provided we avoid
choosing any of the frequencies in (115) and (118) so that
,
,
, or
is such a root.
Next, let us consider the interpolation condition (79).
defined by (56) is identically one, and a
Clearly,

Consequently, by Theorem 5.1, (117) is an optimal universal
and
are determined in this way.
regulator if
,
, and
For an example, take as before
. Moreover, we choose a disturbance (118) with
and
, while the harmonic
frequencies
,
reference signal (115) has the same frequencies
as in the first simulation. In Fig. 3 we illustrate the
tracking error of the optimal universal regulator corresponding
to a polynomial with roots 0.3 0.3 , 0.3 0.2 , 0.5, and
. The amplitudes in (115) and (118) have been taken

1702

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

Fig. 4.

to be
,
, and
, and the initial
. As before, the dashed line is
conditions are
. Remember
the tracking error obtained by setting
, the control energy is also damped, so
that, since
there is a certain tradeoff here. We remark that it is important
to tune the free parameters to obtain good properties of the
regulator. In particular, the transients, which do not affect the
cost function, can change dramatically with different choices
of free parameters.
and
instead,
Now, setting
while keeping all the other parameters the same, we obtain
the errors in Fig. 4. As seen, the error goes asymptotically
to zero, despite the fact that condition (113) is not fulfilled so
that a T-universal regulator does not exist. In fact, by Theorem
4.1, this is a universal tracking regulator which exists since
on the unit circle. In order to speed up the
convergence, the roots of have been reset at 0.7 0.1 , 0.3
0.2 , and 0.8. Since now we do not have the disturbance
and
, we could choose another
frequencies
to possibly get a universal tracking regulator with a
better transient.

reference signal is no larger than the dimension
of the
control, such a regulator exists under mild conditions. This
is in harmony with other results in the literature [4]–[8], [13],
[16], where, however, the continuous-time case is considered.
We provided complete solutions of these problems in discrete
time, and our proof is considerably simpler.
If the system is also corrupted by a harmonic disturbance
, asymptotic tracking may still be possible provided the
dimension of the disturbance is no larger than the dimension
of the output available for feedback. However, if a certain
,
rank condition fails, which in particular is the case if
asymptotic tracking is not possible, but a steady-state error
will remain. Therefore, we considered next an optimal control
problem to damp the steady-state tracking error, also giving
the option to damp internal system variables. We characterized
the class of all optimal regulators which are universal in the
sense that they are optimal for all choices of the amplitudes
of and . Such regulators were shown to exist if the weak
. On the other
frequency domain condition holds and
, there are always algebraic conditions on the
hand, if
system parameters, implying that universality is not a generic
property in this case.
We have also shown that all optimal universal regulators
can be chosen as linear even if the optimization is over a
very large class of nonlinear regulators, provided the strong
frequency domain condition holds. We have given complete
characterizations of all linear optimal universal regulators in
terms of parameterizations containing many free parameters.
This allows for a considerable amount of design freedom,
which can be used to satisfy other design specifications via
loop shaping. Indeed, we stress that our solutions are optimal
in the sense stated in this paper only, and that other desirable
design specifications may not be satisfied for an arbitrary
universal optimal regulator.
APPENDIX A
PROOF OF LEMMA 5.5
and
tend exponentially to the harmonic comSince
ponents (60), only these contribute to the cost function (70);
consequently, the usual limit (rather than just limsup) does
where
exist in (69), and it is given by

VIII. CONCLUSIONS
In this paper we have given complete characterizations of
regulators which satisfy certain tracking specifications and
which are universal in the sense that they are independent
of disturbances and tracking signals and apply regardless of
the values of these.
As a preliminary, we considered a problem of asymptotic
tracking of an arbitrary signal , and we characterized all
regulators which are universal with respect to the choice of
. We showed that such universal regulators exist only under
very special conditions. These conditions can be considerably
relaxed if the reference signal is exchanged for a harmonic
signal with known frequencies but unknown amplitudes and
phases, and we want the regulator to be universal in the
sense that it achieves asymptotic tracking for all choices
of the
of amplitudes and phases. Then, if the dimension

(A1)
. In fact, this follows from the argument
for
leading to (64). Now, in view of the constraint (1a)
(A2)
and therefore (A1) takes the form
(A3)
if the weak frequency domain condition (77)
where
is given by (85), and
is fulfilled. Here
(A4)

LINDQUIST AND YAKUBOVICH: UNIVERSAL REGULATORS FOR OPTIMAL TRACKING

Therefore, assuming that the weak frequency domain condition
for
, we may
(77) holds so that
complete squares in (A3) to obtain
(A5)
where

1703

By virtue of condition (94) and the boundedness of

where of course the last term tends to zero as
.
, the cost function
Consequently, for any admissible
(B1) becomes

(A6)
From this the equations of the lemma follow readily.
(B5)

APPENDIX B
PROOF OF LEMMA 6.3
The proof is similar, mutatis mutandis, to the one given in
[21, Sec. II]. Recall from (69) that the cost function can be
written
(B1)
where

Therefore, since
(B6)
for any admissible control. Clearly, equality would be achieved
to satisfy (101) since
does not
if we could take
contribute to by virtue of (102). Hence it remains to prove
that such a process satisfies the stability condition (94). To this
end, insert (101) in (95) to obtain
(B7)

(B2)
being the quadratic form (70). Next, introduce
with
the Lyapunov function
(B3)
is the unique stabilizing solution of (96),
where
is given by (100) and
satisfies (104). Then, along
the trajectory of (95)

and
are bounded,
satisfies
Since
is a stability matrix,
satisfies the
(102) and
weak stability condition (94). The last statement follows
immediately from (B5) and (B6).
ACKNOWLEDGMENT
The authors would like to thank the anonymous referees and
the associate editor for several useful suggestions. They would
also like to thank X. Hu for technical advice and stimulating
discussions.

(B4)
is given by (99).
where
In fact, inserting (95) and completing squares in the left
member of (B4) yields the right member of (B4) plus a number
of terms which are either quadratic in , linear in , or
constant with respect to . The quadratic terms cancel due
to the fact that satisfies the algebraic Riccati equation (96),
and the constant terms cancel due to (104). Finally, the linear
terms cancel provided

which has the unique bounded solution (100), since
is a
stable matrix.
and
, where
Now, set
is an admissible process, and sum (B4) from
to
to obtain

REFERENCES
[1] B. D. O. Anderson and J. B. Moore, Optimal Control: Linear Quadratic
Methods. London, U.K.: Prentice-Hall, 1989.
[2] S. Bittanti, F. Lorito, and S. Strada, “An LQ approach to active control
of vibrations in helicopters,” Trans. ASME, J. Dynamical Systems,
Measurement and Contr., vol. 118, pp. 482–488, 1996.
[3] C. T. Chen, Linear System Theory and Design. New York: Holt,
Rinehart and Winston, 1984.
[4] E. J. Davison and A. Goldenberg, “Robust control of a general servomechanism problem: The servo compensator,” Automatica, vol. 11, pp.
461–471, 1975.
[5] E. J. Davison and B. R. Copeland, “Gain margin and time lag tolerance
constraints applied to the stabilization problem and robust servomechanism problem,” IEEE Trans. Automat. Contr., vol. AC-30, pp. 229–239,
1985.
[6] E. J. Davison and B. M. Scherzinger, “Perfect control of the robust
servomechanism problem,” IEEE Trans. Automat. Contr., vol. AC-32,
pp. 689–702, 1987.
[7] B. A. Francis, “The linear multivariable regulator problem,” SIAM J.
Contr. Optim., vol. 15, pp. 486–505, 1977.
[8] B. A. Francis and W. M. Wonham, “The internal model principle of
control theory,” Automatica, vol. 12, pp. 457–465, 1977.
[9] K. V. Frolov and F. A. Furman, Applied Theory of Vibration Protected
Systems. Moscow, Russia: Mashinostroenie, 1980 (in Russian).
[10] K. V. Frolov, Vibration in Engineering. Moscow, Russia: Mashinostroenie, 1981 (in Russian).
[11] M. D. Genkin, V. G. Elezov, and V. D. Iablonski, Methods of Controlled
Vibration Protection of Engines. Moscow, Russia: Nauka, 1985 (in
Russian).

1704

IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 44, NO. 9, SEPTEMBER 1999

[12] D. Guicking, Active Noise and Vibration Control, reference bibliography,
Third Physical Institute, Univ. Goettingen, Jan. 1990.
[13] A. Isidori and C. I. Byrnes, “Output regulation of nonlinear systems,”
IEEE Trans. Automat. Contr., vol. 35, pp. 131–140, 1990.
[14] C. G. Källström and P. Ottosson, “The generation and control of roll
motion of ships in closed turns,” in Proc. 4th Int. Symp. Ship Operation
Automat., Geneva, Switzerland, 1982, pp. 1–12.
[15] H. Kimura, “Pole assignment by output feedback: A longstanding open
problem,” in Proc. 33rd Conf. Decision and Control, Lake Buena Vista,
FL, Dec. 1994.
[16] A. Krener, “The construction of optimal linear and nonlinear regulators,”
in Systems, Models and Feedback: Theory and Applications, A. Isidori
and T. J. Tarn, Eds. Boston, MA: Birkhäuser, 1992, pp. 301–322.
[17] V. Kuc̆era, “The discrete Riccati equation of optimal control,” Kybernetika, vol. 8, pp. 430–447, 1972.
[18] H. Kwakernaak and R. Sivan, Modern Signals and Systems. Englewood Cliffs, NJ: Prentice-Hall, 1991.
[19] G. Leitmann and S. Pandey, “Aircraft control under conditions of
windshear,” in Proc. 29th Conf. Decision and Control, Honolulu, HI,
1990, pp. 747–752.
[20] P. Lancaster, A. C. M. Ran, and L. Rodman, “Hermitian solution of the
discrete algebraic Riccati equation,” Int. J. Contr., vol. 44, pp. 777–802,
1986.
[21] A. Lindquist and V. A. Yakubovich, “Optimal damping of forced
oscillations in discrete-time systems,” IEEE Trans. Automat. Contr., vol.
42, pp. 786–802, 1997.
, “Optimal damping of forced oscillations by output feedback,”
[22]
in Stochastic Differential and Difference Equations, Progress in Systems
and Control Theory, vol. 23, I. Csiszár and G. Michaletzky, Eds.
Boston, MA: Birkhäuser, 1997, pp. 203–231.
[23] A. Miele, “Optimal trajectories and guidance trajectories for aircraft
flight through windshears,” in Proc. 29th Conf. Decision and Control,
Honolulu, HI, 1990, pp. 737–746.
[24] B. P. Molinari, “The stabilizing solution of the discrete algebraic Riccati
equation,” IEEE Trans. Automat. Contr., vol. AC-20, pp. 396–399, 1975.
[25] V. M. Popov, Hyperstability of Control Systems. Berlin, Germany:
Springer, 1973.
[26] A. V. Savkin and I. R. Petersen, “Robust control with rejection of
harmonic disturbances,” IEEE Trans. Automat. Contr., vol. 40, pp.
1968–1971, 1995.
[27] R. Shoureshi, L. Brackney, N. Kubota, and G. Batta, “A modern control
approach to active noise control,” Trans. ASME, J. Dynamical Syst.s,
Measurement and Contr., vol. 115, pp. 673–678, 1993.
[28] V. Z. Weytz, M. Z. Kolovski, and A. E. Koguza, Dynamics of Controlled
Machine Units. Moscow, Russia: Nauka, 1984 (in Russian).
[29] V. A. Yakubovich, “A frequency theorem in control theory,” Sibirskij
Mat. Zh., vol. 4, pp. 386–419, 1973 (in Russian); English translation in
Sibirian Math. J.
[30]
, “Universal regulators in linear-quadratic optimization problems,” in Trends in Control, A. Isidori, Ed. New York: Springer-Verlag,
1995, pp. 53–68.
[31] Y. Zhao and A. E. Bryson, “Aircraft control in a downburst on takeoff
and landing,” in Proc. 29th Conf. Decision and Control, Honolulu, HI,
1990, pp. 753–757.
[32] K. Zhou, Essentials of Robust Control. Englewood Cliffs, NJ: PrenticeHall, 1998.

Anders Lindquist (M’77–SM’86–F’89) received
the M.S. and Ph.D. degrees from the Royal Institute
of Technology, Stockholm, Sweden, and in 1972
he was appointed a Docent of Optimization and
Systems Theory there.
From 1972 to 1974, he held visiting positions at
the University of Florida, Brown University, and
State University of New York, Albany. In 1974,
he became an Associate Professor and in 1980
a Professor of Mathematics at the University of
Kentucky, where he remained until 1983. He is
presently a Professor at the Royal Institute of Technology, where in 1982
he was appointed to the Chair of Optimization and Systems Theory, as well
as an Affiliate Professor at Washington University, St. Louis. He has also held
visiting positions at University of Padova, Italy, University of Arizona, USSR
Academy of Sciences, Moscow, East China Normal University, Shanghai, and
Technion, Haifa, Israel. He is the author of many papers in the area of systems
and control, especially stochastic control, filtering, stochastic systems theory,
realization theory, robust control, and applications of nonlinear dynamics in
estimation and control.
Dr. Lindquist is a Member of the Royal Swedish Academy of Engineering
Sciences, a Foreign Member of the Russian Academy of Natural Sciences,
and an Honorary Member of the Hungarian Operations Research Society. He
has also served on many editorial and advisory boards.

Vladimir A. Yakubovich (M’97) was born in
Novosibirsk, Russia, in 1926. He graduated from
Moscow University in 1949. He received the
Candidate of Science degree (Ph.D.) in 1953 and
the Doctor of Science degree in 1959, both from
Leningrad University.
After having worked for some time in industry
as an Engineer, he was admitted to the Leningrad
University, where he has remained. He is the author
of more than 270 papers and coauthor of seven
books in different areas of applied mathematics and
control theory. He has worked in parametric resonance theory, in the theory
of stability of nonlinear systems, and in optimization theory.
Dr. Yakubovich has served on many scientific committees and editorial
boards. He is a member of several scientific societies in Russia. He was
awarded the Norbert Wiener Prize in 1991, a prize from the international
editorial company “Nauka” for best publication in its journals in 1995,
and the IEEE Control Systems Award in 1996. Since 1991, he has been a
Corresponding Member of the Russian Academy of Sciences and since 1994
a Member of the Russian Academy of Natural Sciences.

