IEEE TRANSACTIONS ON INDUSTRIAL ELECTRONICS, VOL. 61, NO. 12, DECEMBER 2014

6483

Filter Design of Direct Matrix Converter for Synchronous Applications
Anindya Dasgupta and Parthasarathi Sensarma, Member, IEEE
Abstract--Filters for switching ripple attenuation are essential at the input, and sometimes at the output for certain applications, for the deployment of matrix converters (MCs). Due to the absence of inertial elements in the MC structure and the consequent tight input­output coupling, the filter parameters significantly affect its dynamic behavior. This paper presents an exhaustive filter design method for synchronous applications of the MC in power systems. Apart from the usual considerations of ripple attenuation, voltage regulation, reactive current loading, and internal losses, this paper also addresses additional constraints which may be imposed by requirements of dynamic performance and reliable commutation. Rigorous analytical justification of each design step is provided and the sequential design process is summarized. Relevant experimental results are presented to validate the proposed design tool. Index Terms--Filter design, matrix converter (MC), synchronous applications.

I. I NTRODUCTION ECENT YEARS have witnessed a growing interest [1]­ [7] toward the deployment of the matrix converter (MC) in power systems, which are synchronous applications characterized by identical input and output frequencies. The advantage of reduced energy storage needs has inspired the use of MC as a FACTS device [1]. The use of MC for power quality improvement, reactive power control, and other power system applications has been reported in [2]­[4]. Benefits of using MC as a voltage regulator in a distribution system and as a high-performance power supply have been reported in [5]­[7], respectively. The input filter is an essential requirement of this topology for providing a local circulating path to the switching frequency current. Some of the synchronous applications require regulated output voltage and, hence, a second-order ripple filter at the output side, in addition to the input filter. The filter parameters have to be carefully selected such that their inclusion does not degrade voltage regulation, efficiency, and reactive current loading beyond an acceptable limit. Since the

R

Manuscript received April 19, 2013; revised August 19, 2013 and December 2, 2013; accepted February 14, 2014. Date of publication April 14, 2014; date of current version September 12, 2014. This work was supported in part by the NaMPET initiative of DeitY under Grant CDAC/EE/20050026 and in part by the Department of Science and Technology, Government of India, under sponsored project DST/EE/20110021. A. Dasgupta is with the Department of Avionics, Indian Institute of Space Science and Technology, Thiruvananthapuram 695-547, India (e-mail: anindyadgupta@iist.ac.in; anindyadgupta@gmail.com). P. Sensarma is with the Department of Electrical Engineering, Indian Institute of Technology Kanpur, Kanpur 208-016, India (e-mail: sensarma@ iitk.ac.in). Color versions of one or more of the figures in this paper are available online at http://ieeexplore.ieee.org. Digital Object Identifier 10.1109/TIE.2014.2317134

only inertial elements in this topology are the filter components, the filter parameters significantly affect the system dynamics. Input filter design has been discussed in [8]­[13], where, from cost and weight considerations, the single-stage LC filter has been found to be the most appropriate topology. Although the set of filter elements (Lf , Cf ) for a particular resonant frequency is infinite, Klumpner et al. [9] advocate a maximum Cf to ensure a minimum input displacement factor (IDF) for low loads. However, in a distribution system, most of the loads are inductive, and this restriction may be relaxed at lighter loads. An exhaustive treatment of input/output filters with focus on reducing electromagnetic interference and common-mode voltages has been provided in [14] and [15]. However, most of these have not investigated the comprehensive design of filters in the context of dynamic performance improvement or reliability of commutation hardware. The only reported approach [13], which considers both steady-state and dynamic objectives, uses a genetic algorithm to derive the parameter values as well as the filter topology. Dynamic stability criteria are based on limits detailed in [16] and [17]. Digital filters are used for measuring input voltage which are purported to improve the system stability limit. It has, however, been shown in [18] that, with a proper choice of system input and output, the derived plant has minimum phase poles for all operating points, but nonminimum phase zeros could appear, depending on input filter parameters and system operating points. Since the plant is inherently stable, imposing a general stability limit on filter design for all operating conditions [13] is unnecessary. Also, analytical justification of the filter design method is not established with any degree of rigor. Output voltage regulation specifications restrict the inductive (series) component of the output filter. Hence, commutation based on output current direction becomes particularly difficult at zero crossing (ZC) due to the high ripple content. The detection of current direction based on switch voltage measurement introduces large delays because of the stray capacitances and large resistances used [19]­[21]. An analysis of the critical window area around the ZC of line voltages, for safe voltagebased commutation (VBC), has been provided in [22]. However, the effect of switching frequency ripple in input voltage on the demarcation of the critical areas has been ignored. In [21], it is shown that, with proper zero vector placement in space vector modulation (SVM), safe commutation can be achieved in spite of voltage measurement inaccuracies. This method is restricted to the operation with the input displacement angle within ± of the voltage ZC, which is to be decided on the basis of the specific input ripple voltage measurements for a given hardware. A closed-form expression of the ripple voltage

0278-0046 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

6484

IEEE TRANSACTIONS ON INDUSTRIAL ELECTRONICS, VOL. 61, NO. 12, DECEMBER 2014

TABLE I N OMINAL /R ATED PARAMETERS

Fig. 2.

Single-phase diagram including source inductance.

Fig. 1. Schematic of a 3 Ph MC.

Fig. 3. |iin (nb t)|/|iin (b t)| for (a) m = 1 and (b) m = 0.5.

would therefore provide a complete analytical design tool for this method. For wider control of IDF in applications [23], [24] requiring input reactive power control, the correct measurement of the ripple voltage is still difficult, particularly with high output current amplitude. This paper discusses a filter design approach for the MC which integrates the steady-state performance along with the constraints imposed by the requirements of closed-loop dynamic performance and safe commutation. In the first section, the design of filters to meet certain steady-state performance specifications is detailed. Since modulation strategies for MC do not provide any separate control on the input current amplitude, an external damping resistor is included. Power loss estimation due to this inclusion is presented. Input capacitor sizing for reliable commutation is analyzed in the context of the voltage ripple and consequent problems in VBC. Then, the effect of the grid inductance has been presented. Thereafter, the output filter design is presented in the second section. In the next section, the design guidelines that emerge from the analysis have been summarized to enable a sequential design process. Finally, relevant experimental results on a 6-kVA laboratory prototype are provided for validation. II. I NPUT F ILTER D ESIGN Filter parameters are chosen for the nominal/rated system parameters shown in Table I. In this analysis, an application requiring regulated 3 Ph sine-wave voltage supply has been considered which makes output ripple filters mandatory. Fig. 1 shows the schematic diagram of a 3 Ph MC. The single-phase equivalent of the overall system is shown in Fig. 2 where the Thevenin impedance of the source is modeled as an inductance Ls . The input filter damping resistor is placed across the filter inductor as the conflict between filter efficiency and damping requirements is least with this arrangement [25]. The power stage of MC appears as a current stiff sink to the supply side and as a voltage stiff supply to the load. A phase-locked loop is locked to phase a of the point of common coupling marked as P. Ls , which is usually small at the

distribution level, is initially neglected and would be introduced later to study its impact on filter performance. The selection of filter parameters to satisfy certain criteria are sequentially described in the following sections. A. Attenuation to Switching Ripple and Low-Order Harmonics For Ls = 0, the forward gain of the input filter is defined as Gf v (s) =


is ( s ) iin (s)

=
vs

vcf (s) v s (s )

=
iin

+1 s Rf d s2 Lf Cf + s Rf +1 d
L

L

.

(1)

Denoting the corner frequency as c : (2fc ), the normalized form of its frequency response magnitude is |Gf v (j )| = 1+
2 r Q2 2 )2 + (1 - r 2 r Q2

(2)

which is plotted in Fig. 4. The definitions r =  , c Q = Rd Cf , Lf c = 1 Lf C f (3)

enable generalized analysis. The ratio of the magnitude of the switching ripple components to the fundamental component in iin varies with modulation index m [26]. Fig. 3 shows the magnitude of these component as a fraction of the fundamental obtained from simulation. To restrict these switching ripple components from appearing in is , the first design criterion is set as Spec.1 |Gf v (j 2fs )|  Asw dB. Also, in the deployment site of the MC, the grid voltage spectrum may contain significant low-order (hv ) harmonics. To limit the appearance of these in the filter capacitor voltage vcf , the following restriction is introduced: Spec.2 |Gf v (j 2fb max .(hv ))|  Avh dB. Defining the following frequency ratios: mf hb = max .(hv ) and mf sh = s mf hb b (4)

DASGUPTA AND SENSARMA: FILTER DESIGN OF DIRECT MATRIX CONVERTER FOR SYNCHRONOUS APPLICATIONS

6485

TABLE III Lf,max AND Cf,max F ROM R EGULATION AND R EACTIVE L OADING

Fig. 4. |Gf v (j )|(dB) with Q = 1, 3, and 5. TABLE II Q AND fc F ROM F ORWARD G AIN Fig. 5. (a) |GR1 (j )|(dB) for Rd = 1 . (b) |GR2 (j )|(dB).

C. Selection of Damping Resistor Rd Since an external damping resistor Rd is indispensable in the input filter, minimum operating efficiency requires a limit on the maximum loss associated with Rd . Denoting the current through Rd as iRd , the corresponding design criterion is 2 Spec.5 3Rd  n=1 [iRd (jnb )] < 1% of rated load. iRd can be expressed as iRd (s) = GR1 (s)vs (s) + GR2 (s)iin (s) where GR1 (s) =


it is noted that, for given switching frequency and deployment site conditions, these ratios have unique values. These are depicted in Fig. 4 by the vertical lines which are mutually stationary but could slide horizontally. Also included are the criteria defined in Spec.1 and Spec.2, which are depicted as regions demarcated by stationary horizontal lines. The interval [rv , rs ] defines the initial choice of Q (Q(1) ) and, thereby, the (1) (1) acceptable range of fc ([fc,min , fc,max ]). For the experimental model and deployment site of MC, these selections, along with the numerical limits of Spec.1 and Spec.2, are listed in Table II. B. Voltage Regulation and Reactive Current Loading Referring to Fig. 2, the full load regulation of MC output voltage is decided by the fundamental voltage drop in Lf . Restriction on regulation leads to the following design criterion: Spec.3 VLf  b Lf
2 + I2 Icf in,rated  kR Vs .

(6)

iR d ( s ) v s (s )

=
s=j

1 · Rd

2 r 2 )2 + (1 - r
2 r Q2

GR2 (s) =



iR d ( s ) iin (s)

=
s=j

1 · Q

r
2 )2 + (1 - r
2 r Q2

.

(7)

A restriction on reactive current loading is necessary for satisfying stipulations on part-load power factor, which leads to the next criterion Spec.4 Icf  b Cf Vs  kPF Iin,rated . For deriving the boundary values at rated power level, analysis is done considering unity IDF operation with unity modulation index (m) [27] and resistive load unless stated otherwise. The specific inequalities in Spec.3 and Spec.4 obviously translate to (1) (1) maximum limits for Lf (Lf,max ) and Cf (Cf,max ). The rated input current is evaluated from [27] Iin,max = 0.866Io . (5)

The frequency responses of these transfer functions are plotted in Fig. 5(a) and (b), respectively, for Rd = 1 . High Q is particularly desirable in |GR2 | as it implies lesser ripple content in iRd and, therefore, a lower loss. However, high Q in |GR1 | implies a higher loss due to increased low-order harmonics in iRd . The plots reveal a response similar to that encountered with the normalized form of |Gf v | in Fig. 4. As can be expected from this similarity, Q(1) chosen in Section II-A is found to give an even balance between both the conflicting aspects. Therefore, Q(1) is finalized for filter design. The power loss associated with Rd is PR = 3Rd
n 2 2 + |GR2 (jnb )|2 Iin,n |GR1 (jnb )|2 Vs,n

For the rated values in Table I, numerical limits considered for Spec.3 and Spec.4, along with the maximum allowable values (1) (1) Lf,max and Cf,max , are listed in Table III.

(8) where Vs,n and Iin,n are the values corresponding to the nth harmonic order. The calculation of PR using (8) requires the

6486

IEEE TRANSACTIONS ON INDUSTRIAL ELECTRONICS, VOL. 61, NO. 12, DECEMBER 2014

TABLE IV H ARMONICS IN iin F ROM S IMULATION AT m = 1

TABLE V Lf,min AND Cf,min F ROM R EGULATION , R EACTIVE L OADING , AND F IXED fc

Fig. 6.

Commutation between input phases a and b.

Fig. 7.

Input current and voltage.

prior selection of fc for evaluating the gains |GR1 (jnb )| and |GR2 (jnb )|. For the experimental model, fc is selected from the allowable range provided in Table II as
(1) = 1 kHz. fc

of intersection, the numerical limits of all or some of Spec.3, Spec.4, and Spec.5 must be made less stringent. For the experimental model, these ranges of Rd are listed in Table V. Since these ranges intersect, (13) defines the final set for selecting Rd . D. Lower Limit of Cf : Maximum Ripple in Input Line­Line Voltage and Consequent Problem in Commutation Fig. 6(a) shows two input phases a and b, which are alternatively switched to an output phase. Commutation based on the polarity of input line­line voltage (vL = vab ) is difficult at its ZC, due to the presence of switching ripple component vrL , as shown in Fig. 6(b). In the following analysis, it is assumed that only fundamental and switching frequency components are present in the input current and filter capacitor voltages. vL can be represented as vL = (vf a - vf b ) + (vra - vrb )
vf L vrL

(9)

1) Rd From Loss Limit: With the harmonic analysis of MC being outside the scope of this paper, the expression for losses is derived assuming sinusoidal io . The harmonic components in (1) iin obtained from simulation are listed in Table IV. Using fc (1) and Q , the gains defined in (7) are evaluated. Subsequently, using these gains and the harmonics listed in Table IV in (8), for the nominal parameters in Table I, PR is obtained in the following form: PR = F1 + F2 R d Rd (10)

(14)

where F1 and F2 are functions of |GR1 (jb )|, Vs , |GR2 (jnb )|, and Iin,n . These are tabulated in Table V. Thereafter, applying the numerical limits of Spec.5, (10) yields two roots which define an allowable range of Rd as follows: Rd,min  Rd  Rd,max .
(1) (1)

(11)

where the subscripts f and r have been used to denote the fundamental and ripple components, respectively. Fig. 7 shows the input current and filter capacitors. It is assumed that the ripple component irx completely circulates through the filter capacitor while if x flows through the source. Hence, vrL = vra - vrb = - 1 Cf (ira - irb ) dt. (15)

This choice of Rd definitely satisfies Spec.1, Spec.2, and Spec.5. However, it is not apparent whether any value of Rd in this band and the corresponding Lf and Cf evaluated using (3) would also satisfy Spec.3 and Spec.4. 2) Rd From Voltage Regulation and Reactive Loading Lim(1) (1) its: The upper bounds Cf,max and Lf,max imply corresponding lower bounds Lf,min and Cf,min for the selected fc in (9). These are listed in Table V. Using (3), since
(1) (1) Q Rd = 2fc Lf . (1) (1) (1) (1)

(12)

Lf,max and Lf,min define a new set of bounds on Rd Rd,min  Rd  Rd,max .
(2) (2)

(13)

Hence, the allowable values of Rd will be those where the two ranges obtained from (11) and (13) intersect. In the absence

irx is synthesized from the output current envelope, which is a direct function of the load. Therefore, an arbitrarily small Cf , chosen to reduce reactive loading at low loads, leads to a corresponding high vrL at high loads. With the usual delays involved, the phase error in the measurement of vrL is significantly more than that of vf L . The consequent inaccuracy in detecting the polarity of vrL around the ZC of vf L increases the chance of a commutation failure. Therefore, the estimation of maximum vrL and analyzing its effect on commutation form a prerequisite for determining the lower limit of Cf . Deriving a closed-form expression for maximum vrL is described in Appendix A. Incorrectly sensing the polarity of vf L may lead to erroneous commutation in the following manner. Fig. 8 shows the plot of ripple current and vrL around ^rL,max . This occurs during the instant when v ^rL reaches v commutation from phase a to phase b. The capacitor voltages

DASGUPTA AND SENSARMA: FILTER DESIGN OF DIRECT MATRIX CONVERTER FOR SYNCHRONOUS APPLICATIONS

6487

Fig. 10. Path of short circuit current.

Fig. 8.

Error in measuring vrL around its maximum value.

[22]. The instantaneous values of the fundamental component of the voltages of phases a and b are   3^ 3^ vf a  Vcf , vf b  0 f L = Vcf . (17) 2 2 Since vf L has a substantially high magnitude and delay in sensing it is much lesser than the ripple component, it is justified to assume that its polarity is correctly detected. Also, since vrs is positive, polarity of vL is interpreted to be positive. Now, using (16) and (17)  ^o Ts I 3 ^ Vcf - vL = . (18) 2 4Cf

Fig. 9. Instantaneous positions of if a , if b , vf a , and vf b at beginning of commutation from phase a to phase b.

Therefore, vL becomes negative if ^ ^cf < Io Ts V 4Cf  Cf,min =
(2)

are sampled at frequency 4fs . vrs is the corresponding sensed ripple voltage available for sampling. Noise filtering in voltage measurement and the antialiasing filters invariably cause delays in the sensed signal. The presented plot of vrs is derived using a first-order low-pass approximation of the measurement circuit and filter. At the sampling instant just before commutation, vrs is positive, and vrL is negative with a magnitude Vm . Using (43)  3 ^ I o Ts . Vm  (16) 8Cf At the instant when commutation is about to begin, ¯ Iin is very close to the middle of sector II of the input current hexagon shown in Fig. 17(a) in Appendix A. The 3 Ph waveforms shown in Fig. 9 have been used to distinguish between the position of different variables on the basis of their instantaneous phases, at the start of commutation. The intersection of the vertical line L1 with the three waveforms therefore indicates the position of if a , if b , and if c , respectively, at the start of commutation. At the same instant, the relative position of the fundamental components of input voltages depends on the IDF. Let the intersection of the line L2 with the waveforms indicate the positions of vf a , vf b , and vf c , respectively. Therefore, the input currents lead the voltages, a situation which can arise in applications requiring input reactive power control [23], [24]. From Fig. 9, since vf a and vf b have clearly distinguished instantaneous values, the commutation between these two phases is to be interpreted as an "uncritical" one [22]. For an uncritical commutation, regular two- or four-step commutation methods are suggested [21],

^o Ts I I o Ts  . ^ 4Vs 4Vcf

(19)

Fig. 10 shows the condition that will arise in this situation. Short circuit current isc flows over an interval Tsc , which comprises two turn-on and turnoff times of the insulated gate bipolar transistor (IGBT). Lst in Fig. 10 represents the stray inductance of the circuit. Let vD be the total forward drop of the two IGBTs ^D as the maximum current and diodes. Thereby, by denoting I rating of the devices, the criterion for the safety of the devices is obtained as Isc,max 1 = Lst
Tsc

^D . (-vL - vD ) dt  I
0

(20)

Using (18) in (20), a lower limit of Cf is obtained as
(3) Cf,min

1^ = I o Ts 4

^cf V

^D Lst I + 1.15 vD + Tsc
(2)

-1

.

(21)

Cf,min is, of course, hardware specific. Cf,min may be used as a preliminary check before proceeding with the hardware details. If the converter is operated at unity IDF, then, for maximum vrL to occur at the instant of commutation, vf L has to be zero. The line voltage magnitude vL is then equal to Vm defined in (16). Substituting -vL accordingly in (20) yields another lower limit of Cf as
(4) Cf,min

(3)

3^ I o Ts = 8



^D Lst I vD + Tsc

-1

.

(22)

6488

IEEE TRANSACTIONS ON INDUSTRIAL ELECTRONICS, VOL. 61, NO. 12, DECEMBER 2014

TABLE VI Cf,min FOR R ELIABLE VOLTAGE C OMMUTATION

the harmonic performance, further complicates the controller design as discussed subsequently. F. Design Modifications for a Nonminimum Phase Plant The dynamic model of 3 Ph MC in the dq reference frame has been analyzed in [18] where a condition for avoiding right half zeros (RHZs) in the plant transfer function matrix has been described. For the per-phase system depicted in Fig. 2, the input filter output impedance Zso is defined as Zso (s) = - vcf (s) iin (s) .
vs (s)=0

(26)

This scalar transfer function is transformed to a transfer matrix Zso (s) in a synchronous dq reference frame as Zso (s) =
Fig. 11. Magnitude plot of Gf v (s) for Ls of 0.5 and 1 mH.

Zso11 (s) -Zso12 (s)

Zso12 (s) . Zso11 (s)

(27)

For avoiding RHZs, it is necessary that
(3)

Cf,min would be higher than both Cf,min and Cf,min . For unity IDF, the commutation through a third phase [21] would allow using a smaller capacitor. However, operating with a (4) value higher than Cf,min will ensure safe commutation for any operating condition. Moreover, this is ensured irrespective of any particular commutation method and is not dependent on the accurate ZC detection of ripple voltage. (2) (3) (4) Table VI shows Cf,min , Cf,min , and Cf,min , calculated using tabulated device ratings and measured Lst . E. Effect of Ls With the inclusion of Ls , Gf v (s) is obtained as Gf v (s) = +1 s Rf d s3
Ls Lf C f Rd L

(4)

(2)

|Zso11 (jM )| <

^ 2 cos2 i 3V cf . 2 Pin

(28)

+ s2 Cf (Ls + Lf ) + s Rf +1 d

L

.

(23)

Zso11 (j ) has multiple phase crossovers, and M is that phase crossover frequency where |Zso11 (j )| is maximum. Pin is the power at the input terminals of MC, and cos i is the IDF. Importantly, the condition defined in (28) is not confined to any specific modeling approach. The power stage of MC, along with input filters in the small signal/linearized model, is responsible for RHZs. From (28), input filter parameters are one of the factors deciding the emergence of RHZs. The violation of (28) causes four RHZs to emerge in the system, which severely complicates the controller design, particularly if the bandwidth (BW ) requirement is high. Then, either the dynamic specifications have to be relaxed or the input filter has to be designed such that (28) is not violated. With reference to (28) and [18] |Zso11 (jM )|  Zso11 (j )


Under the assumption of underdamped second-order filter Gf v (s)  +1 s Rf d
n s Rf +1 d n+1 L s2 2 c L

 Zso (j )

.

(29)

+

s  c Qc

(24) +1

Assuming underdamped second-order filter and ideal passive elements Zso (j )


where c  1 , Q  Rd (n +1)Lf Cf Cf Lf (1+ n)1.5 , n = Ls . Lf (25)

= |Zso (jc )|  Rd 1 +

Ls Lf

2

.

(30)

Fig. 11 shows the gain plot for varying Ls . Input filter parameters are used from Table VIII. Therefore, as Ls increases, c falls while Q increases. Thus, the gain to lower harmonics is bound to increase. However, the losses are going to decrease as fs components of iin now see a higher impedance parallel to Cf . Hence, knowledge of Ls is necessary before finalizing on the input filter parameters. If n defined is (25) is less than 0.5, then c does not get significantly affected, and neither does the filter performance. However, a high n, apart from deteriorating

So as Ls increases, chances of the plant migrating from minimum to nonminimum phase also increase. Under these circumstances a lower Rd or higher Lf can be chosen to ensure that (28) is satisfied and the plant remains minimum phase. Either of these options degrade the steady-state performance in different ways. Higher voltage drop across Lf lowers the maximum output voltage that can be obtained. A lower Rd on the other hand increases losses. So, for a weak grid, a tradeoff is necessary between the dynamic performance and either filter losses or full-load regulation. The inclusion of the internal resistances (ri ) of passives at M results in higher damping owing to the skin effect and, hence, lower |Zso (jM )| than what is represented by (30).

DASGUPTA AND SENSARMA: FILTER DESIGN OF DIRECT MATRIX CONVERTER FOR SYNCHRONOUS APPLICATIONS

6489

TABLE VII B OUNDARY VALUES FOR PARAMETERS OF O UTPUT F ILTER PARAMETERS

Therefore, to avoid a conservative design, using the measured value of ri or a good design estimate of it, to calculate |Zso (jM )|, is necessary. III. O UTPUT F ILTER The criteria defined in Spec.1 to Spec.4 are also followed for output filter design. The procedure, being very similar to the earlier exercise, is therefore briefly discussed. Denoting the resonant frequency of the output filter shown in Fig. 2 as co , the forward gain is obtained as Gvof (s) = 1 vco (s) = 2 von (s) (s/co ) + (s/Qo co ) + 1 (31)

conforming to Spec.1 and Spec.2. As discussed in Section II-C, Q(1) is the optimum value and, therefore, the chosen value for the design. Step 2) Selection of fc from the allowable range obtained using the forward gain plot, Q(1) , Spec.1, and Spec.2 (1) (1) Step 3) Computation of the upper limits Lf,max and Cf,max by using Spec.3 and Spec.4, respectively. Subsequently, these values, along with the selected fc , (1) are used to compute the corresponding Cf,min and Lf,min , respectively. Step 4) Computation of the first allowable set of Rd conforming to Spec.5 and the second set that conforms to Spec.3 and Spec.4 as discussed in Section II-C2. The intersection of these two sets forms the final allowable range of Rd . If they do not intersect, then either one or both of the sets has to be expanded by relaxing the corresponding Spec. to obtain a region of overlap. The first set can be expanded at the expense of allowing higher losses while relaxing the upper and lower bounds of the second set implies poor regulation and higher reactive loading, respectively, than the imposed limits. In this regard, the steady-state requirements for the target application help in deciding which Spec. should be relaxed. This implies starting again from the step related to the redefined Spec. (4) Step 5) Computation of Cf,min for reliable voltage commutation using (19). This has to be treated as the absolute lower limit for Cf if this value is greater (1) than Cf,min . Step 6) Selection of Lf from the interval [Lf,min , Lf,max ]. Choosing Cf from the interval [Cf,min , Lf,max ] or
(4) (1) (1) (1) (1)

where Qo = Ro (Co /Lo ). Since von can be controlled, a virtual damping resistor can be introduced through control to emulate Ro . The selection of the values of Qo , fco,max , fco,min , Co,max , and Lo,max is carried out in the same manner followed during the input filter design. For the input filter, the output current decides the ripple current rating of the filter capacitors. At the output side, however, the proper sizing of Lo allows an additional freedom of using capacitors with a lower ripple current rating. This is clarified using the expression of output admittance, which is obtained as Ymo (s) = 1 + s (Qo /co ) 1 io ( s ) = . von (s) Ro (s/co )2 + (s/Qo co ) + 1 (32)

Thus, for Qo greater than 1 1 |Ymo (js )|  .  s Lo (33)

In SVM [27], at any instant, three output phases are connected to any two input phases. Hence, from Fig. 1, for output phase A v ^on = 2 v ^ab = 1.63Vs . 3 (34)

The resulting peak switching ripple, found using (33) and (34), ^r,rated ) must be lower than the peak ripple current rating (I of Co . Hence ^r,rated ). Spec.6 Lo,min = (1.63Vs,rated )/(s I Table VII lists the described limits for output filter parameters calculated using the nominal values in Table I. IV. S ELECTION OF PARAMETER VALUES The design guidelines from the previous sections are summarized here to facilitate a step-by-step design process. With the nominal power, fundamental and switching frequency, and percentages of different harmonics in the source voltage as design inputs, parameters are selected in the following manner. Step 1) Selection of quality factor Q (= Q(1) ) from the normalized form of the input filter forward gain

from [Cf,min , Lf,max ] as discussed in Step 5. Also, finalizing the value of Rd from the range obtained from Step 4. Step 7) Detecting whether the chosen input filter parameters result in a nonminimum phase plant. If it does, then the feasibility of obtaining a stable closed-loop system in compliance to the dynamic specifications has to be investigated. If a minimum phase plant is desired, then either the full-load regulation (Spec.3) or filter loss (Spec.5) has to be relaxed, and parameters have to be redesigned repeating Steps 3 to 7. Step 8) Selecting Qo , fco , Co,max , and Lo,max following the same steps as their input-side counterparts. Step 9) Selection of Lo,min conforming to Spec.6. Subsequently choosing the values of Lo and Co , thereby completing the design process. The filter parameters are selected following the described steps and using the boundary values listed in Tables II, III, V­VII. The parameter values chosen in this paper are shown in Table VIII, which also lists the specific volume (cm3 /kW) and weight (kg/kW) of the inductors and capacitors. Experimental results are discussed next.

(1)

(1)

6490

IEEE TRANSACTIONS ON INDUSTRIAL ELECTRONICS, VOL. 61, NO. 12, DECEMBER 2014

TABLE VIII I NPUT AND O UTPUT F ILTER PARAMETERS

Fig. 13. Open-loop experimental results. vs : 100 V/div, is : 5 A/div, vco : 100 V/div, and io : 5 A/div. Time: 10 ms/div.

Fig. 14. Open-loop results with an Ls of 1 mH. vs : 100 V/div, is : 5 A/div, vco : 100 V/div, and io : 5 A/div. Time: 10 ms/div. TABLE IX M EASURED VALUES

A. Open-Loop Experimental Results MC was operated with m = 1 and unity IDF with io = 8.2 A (fundamental). Figs. 12­14 show the waveforms. Experimentally measured data are listed in Table IX. The voltage waveform across the damping resistor Rd is shown in Fig. 12(a). From the experimental data, its rms value was calculated, resulting in a power loss of 2 W which is much lower than 1% of the input power listed in Table IX. The analysis in Section II-C1 using fundamental vs and io suggests a value (2.1 W) very close to the experimentally obtained value. Referring to Appendix A and particularly (40), operating at unity IDF implies that v ^rL,max is expected almost at the ZC of input line­line voltage vL . Fig. 12(b) shows vL around ZC over 5 ms, and its zoomed view is presented in Fig. 12(c). It is evident that maximum ripple occurs around the ZC zone as expected. In the experimental setup, the measurement of the input filter capacitors with the RCL meter at 10 kHz revealed the values shown in Table IX. The values of Cf from Table IX are used to calculate vra and vrb at the maximum ripple condition as detailed in Section II-D. Subsequently,

Fig. 12. (a) Voltage across Rd : 10 V/div; time: 10 ms/div. (b) vL : 100 V/div; time: 500 s/div. (c) vL : 20 V/div; time: 100 s/div.

V. R ESULTS AND D ISCUSSION Experimental validation was carried out on a 6-kVA MC prototype with IGBT-based four-quadrant switches with the filter parameters listed in Table VIII. The entire control logic was realized on an FPGA platform using ALTERA EP1C12Q240C8 with a sampling frequency of 20 kHz. For commutation, the measured value of vcf was sampled at 40 kHz. A regular four-step commutation strategy, as reviewed in [22], was implemented.

DASGUPTA AND SENSARMA: FILTER DESIGN OF DIRECT MATRIX CONVERTER FOR SYNCHRONOUS APPLICATIONS

6491

TABLE X H ARMONICS IN O NE P HASE OF vs , is , AND vco

TABLE XI H ARMONICS vs , is , AND vco W ITH Ls = 1 mH

Fig. 15. Dynamic performance. (a) vco reference command of 140 V. (b) vco reference reset to 0 V. Upper trace: Error voltage in d-axis (116 V/div). Second trace: m (0.2/div). Bottom trace: vco (100 V/div). Time: 10 ms/div.

Fig. 16. Decoupled rectifier-inverter construct.

the v ^rL,max magnitude is found to be 30.8 V. Numerically extracting (filtering) the switching ripple component from the experimental data reveals a maximum ripple listed in Table IX. Thus, a very close agreement is observed between the analytical and experimental observations. Experimental data also revealed an IDF of 0.982 as listed in Table IX. Table X lists the harmonic components in phase a, where the supply voltage vs contains significant low-order harmonics, which, in turn, get transmitted to vco . Since is is a function of both vs and io , it has a higher harmonic content. From the harmonics of vco listed, it is evident that the gain criterion adopted in Sections II and III is effective in the minimal transmission of low-order harmonics from vs to vco . The switching frequency ripple in is was found to be slightly less than 1% of its fundamental component. 1) Performance With Ls Included: Fig. 14 shows the steady-state waveforms, at the same power level, with an externally added Ls of 1 mH. With this inclusion, using (25), c reduces from 1 kHz to 746 Hz, and Q increases from 3.1 to 7.6. The harmonic contents of vs , is , and vco are given in Table XI. Owing to the proximity of input and output corner frequencies (746 and 796 Hz), an increase in the harmonic content of is close to these frequencies is observed. At the instant that this experiment was performed, the total harmonic distortion (THD) of vs was slightly better than the previous situation. However, due to the proximity of the input and output filter corners, the harmonics of is around the output corner have increased, which marginally increased the THD of vco . The measured value of IDF was found to be 0.984. Fig. 15 shows the closed-loop dynamic response of one of the phases of output voltage. The error voltage in vcod , m, and vco are presented in the situation where, initially, a step command of 140 V is introduced and, subsequently, the reference command is reset to zero.

Fig. 17. (a) Input current hexagon. (b) Output voltage hexagon.

VI. C ONCLUSION An exhaustive filter design approach of 3 Ph direct MC (DMC) is presented which, in addition to meeting general requirements of a ripple filter, also addresses the design constraints imposed by dynamic specifications and commutation requirements. Ripple filter design aspects like attenuation and regulation and also MC-specific issues like the damping resistors at the input filter have been addressed. The detailed analytical derivation of the damping resistor losses and input voltage ripple is provided, and experimental results are presented to establish the validity of the analytical conclusions. The minimum input filter capacitor required for reliable VBC has been derived based on the maximum error in ripple voltage sensing. The effect of the grid inductance has been discussed where the possibility of a compromise between the filter and controller designs has been highlighted. The output ripple filter has also been discussed, and experimental waveforms are provided to demonstrate the close agreement of the filter performance with the input specifications. The necessary tradeoffs in filter design, which may be imposed by dynamic requirements, originate from the basic power stage of a 3 Ph DMC. Therefore, the observations are equally applicable to single-phase MCs or indirect MCs which are derived from the basic MC topology.

6492

IEEE TRANSACTIONS ON INDUSTRIAL ELECTRONICS, VOL. 61, NO. 12, DECEMBER 2014

TABLE XII ¯in IN S ECTOR 2 AND V ¯OL IN S ECTOR 3 I NPUT ­O UTPUT C ONNECTIONS IN MC FOR I

Ts . The input currents are denoted as If a and If b , respectively. Output currents over the same period are represented as IC and IB . From Table XII and Figs. 9 and 19, If a and If b can be expressed as If a = (IC d d + IB d d ) = mIP sin(60 - SI )
Fig. 18. SI and SV .

If b = (IC d d + IB d d ) = mIP sin SI where IP = IC sin(60 - SV ) + IB sin SV .

(35)

(36)

^rL , is maximum From (15), the peak­peak magnitude of vrL , v when area AP , shown shaded in Fig. 19, is maximum. AP is evaluated as AP = {(IC - If a + If b )d d +(IB - If a + If b )d d }Ts . (37) Substituting (35) in (37), AP gets modified as AP = mIP Ts sin(60 - SI )k (SI , SV ) where  k (SI , SV ) = 1+ 3m sin(SI - 30 )cos(SV - 30 ) . (39)
Fig. 19. Fundamental (If a , If b ) and switching frequency (ira , irb ) components of input currents (ia , ib ).

(38)

A PPENDIX A M AXIMUM vrL B ETWEEN P HASES A AND B Fig. 16 shows the decoupled rectifier-inverter construct of MC. The input current and output voltage stationary vectors for realizing SVM [27] are shown in Fig. 17(a) and (b). I1 (a, c) implies that input phases "a" and "c" are connected to the positive and negative rails of the fictitious dc link, respectively. Also, V1 (+, -, -) indicates that the output phase A is connected to the positive rail and both B and C are connected to the negative rail. Considering an instant when ¯ Iin lies in sector II, requiring ¯ OL is commutation between input phases a and b, and V in sector III, the relevant switching vector combinations and input­output connections are listed in Table III. Fig. 18 shows the rotating space vectors of each hexagon and the two bordering stationary vectors. SI and SV are the angles between the rotating and the trailing stationary vectors. The expression for duty cycles [27] is also indicated in Table XII. Fig. 19 shows the fundamental and switching frequency components of the input currents. The fundamental components of both input and output currents are assumed to be constant over a switching period

Since SI and SV each vary in the closed interval [0 , 60 ] and m varies in [0, 1], it is derived that AP reaches its maximum for SI = 28 , SV = 60 & m = 1. (40)

Therefore, v ^rL is maximum at an instant when if a  if b . Using (40), (38), and (39) in (15), maximum v ^rL is ^in Ts . v ^rL,max  (0.5/Cf )I ^in in MC [27] is The amplitude of the input current I  ^in = mIP = ( 3/2)mI ^o cos(oL ) I (41)

(42)

impedance angle. From (42), the maxiwhere oL is the load  ^o . Substituting this in (41) ^in is ( 3/2)I mum possible I  3 ^ I 0 Ts . (43) v ^rL,max  4Cf

ACKNOWLEDGMENT The authors would like to thank A. Basu and Nandkishore for the support during the hardware fabrication.

DASGUPTA AND SENSARMA: FILTER DESIGN OF DIRECT MATRIX CONVERTER FOR SYNCHRONOUS APPLICATIONS

6493

R EFERENCES
[1] J. Monteiro, J. F. Silva, S. F. Pinto, and J. Palma, "Matrix converter-based unified power-flow controllers: Advanced direct power control method," IEEE Trans. Power Del., vol. 26, no. 1, pp. 420­430, Jan. 2011. [2] B. Wang and G. Venkataramanan, "Dynamic voltage restorer utilizing a matrix converter and flywheel energy storage," IEEE Trans. Ind. Appl., vol. 45, no. 1, pp. 222­231, Jan./Feb. 2009. [3] K. Mohapatra and N. Mohan, "Matrix converter fed open-ended power electronic transformer for power system application," in Proc. IEEE Power Energy Soc. Gen. Meet., Convers. Del. Elect. Energy 21st Century, Jul. 20­24, 2008, pp. 1­6. [4] H. Nikkhajoei and M. R. Iravani, "A matrix converter based micro-turbine distributed generation system," IEEE Trans. Power Del., vol. 20, no. 3, pp. 2182­2192, Jul. 2005. [5] A. Garces and A. Trejos, "A voltage regulator based on matrix converter for smart grid applications," in Proc. IEEE PES Conf. ISGT Latin America, Oct. 19­21, 2011, pp. 1­6. [6] P. M. Garcia-Vite, F. Mancilla-David, and J. M. Ramirez, "Per-sequence vector-switching matrix converter modules for voltage regulation," IEEE Trans. Ind. Electron., vol. 60, no. 12, pp. 5411­5421, Dec. 2013. [7] P. Zanchetta, P. Wheeler, L. Empringham, and J. Clare, "Design control and implementation of a three-phase utility power supply based on the matrix converter," IET Power Electron., vol. 2, no. 2, pp. 156­162, Mar. 2009. [8] P. Wheeler and D. Grant, "Optimised input filter design and low-loss switching techniques for a practical matrix converter," Proc. Inst. Elect. Eng.--Elect. Power Appl., vol. 144, no. 1, pp. 53­59, Jan. 1997. [9] C. Klumpner, P. Nielsen, I. Boldea, and F. Blaabjerg, "New Matrix Converter Motor (MCM) for industry applications," IEEE Trans. Ind. Electron., vol. 49, no. 2, pp. 325­335, Apr. 2002. [10] M. Hamouda, F. Fnaiech, and K. Al-Haddad, "Input filter design for SVM dual-bridge matrix converters," in Proc. IEEE Int. Symp. Ind. Electron., Jul. 9­13, 2006, vol. 2, pp. 797­802. [11] D. Gopinath, "Modeling, real-time simulation and design of matrix converters," Ph.D. dissertation, Dept. Elect. Eng., Indian Inst. Sci., Bangalore, India, Sep. 2009. [12] J. Andreu et al., "A step forward towards the development of reliable matrix converters," IEEE Trans. Ind. Electron., vol. 59, no. 1, pp. 167­183, Jan. 2012. [13] A. Trentin, P. Zanchetta, J. Clare, and P. Wheeler, "Automated optimal design of input filters for direct ac/ac matrix converters," IEEE Trans. Ind. Electron., vol. 59, no. 7, pp. 2811­2823, Jul. 2012. [14] T. Kume et al., "Integrated filters and their combined effects in matrix converter," IEEE Trans. Ind. Appl., vol. 43, no. 2, pp. 571­581, Mar./Apr. 2007. [15] T. Friedli, J. W. Kolar, J. Rodriguez, and P. W. Wheeler, "Comparative evaluation of three-phase ac-ac matrix converter and voltage dc-link backto-back converter systems," IEEE Trans. Ind. Electron., vol. 59, no. 12, pp. 4487­4510, Dec. 2012. [16] D. Casadei, G. Serra, A. Tani, A. Trentin, and L. Zarri, "Theoretical and experimental investigation on the stability of matrix converters," IEEE Trans. Ind. Electron., vol. 52, no. 5, pp. 1409­1417, Oct. 2005. [17] D. Casadei et al., "Large-signal model for the stability analysis of matrix converters," IEEE Trans. Ind. Electron., vol. 54, no. 2, pp. 939­950, Apr. 2007. [18] A. Dasgupta and P. Sensarma, "Low-frequency dynamic modelling and control of matrix converter for power system applications," IET Power Electron., vol. 5, no. 3, pp. 304­314, Mar. 2012. [19] K. Sun, D. Zhou, H. Lipei, K. Matsuse, and K. Sasagawa, "A novel commutation method of matrix converter fed induction motor drive using RB-IGBT," IEEE Trans. Ind. Appl., vol. 43, no. 3, pp. 777­786, May/Jun. 2007.

[20] D. Gopinath and V. Ramanarayanan, "Implementation of bi-directional switch commutation scheme for matrix converters," in Proc. Nat. Power Electron. Conf., Bangalore, India, 2007, [CD-ROM]. [21] H. She et al., "Implementation of voltage-based commutation in space vector modulated matrix converter," IEEE Trans. Ind. Electron., vol. 59, no. 1, pp. 154­166, Jan. 2012. [22] J. Mahlein, J. Igney, J. Weigold, M. Braun, and O. Simon, "Matrix converter commutation strategies with and without explicit input voltage sign measurement," IEEE Trans. Ind. Electron., vol. 49, no. 2, pp. 407­414, Apr. 2002. [23] R. Cardenas, R. Pena, P. Wheeler, J. Clare, and G. Asher, "Control of the reactive power supplied by a WECS based on an induction generator fed by a matrix converter," IEEE Trans. Ind. Electron., vol. 56, no. 2, pp. 429­ 438, Feb. 2009. [24] R. Vargas, U. Ammann, B. Hudoffsky, J. Rodriguez, and P. Wheeler, "Predictive torque control of an induction machine fed by a matrix converter with reactive input power control," IEEE Trans. Power Electron., vol. 25, no. 6, pp. 1426­1438, Jun. 2010. [25] R. Erickson and D. Maksimovic, Fundamentals of Power Electronics, 2nd ed. Berlin, Germany: Springer-Verlag, 2001. [26] N. Mohan, T. Underland, and W. Robbins, Power Electronics: Converters, Applications, Design, 2nd ed. Hoboken, NJ, USA: Wiley, 2001. [27] L. Huber and D. Borojevic, "Space vector modulated three phase to three phase matrix converter with input power factor correction," IEEE Trans. Ind. Appl., vol. 31, no. 6, pp. 1234­1246, Nov./Dec. 1995.

Anindya Dasgupta received the B.E.E. degree in electrical engineering from Jadavpur University, Calcutta, India, in 2000; the M.E. degree in electrical engineering from the Bengal Engineering and Science University, Shibpur, India, in 2006; and the Ph.D. degree in electrical engineering from the Indian Institute of Technology Kanpur, Kanpur, India, in 2013. He is currently a Faculty Member in the Department of Avionics, Indian Institute of Space Science and Technology, Thiruvananthapuram, India. His research interests include power converter topologies and their modeling and control.

Parthasarathi Sensarma (M'00) received the B.E.E. degree in electrical engineering from Jadavpur University, Calcutta, India, in 1990; the M.Tech. degree in electrical engineering from the Indian Institute of Technology (IIT) Kharagpur, Kharagpur, India, in 1992; and the Ph.D. degree in electrical engineering from the Indian Institute of Science, Bangalore, India, in 2001. He has held positions with Bharat Bijlee Ltd., Thane, India; CESC Ltd., Kolkata, India; and ABB Corporate Research, Baden-daettwil, Switzerland, where he was a Staff Scientist with the Power Electronics Department. Since 2002, he has been with the Department of Electrical Engineering, IIT, Kanpur, India, where he is currently an Associate Professor. His research interests include power quality, FACTS devices, power converters, and renewable energy integration.

The author has requested enhancement of the downloaded file. All in-text references underlined in blue are linked to publications on ResearchGate.

