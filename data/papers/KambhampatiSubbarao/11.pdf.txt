Compliant Conditions for Polynomial Time
Approximation of Operator Counts
Tathagata Chakraborti∗
Sarath Sreedharan∗ Sailik Sengupta∗
T. K. Satish Kumar†
Subbarao Kambhampati∗

arXiv:1605.07989v2 [cs.AI] 5 Jul 2016

∗

†
∗

Dept. of Computer Science, Arizona State University
Dept. of Computer Science, University of Southern California

{tchakra2, ssreedh3, sailiks, rao}@asu.edu † tkskwork@gmail.com

Abstract
In this paper, we develop a computationally simpler version of the operator count
heuristic for a particular class of domains. The contribution of this abstract is threefold,
we (1) propose an efficient closed form approximation to the operator count heuristic using the Lagrangian dual; (2) leverage compressed sensing techniques to obtain an integer
approximation for operator counts in polynomial time; and (3) discuss the relationship of
the proposed formulation to existing heuristics and investigate properties of domains where
such approaches appear to be useful.

The OP-COUNT Heuristic
Domain Model.
The domain is described by a set of variables f ∈ F which can assume values from a (finite)
domain D(f ) ⊆ N. A state is given by the particular assignment of values to these variables:
S = {f = v | v ∈ D(f ) ∀f ∈ F }. The value of variable f in state S is referred to as S(f ).
The action model A consists of operators a = hCa , Ea i where Ca is the cost of the action, and
Ea = {hf, vo , vn i | f ∈ F ; vo , vn ∈ {−1} ∪ D(f )} is the set of effects. The transition function
δ(·) determines the next state after the application of action a to state S as δ(a, S) = ⊥ if ∃hf, vo , vn i ∈ Ea s.t. vo 6= −1 ∧ vo 6= S(f );
= {f = vn ∀hf, vo , vn i ∈ Ea ; else f = S(f )} otherwise.

Plans and Operator Counts.
A planning problem is a tuple Π = hF , A, I, Gi, where I, G are the initial and (partial) goal
states respectively. The solution to the planning problem is a plan π = ha1 , a2 , . . .i, π(i) =
ai ∈ A such that δ(π, I) |= G, where the cumulative transition function
is given by δ(π, S) =
P
δ(ha2 , a3 , . . .i, δ(a1 , S)). The cost of the plan is given by C(π) = a∈π Ca and an optimal plan
π ∗ is such that C(π ∗ ) ≤ C(π) ∀π. The operator count for an action a given a plan π is given by
λ(a, π) = |{i | a = π(i)}| and the total operator count of the plan λ(π) = |π|.
1
Published as a 2-page research abstract at the International Symposium on Combinatorial Search (SoCS), 2016

Compliant Variables.
We define compliant variables as those that whenever they occur as a precondition of an action,
they must also be an effect, and vice versa. Thus, f ∈ F is compliant iff ∀a ∈ A, hf, vo, vn i ∈
Ea =⇒ vo 6= −1 ∧ vn 6= −1; f is referred to as rogue otherwise. Let Φ ⊆ F be the set of all
compliant variables, and the set of compliant variables whose values are specified in the goal
be φ ⊆ Φ, henceforth referred to as goal compliant conditions.
The State Transformation Equation.
Let |φ| = m and |A| = n. Consider an m × n matrix M whose ij th element Mij ∈ Z is the
numerical change in fi ∈ φ produced by action aj ∈ A, i.e. Mij = vn − vo ; hfi , vo , vn i ∈ Eaj .
Also, let D be a vector of size m whose ith entry di is the change in a goal compliant f ∈ φ
from the current state to the final state, i.e. di = vg − vc ; vg = fi ∈ G, vc = fi ∈ S; and let x be
a vector of size n, whose ith element is xi ∈ N. Then the following equality holds:
Mx = D

(1)

The integer solution x∗ to this system of linear equations with the least |x∗ | gives a lower bound
on the operator counts required to solve the planning problem, i.e. |x∗ | ≤ |π ∗ |. We can compute
a real-valued approximation in closed-form, by
min ||Qx||22
s.t. Mx = D

(2)
(3)

using the Lagrangian multiplier method for this optimization problem as follows 1
L(x) = ||Qx||2 + λT (D − Mx)
2
=⇒ x∗ = Q−2 MT (MQ−2 MT )−1 D

(4)
(5)

Here Q is a n × n matrix of action costs whose ij th entry Qij = Cai if i = j; 0 otherwise
(for unit cost domains) Q is an identity matrix and x∗ = MT (MMT )−1 D The most costly
operation here is the calculation of the pseudo inverse, which can be done in ≈ O(n2.3 ) time.
Further, M is problem independent, and hence the factor Z = Q−2 MT (MQ−2 MT )−1 can
be precomputed given an action model. Thus it follows that we can readily use ||QZD|| as a
heuristic for state-space search.
Note that this formulation can also determine infeasibility of goal reachability immediately
(in domains where actions are not reversible this is extremely useful) when the system is unsolvable, as shown in Algorithm 1. Unfortunately, the use of the l2 -norm, that helps us in obtaining
the closed-form polynomial bound heuristic, also makes the heuristic inadmissible.
Sparse coding.
Since operator counts are integers, we would ideally want an integer solution to Eqn 4 (which
makes the problem computationally intractable). Unfortunately, the polynomial bound Lagrangian
method described above does not address this aspect giving rise to bad heuristic values for
certain section of problems. To describe this problem geometrically, we consider a planning
domain with two compliant operators (of unit cost), such that x =< x1 , x2 >. If the plane
inscribed by Mx = D in the two dimensional space is close two either of the axis, the l2 norm
calculated above results in small fractional values, and hence a less informed heuristic. As can
2

Algorithm 1 Using OP-COUNT Heuristic for State-Space Search
procedure P RE - COMPUTE(Π)
Compute M, Q
Convert M to row echelon form → T is the transformation matrix, r is the rank
Y ← M[1 : r, :], Z ← Q−2 Y T (YQ−2 Y T )−1
procedure h(S) = OP-COUNT(S, G)
Compute D = G − S
Compute T d = T × D and τ = Td [1 : r]
if tdi 6= 0 ∀i ≥ r + 1 then No solution!
else
return ⌈Q × Z × τ ⌉

be seen in the figure 1, the actual operator counts for the given example (with M = 15 4
and D = 12 ) should have been x1 = 0 and x2 = 3. But the l2 minimization results in small
fractional values with x1 = 0.77 and x2 = 0.77, and the heuristic values of hl2 = 1.54 instead
of |π ∗ | = 3.
x2
Mx = D

l2 -norm

x1

Figure 1: Eucledian norm minimization produces small fractional values for x1 and x2
Thus, we propose a different approximation method to obtain integer values for individual
operator counts, remaining within the polynomial time bound.
We notice that in most cases n ≫ m and also n ≫ |x∗ | due to the combinatorial explosion
during grounding of domains. Thus, we propose an operator count heuristic that exploits this
knowledge about the sparsity of x∗ . Ideally, we would like to solve the following problem,

s.t.

min
|x|l0
Mx = D
x  0

since minimizing the l0 norm results in the sparsest solution. But, we encounter two problems.
Firstly, the optimal operator counts (x∗ ), although sparse, might not be the sparsest solution.
Secondly, minimizing the l0 norm is NP-hard [5].
Thus, we draw upon compressed sensing techniques to enforce a level of sparsity when
computing the vector x. To this end, we suggest minimization of l1 -norm (l1 -LP) or weighted
l1 -norm (ω-l1 -LP) [4] to enforce positive integer solutions.
3

Geometrically, as can be seen in figure 2 these norms produce a more informed heuristic
(hl1 = 1.60 and hω−l1 = 3.4) for the aforementioned problem. This method tries to compress
(minimize) the norm ball (or box for that matter) as much as possible till it fits in the plane
Mx = D. The operator (dimension) that induces a tighter constraint (x1 in our case), limits the
expansion of the norm ball, producing a less informed heuristic (hl1 = 1.60). The weighted
l1 -norm method addresses this problem by minimizing the l1 -norm and iteratively penalizing
the increase along the tightest dimension till convergence is reached or maximum number of
iterations are achieved, resulting in a more informed heuristic (hω−l1 = 3.4).
x2

x2
Mx = D

Mx = D

l1 norm
x1

ω-l1 norm

x1

Figure 2: Eucledian norm minimization produces small fractional values for x1 and x2
For ω-l1 -LP, we empirically observe that rounding up the individual operator counts produce
a more informed heuristic. Thus, we arrive at a polynomial time proxy for integer solutions.
Evaluations.
The table shows the evaluation of the proposed heuristics across a total of 83 problems from
five well-known unit cost planning domains. Each entry in the table represents the percentage
difference in the initial state heuristic value and the optimal plan length averaged across the
problems in each domain. The %-compliance column shows the average number of goal compliant predicates in the problems. Rows 1-3 show the performance of our heuristic on the original domains (‘-’ indicates that the heuristics could not be computed due to absence of any goal
complaint variables). Rows 3-6 show the performance in domains where the %-compliance was
increased (this was done by identifying instances in the action model where variables assume
a don’t care condition, i.e. a value of -1, and replacing it with appropriate values as entailed
by domain axioms). Finally, rows 6-9 show the performance of our heuristics in problems with
more completely specified goals (which results in higher percentage compliance). As expected,
our heuristic performs better as %-compliance increases across a particular domain. The performance of l1 LP and ω-l1 LP highlights the usefulness of compressed sensing techniques in
obtaining better integer approximations to the MILP.

4

Domains
GED
Blocks-3ops
Blocks-4ops
Visitall
GED
Blocks-3ops
Blocks-4ops
Visitall
Blocks-3ops
Blocks-4ops
8-puzzle

%-compliance
34.29%
31.25%
19.64%
25.49%
31.25%
19.64%
21.75%
48.13%
42.86%
88.89%

l1 -MILP
55.48%
47.80%
67.71%
37.61%
47.80%
67.71%
28.41%
28.68%
56.25%
33.33%

l1 -LP
55.48%
47.80%
67.71%
34.02%
47.80%
67.71%
28.41%
28.68%
56.25%
40.00%

ω − l1 -LP
75.76%
23.60%
35.42%
53.36%
23.60%
35.42%
44.37%
44.38%
12.50%
46.67%

OP-COUNT
55.48%
52.60%
67.71%
48.32%
52.60%
67.71%
100.00%
32.32%
64.58%
40.00%

Discussion and Related Work
Relation to Existing Heuristics.
The proposed heuristic has close associations with both heuristics on state change equations and
operator counts [8, 3, 10]. Specifically, compliant conditions capture the net change criteria very
succinctly and are thus extremely useful where such properties are relevant. Another interesting
connection to existing work is with respect to graph-plan based heuristics [2], except here we
are relaxing preconditions instead of delete effects.
Compliance.
Our approach works better in domains that have many goal compliant conditions, e.g. in manufacturing domains [6] or in puzzles like Sudoku [1]. Thus goal completion strategies and
semantic preserving actions have a direct effect on the quality of the heuristic. Intermediate
representations such as transition normal form (TNF) [7] should be investigated in this context.
Landmarks.
Our purpose here is not to compete with the most sophisticated heuristics of today but to motivate a special case that can be computed extremely efficiently. We discussed the simplest version
of this formulation here, but it can be easily extended to incorporate more informative features
like landmarks [9]. A landmark constraint is added by simply subtracting the corresponding net
change from D: di ← di − ka × (xn − xo ) if hdi , xo , xn i ∈ Ea and a ∈ A is an action landmark
with cardinality ka ; and the closed form solution remains valid. In fact in terms of plan recognition with operator counts, observations are landmarks and the same approach applies. This
demonstrates the flexibility of our approach.
Resource Constrained Interaction.
The approach is especially relevant in the context of multi-agent interactions constrained by
usage π α (η) of a shared resource η by a plan π α of an agent α. For example, in an adversarial
setting, if an agent α2 wanted to stop α1 from executing its plan, all it needs to do is to ensure
that ∃η s.t. π α1 (η) + π α2 (η) > |η|. Similarly, in a cooperative setting, if agent α2 wanted to
ensure that α1 ’s plan succeeds, it would need to make sure that ∀η π α1 (η) + π α2 (η) ≤ |η|.

5

In fact, as resource variables are compliant, our approach may provide quick estimates of an
agent’s intent without computing the entire plan.
Acknowledgment. This research is supported in part by the ONR grants N00014-13-1-0176, N00014-131-0519 and N00014-15-1-2027, and ARO grant W911NF-13-1-0023.

References
[1] Prabhu Babu, Kristiaan Pelckmans, Petre Stoica, and Jian Li. Linear systems, sparse
solutions, and sudoku. Signal Processing Letters, IEEE, 17(1):40–42, 2010.
[2] Avrim L Blum and Merrick L Furst. Fast planning through planning graph analysis. Artificial intelligence, 90(1):281–300, 1997.
[3] Blai Bonet, Menkes Van Den Briel, et al. Flow-based heuristics for optimal planning:
Landmarks and merges. In ICAPS, 2014.
[4] Emmanuel J Candès, Michael B Wakin, and Stephen P Boyd. Enhancing sparsity by
reweighted l1 minimization. Journal of Fourier analysis and applications, 2008.
[5] Dongdong Ge, Xiaoye Jiang, and Yinyu Ye. A note on the complexity of l p minimization.
Mathematical programming, 129(2):285–299, 2011.
[6] Dana S Nau, Satyandra K Gupta, and William C Regli. Ai planning versus manufacturingoperation planning: A case study. In IJCAI, 1995.
[7] Florian Pommerening and Malte Helmert. A normal form for classical planning tasks. In
ICAPS, pages 188–192, 2015.
[8] Florian Pommerening, Gabriele Röger, Malte Helmert, and Blai Bonet. Lp-based heuristics for cost-optimal planning. In ICAPS, 2014.
[9] Julie Porteous, Laura Sebastia, and Jörg Hoffmann. On the extraction, ordering, and usage
of landmarks in planning. In ECP, pages 37–48, 2001.
[10] Menkes Van Den Briel, J Benton, Subbarao Kambhampati, and Thomas Vossen. An lpbased heuristic for optimal planning. In CP, pages 651–665. Springer, 2007.

6

