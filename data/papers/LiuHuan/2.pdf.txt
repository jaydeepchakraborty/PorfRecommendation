SPECIAL SECTION ON GREEN COMMUNICATIONS AND NETWORKING FOR 5G WIRELESS

Received May 26, 2016, accepted June 12, 2016, date of publication June 23, 2016, date of current version August 4, 2016.
Digital Object Identifier 10.1109/ACCESS.2016.2584088

Joint Estimation of DOA and TDOA of Multiple
Reflections in Mobile Communications
LUTAO LIU, (Member, IEEE), AND HUAN LIU
College of Information and Telecommunication Engineering, Harbin Engineering University, Harbin 150001, China

Corresponding author: L. Liu (liulutao@msn.com)
This work was supported in part by the Fundamental Research Funds for the Central Universities under Grant HEUCF1608 and in part by
the National Natural Science Foundation of China under Grant 61201410 and Grant 61571149.

ABSTRACT In a multipath communication scenario, it is often relevant to estimate the directions and
relative delays of each multipath signal. We present an effect algorithm for the simultaneous estimation of
these parameters by re-iterative super-resolution, beamforming, and MUSIC-like searching techniques. The
algorithm first separates and estimates direction of arrival (DOA) of the multipath signals. Linear constrained
minimum power beamforming is used to obtain the transmitted time function of the desired signal in certain
incident angle. Then, time difference of arrival (TDOA) for the incident signals are mapped into phase
shifts in the frequency domain. Using the DFT of the desired signal and the received data, we can separate
the phase shifts in the frequency domain due to time delay by MUSIC-like searching. At the same time,
the pairing of the estimated DOA and TDOA is automatically determined. Computer simulations illustrating
the performance of the proposed algorithm with the Cramerâ€“Rao bound are included.
INDEX TERMS Wireless communication, array signal processing, joint TDOA-DOA estimation, multipath
signal.

I. INTRODUCTION

With the increasing demand for the mobile communication system, innovative approaches are needed to improve
the performance for overcoming errors caused by mobile
channel. Long Term Evolution (LTE) is considered as one
of the promising systems that is suitable to these requirements [1], [2]. As the signal from the User Equipment (UE)
to base station undergoes multipath rays of the direct signal,
the multipath signals with different DOAs and time delays
combined with direct signal will degrade and influence the
estimation of the desired signal. Channel estimation of the
base station involves the DOAs and time delays parameter
estimation for multipath and direct sources transmitted by
the UE. So joint DOA and TDOA estimation by the base station is of interest for advanced handover schemes, emergency
localization, and potentially many user services [3].
Many space-time processing approaches have been investigated to estimate the DOA and TDOA with the smart array for
obtaining the desired signals. In [4] and [5], the approaches
require to ML searches with great computation load or
need good accurate initial value for the accurate estimation.
In [6]â€“[8], the algorithms are developed to transform the
data in frequency domain and maps delays into phase shifts,
and the joint estimation problem is changed to one that can
VOLUME 4, 2016

be solved using 2-D ESPRIT techniques. Joint DOA and
TDOA estimation by multi-invariance MUSIC are proposed
in [9] and [10]. Those algorithms require the known modulation pulse shape of one symbol to recovery the time delays.
And the delay less than the symbol duration can be obtained
by the algorithms. In mobile communication, time delays
between different paths are most likely to be longer than the
symbol rate. The algorithms [11], [12] do not need the known
modulation pulse shape instead of the known transmitted
signal. The algorithms require the preamble to recovery the
time delays between each arrival. In [13], a method is proposed, which associates DOA from the MUSIC algorithm and
TDOA from the correlator separatively. It considered multipath signals as independents sources, assumed the delays
between the components are larger than the duration of autocorrelation of emitted signals.
In this work, a practical method to estimate TDOA associated with DOA information in the presence of multipath
without any preamble sequence is proposed. The algorithm
is based on an efficient high-resolution scheme that transforms the multi-dimensional estimation involved in two sets
of simple one-dimensional (1-D) estimation. To do so, we
propose to use the RISR algorithm to estimate DOAs of the
multipath signals without forward-backward averaging and

2169-3536 
 2016 IEEE. Translations and content mining are permitted for academic research only.
Personal use is also permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

3815

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

spatial smoothing [14]. And the LCMP beamforming [15]
in conjunction with the received data by the array is used
to estimate the time function of the desired signal in certain
incident angle. Then time delays of the incident signals are
mapped into phase shifts in frequency domain by Discrete
Fourier Transformation (DFT). Using the sequence of the
desired signal and the received data in frequency domain, we
can estimate the time delays of the signals by MUSIC-like
peaks searching. The new proposed numerical method is able
to associate correctly the DOA from the RISR algorithm and
TDOA from the MUSIC-like algorithm.
Our major contributions are summary as follows: (1) Use
the RISR, beamforming and MUSIC-like techniques in conjunction to realize the DOA and TODA estimation without
preamble knowledge (2) The algorithms is suitable of arbitrary array structures (3) Time delay within a fraction of
the sampling time can be estimated accurately in frequency
domain. To our knowledge, no other existing algorithm is able
to jointly estimate of TDOA and DOA of the multipath signals
without preamble.
The structure of the paper is as follows. In Section II,
we begin our discussion by formulating the problem and
describing the data model. Section III contains a detailed
derivation of the basic steps of the algorithm, including the
techniques to obtain the DOAs of multiple sources and to
estimate the time function of them. Identifiability of the
DOAs and TDOAs using the proposed technique is addressed
in Section IV. Section V illustrates the performance using
computer simulations.
Notation: Vectors (matrices) are denoted by boldface lower
(upper) case letters, all vectors are column vectors, superscripts (Â·)T , (Â·)âˆ— , (Â·)H and (Â·)â€  denote transpose, conjugate,
complex conjugate transpose and Pseudo-inverse respectively, E[Â·] denotes statistical expectation, I is the identity
matrix, | Â· | represents the modulus of a complex number, and
k Â· k is the Euclidean norm of a vector. The symbol  denotes
the Hadamard product between two matrices of appropriate
size and the symbol â—¦ is used to denote convolution operator.
product.
II. SYSTEM MODEL

Consider a linear array composed of M omnidirectional sensors in a base station to receive K (K < M ) narrow-band
plane wave signals from directions Î¸1 , Î¸2 , Â· Â· Â· Î¸K , in which
one of the signals is the direct signal and the other K âˆ’ 1
signals are reflection components. The distance between the
first reference element and the i-th element is di in the array
with at least two elements spaced at half of the wavelength of
radiation sources or closer, as shown in Fig. 1. Signal sd (t) is
defined as the direct signal with fading coefficient Î²d = 1 and
time delay Ï„d = 0, then the other reflection signals received
can be expressed as
sk (t) = Î²k sd (t âˆ’ Ï„k ).

(1)

In general, array antenna received signal vector y(t) formed
by the superposition of the multipath signals and noise can be
3816

FIGURE 1. Schematic diagram of an antenna array with one impinging
signal.

described as
y(t) =

K
X

a(Î¸k )sk (t) + v(t)

(2)

k=1

where y(t)
=
[y1 (t), y2 (t), Â· Â· Â· , yM (t)]T is the M
dimensional snapshot data vector of the array, v(t) =
[v1 (t), v2 (t), Â· Â· Â· , vM (t)]T is the M dimensional noise data
vector. The vector-valued function a(Î¸k ) is the array response
vector (steering vector) for an array of M elements to the
kth source signal from the direction Î¸k , expressed as follows:
a(Î¸k ) = [1, eâˆ’jÏ†k1 , Â· Â· Â· , eâˆ’jÏ†ki , Â· Â· Â· , eâˆ’jÏ†k(M âˆ’1) ]T

(3)

where the phase shift of the ith element for each narrowband

arrival signal can be defined as Ï†ki = 2Ï€ fc di sin(Î¸k ) c. fc is
the carrier frequency of the incident signals, c is the speed
of light. It is assumed that the signals and noise are stationary, zero mean uncorrelated random processes. Further, the
noise vector is Additive Gaussian White Noise (AGWN) with
variance Ïƒ 2 .
III. REVIEW OF SOME TECHNIQUES

The proposed algorithm is partly based on the RISR algorithm and beamforming techniques, so it is necessary to make
a brief review of them.
A. RISR DOA ESTIMATION ALGORITHM

Many traditional DOA estimation methods are based on
the covariance information of spatial samples, and the estimation performance will be significantly decreased when
some sources are related in time domain. The essence of
Re-Iterative Super-Resolution (RISR) algorithm is the
recursive implementation of the minimum mean-square
error (MMSE) [16]. When the determined spatial covariance information and the approximate value of the array
calibration tolerance are given, RISR determines an MMSE
filter bank according to the estimate of the spatial power
distribution. Then the MMSE filter bank is applied to the
received data for the updated estimation of spatial power
distribution which is used to redefine the MMSE filter banks.
The two processes above constantly alternates. Finally, the
number of signal sources (the prior knowledge of the number
of signal source is not needed), their respective DOAs, and
their respective magnitudes can be determined automatically.
VOLUME 4, 2016

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

One of the advantages for the algorithm is that it can distinguish the coherent signals received by the array, which often
happen in the mobile communication.
Given K narrowband signals from the far field which
simultaneously incident on the array. After A/D conversion,
The lth time sample, which contains superposition of signal
and noise can be expressed in vector notation, same as (2)
y(l) =

K
X

xk (l) + v(l)

(4)

k=1

where xk (l) = a(Î¸k )sk (l). For 
simply addressing DOA estimation, let Ïˆk = 2Ï€ fc sin Î¸k c. Then the steering vector
a(Î¸k ) in Î¸ -space is transformed to Ïˆ-space as a(Ïˆk ). In order
to determine the DOA of each signal in Ïˆ-space at the
lth sample, we approximate received data y(l) in (4) with a
parameterized version as
1

y(l) âˆ¼
= yÌƒ(l) = As(l) + v(l).

(5)

According to the array configure, the M Ã— N dimensional
array manifold matrix A is constructed and defined as
A = [a(0), a(Ïˆ1 ), Â· Â· Â·
ï£®
1
1
jd1 Ïˆ1
ï£¯1
e
ï£¯
=ï£¯.
..
ï£° ..
.
1

ejdM âˆ’1 Ïˆ1

, a((N âˆ’ 1)Ïˆ1 )]
Â·Â·Â·
1
Â·Â·Â·
ejd1 Ïˆ1 (N âˆ’1)
..
Â·Â·Â·
.
Â·Â·Â·

ejdM âˆ’1 Ïˆ1 (N âˆ’1)

ï£¹
ï£º
ï£º
ï£º
ï£»

(6)

P(l) = E{s(l)sH (l)}  I M

Minimizing (7) and the well-known MMSE filter can be
obtained as
(8)

Substituting y(l) of (5) into (8), with the added assumption
that the signal and noise are uncorrelated and statistically
independent, then results is found to be
W (l) = (AE{s(l)sH (l)}AH + E{v(l)vH (l)})âˆ’1 AE{s(l)sH (l)}

where I M is an M Ã—M identity matrix. The diagonal elements
of P(l) comprise the power distribution in space. Substituting
the noise covariance matrix and spatial power distribution
matrix of (10) into (9) yield
W (l) = (AP(l)AH + Rv )âˆ’1 AP(l).

(11)

Given the filter bank W (l), the MMSE estimation of s(l) can
be obtained as
sÌ‚ (l) = W H (l)y (l)

(12)

Since the prior knowledge of P(l) is unknown, the recursive
process of the previous estimation is needed. Based on the
matched filter bank strategy, the pre-estimate of s(l) can be
determined as
sÌ‚0 (l) = AH y(l).

(9)

PÌ‚ 0 (l) = [sÌ‚0 (l)sÌ‚H
0 (l)]  I M .

(13)

where noise covariance matrix Rv =
, can be
written in the form as Ïƒ 2 I. As a measure of statistical similarity over time, the temporal correlation of the signal sources

(14)

The relation between new MMSE filter bank estimation WÌ‚ i (l)
and previous estimation PÌ‚ iâˆ’1 (l) is
WÌ‚ i (l) = (APÌ‚ iâˆ’1 (l)AH + Rv )âˆ’1 APÌ‚ iâˆ’1 (l),

(15)

then a new MMSE estimation of s(l) can be expressed as
follow
H

sÌ‚i (l) = WÌ‚ i (l)y (l) .

(16)

The ith spatial power distribution estimation has the same
expression form like (14)
PÌ‚ i (l) = [sÌ‚i (l)sÌ‚H
i (l)]  I M .

(17)

Recursive procedure for
distribution estimation
 spatial power 
2
may be stopped until sÌ‚i (l) âˆ’ sÌ‚iâˆ’1 (l) < Îµ, where the Îµ is
a pre-specified threshold or after some pre-determined number of recursions. At the end ofâˆšthe recursion, the diagonal
elements of the diagonal matrix P i (l) is â€˜â€˜RISR spectrumâ€™â€™
and the spatial magnitude distribution consistent with the
Ïˆ-space division for the radiation sources is given. After that,
we can calculate the DOAs of the signals recieved by

E{v(l)vH (l)}

VOLUME 4, 2016

(10)

So the initial estimation P(l) subsequently is computed as

which consists of N spatial steering vectors corresponding to angles defined over 2Ï€ with the angular increment
Ïˆ1 = 2Ï€/N . The angle range of incident signals is separated
to N grids. With the parameter N increasing, the quantization
effect of the angle becomes better, while the capability to
solve the problem of noise, source correlation effects and
array modeling errors becomes stronger.
The idea of the RISR algorithm is to estimate the Minimum
Mean-Square Error through the M Ã— N adaptive filter bank,
with the received signal model defined in (5) and the assumed
knowledge of spatial complex vector s(l). The MMSE cost
function can be written as

2


J (W ) = s(l) âˆ’ W H (l)y(l) .
(7)

W (l) = (E{y(l)yH (l)})âˆ’1 E{y(l)sH (l)}.

is meaningless in terms of the RISR algorithm because the
RISR formulation just works on each snapshot independently
or combines power estimates via non-coherent integration.
In order to perform the temporally uncorrelated assumptions,
the spatial energy distribution matrix can be written as

Î¸k = arc sin

Ïˆk c
.
2Ï€ fc

(18)
3817

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

B. LCMP BEAMFORMING

Weighted vector w of LCMP (linear constrained minimum
power) beamforming algorithm [15] can be obtained by
minimizing the output power, under Mc linear constraint
conditions as
wH C = gH

(19)

where w is an M -dimensional vector, gH is an
Mc -dimensional vector and C is an M Ã— Mc matrix, the
column vectors of which are linearly independent. Assumed
that the first column of C corresponds to the steering vector
of the signal of interest, and the first element of g is unit,
the signal will pass through the filter undistorted. Furthermore the data covariance matrix Ry , which keeps the output
power minimum in the constraint condition of (19) is known
as [15]

A. MUSIC-LIKE ALGORITHM FOR TIME
DELAY ESTIMATION

MUSIC is explored into high-resolution time delay estimation though the conventional MUSIC algorithm [17] was proposed to estimate the DOAs of the sources. As the data model
description in (1) and (2), the wireless multipath channel
containing K path components can be modeled by
h(t) =

K
X

a(Î¸k )Î²k Î´(t âˆ’ Ï„k )

(25)

k=1

where Î´(t) is the dirac pulse. Therefore, the signal model can
be rewritten as
y(t) = s(t) â—¦ h(t) + v(t)
K
X
=
a(Î¸k )Î²k s(t âˆ’ Ï„k ) + v(t).

(26)
(27)

k=1

Pout = wH Ry w

(20)

The DFT expression of y(t) in (26) can be written as
Y (f ) = S(f )H(f ) + V (f )
K
X
a(Î¸k )Î²k eâˆ’j2Ï€f Ï„k + V (f )
= S(f )

minimize the following function
1

J = wH Ry w + [wH C âˆ’ gH ]Î» + Î»H [C H w âˆ’ g],

(21)

k=1

= [AÎ¸ Î²] [S(f )bÏ„ ] + V (f )

we can obtain
Î» = âˆ’g [C
H

H

H

âˆ’1
Râˆ’1
y C]

(22)

and
H
H âˆ’1 âˆ’1 H âˆ’1
wH
LCMP = g [C Ry C] C Ry .

(23)

In our case, we will use LCMP beamforming to estimate
the time function of one desired signal with other signals
suppressed. According to (19), the distortionless constraint
with adding constraints, can be written as:
(
wH a(Î¸k ) = 1
(24)
wH a(Î¸i ) = 0, i âˆˆ [1, . . . , K ] and i 6 = k
IV. PROPOSED ALGORITHM

Our goal is to jointly estimate DOA and TDOA parameters
without knowledge of the emitter signal under multipath
propagation conditions. Firstly, the RISR algorithm presented
in III-A will be applied to separate the coherent signals and
determine DOAs of them. Furthermore, the LCMP beamforming is established according to the DOA information
obtained. The optimal beamformer can maximize the ratio
of interest output signal to the sum power of interference
(other signals) and noise. It is also considered as a spatial
filter, which makes the useful signal pass and make the output
power of the noise and interference as small as possible. Next,
we will find the delays of different impinging signals in the
array. MUSIC-like searching method is used to estimate the
delays through the orthogonality principle between the signal
subspace and the noise subspace. There are different peaks
in the searching which are related to the delays of arrival,
associated each delay with its proper DOA.
3818

(28)

where S(f ), H(f ) and V (f ) are the Fourier transform of s(t),
h(t) and v(t), respectively. AÎ¸ = [a(Î¸1 ), a(Î¸2 ), Â· Â· Â· , a(Î¸K )] ,
Î² = diag{[Î²1 , Î²2 , Â· Â· Â· , Î²K ]} and bÏ„ = [ej2Ï€f Ï„1 , Â· Â· Â· , ej2Ï€f Ï„K ]T .
The diag{Â·} is the diagonal operator, which form a vector
creates a diagonal matrix, whose elements are the elements of
the vector. As stated in [18], we transform the data received
into frequency domain and construct an M Ã— L matrix
Y L = [Y (f1 ), Y (f2 ), Â· Â· Â· , Y (fL )]


= [AÎ¸ Î²] BÏ„ diag{S(f )} + V L
= A[Î²,Î¸ ] BT[f ,Ï„ ] + V L

(29)

where
â€¢ L represents the number of different frequency points in
frequency domain
â€¢ A[Î²,Î¸ ] = AÎ¸ Î² is an M Ã— K matrix
â€¢ S(f ) = [S(f1 ), S(f2 ), Â· Â· Â· , S(fL )] is the L-point DFT of
the signal function
â€¢ V L is an M Ã— L matrix, which presents the noise in
frequency domain.
â€¢ BÏ„ is a K Ã— L matrix, which can be written as
ï£® âˆ’j2Ï€f Ï„
ï£¹
1 1
e
eâˆ’j2Ï€f2 Ï„1 Â· Â· Â· eâˆ’j2Ï€fL Ï„1
ï£¯ eâˆ’j2Ï€f1 Ï„2
eâˆ’j2Ï€f2 Ï„2 Â· Â· Â· eâˆ’j2Ï€fL Ï„2 ï£º
ï£¯
ï£º
BÏ„ = ï£¯
ï£º
..
..
..
..
ï£°
ï£»
.
.
.
.
âˆ’j2Ï€
f
Ï„
âˆ’j2Ï€f
Ï„
âˆ’j2Ï€f
Ï„
K
k
L
k
1
2
e
e
Â·Â·Â· e
(30)
â€¢

B[f ,Ï„ ] = [BÏ„ diag{S(f )}]T is a L Ã— K matrix, the ith
column of which can be expressed as
bi = [S(f1 )eâˆ’j2Ï€f1 Ï„i , Â· Â· Â· , S(fL )eâˆ’j2Ï€ fL Ï„i ]T .

(31)

VOLUME 4, 2016

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

As the analysis above, the transpose of Y L can be expressed as
Y TL = B[f ,Ï„ ] AT[Î²,Î¸ ] + V TL
ï£®
ï£¯
ï£¯
= [b1 , b2 , Â· Â· Â· , bK ] ï£¯
ï£°

Î²1 aT (Î¸1 )
Î²2 aT (Î¸2 )
..
.

Î²K aT (Î¸K )

ï£¹
ï£º
ï£º
ï£º + V TL .
ï£»

(32)

Comparing it with (2), Y TL in (32) behaves like the received
signal at an array whose manifold matrix is B[f ,Ï„ ] and
the equivalent signal matrix is represented by AT[Î²,Î¸ ] . The
columns of B[f ,Ï„ ] behave like the steering vectors in an array
with L virtual sensors. The correlation matrix of Y TL can be
written as
 H
RYY = E[Y TL Y TL ]
 H
T
T
= B[f ,Ï„ ] E[AT[Î²,Î¸ ] (AT[Î²,Î¸ ] )H ]BH
]
[f ,Ï„ ] + E[V L V L
= B[f ,Ï„ ] P [Î²,Î¸ ] BH
[f ,Ï„ ] + RVV

(33)

where P [Î²,Î¸] = E[AT[Î²,Î¸] (AT[Î²,Î¸ ] )H ] is the covariance matrix
with rank K . Assumed L > K , the rank of matrix RYY will
be K without noise effect. We can apply EVD(eigenvalue
decomposition) to RYY
H
RYY = U S 6 S U H
S + U N 6N U N

(34)

where 6 S stands for a K Ã—K diagonal matrix whose diagonal
elements are the largest K eigenvalues, corresponding to
U S = [u1 Â· Â· Â· uK ], called signal subspace. And 6 N stands
for a diagonal matrix whose diagonal elements are composed
of the smallest L âˆ’ K eigenvalues, corresponding to U N =
[uK +1 Â· Â· Â· uL ], called noise subspace. By utilizing the orthogonality principle between the signal subspace and the noise
subspace, we can get the time delay estimation of the sources
in frequency domain by MUSIC-like searching as
F(Ï„ ) =

1
bH U N U H
Nb

(35)

where b = [S(f1 )eâˆ’j2Ï€f1 Ï„ , Â· Â· Â· , S(fL )eâˆ’j2Ï€fL Ï„ ]T has same
form as (31). The estimate of multipath time delay Ï„ is
Ï„Ì‚ = arg max F
Ï„

(36)

Searching the time delay variable Ï„ with a constant increment
in the delay range by the MUSIC-like method, we finally
obtain TDOA of the signals.
B. REALIZATION OF JOINT DOA AND TDOA ESTIMATION
BY THE PROPOSED ALGORITHM

The algorithm proposed in this paper has many advantages
in DOA estimation, RISR algorithm is applicable to arbitrary
array as long as the array manifold is known. And compared
with other convectional algorithms [17], [19], RISR can estimate the direction of arrival accurately in the case that the
number of multipath sources is unknown. In addition, many
VOLUME 4, 2016

conventional time delay estimation algorithms take advantage
of the cross-relation between the transmitted signal and the
received signal while Rayleigh restriction limits the resolution of these algorithms. The MUSIC-like time delay estimation algorithm has more high resolution for delay estimation,
which can distinguish the multipath signal components of the
time intervals below the Rayleigh limit.
The specific steps are as follows:
1) Calculate the angles of incidence signals by RISR algorithm, and pay attention to select the appropriate number of iterations. According to the observation, RISR
can always reach steady-state less than 15 iterations,
regardless of the number of signal source or the spatial
structure of the array.
2) Apply Beamforming technique to one of the interest
directions obtained in step 1), by phasing the array to
steer the main lobe in the specific direction Î¸k so that
all the received signals except the specific direction
can be eliminated. In narrowband beamforming, a complex weight is applied to the signal at each sensor and
summed to form the beamformer output
sk (t) = wH (Î¸k )y(t).

(37)

We make w = wLCMP which is calculated as (23), the
sk (t) in the direction Î¸k will be well recovered .
3) MUSIC-like algorithm is applied to the time delay
estimation. As described in IV-A. The arbitrary signal
sp (t), p âˆˆ [1, Â· Â· Â· , K ], obtained from the previous step
of the beamforming can be assumed as a reference signal(maybe not the the direct signal). Then we transform
the reference signal to frequency domain, we can obtain
Sp (f ) = S(f )eâˆ’j2Ï€f Ï„p . And construct the steering vector
of time delay Ï„
b = [Sp (f1 )eâˆ’j2Ï€f1 Ï„ , Â· Â· Â· , Sp (fL )eâˆ’j2Ï€fL Ï„ ]T

(38)

Substituting of (38) into (35), use the spectral searching
with respect to Ï„ in the specified range of time delay, we
can get K peaks, which correspond to the relative delay
to the signal Sp (f ). Since sp (t) = Î²p sd (t âˆ’Ï„p ) according
to (1), so MUSIC-like algorithm will produce spectral
peaks on Ï„k = Ï„ + Ï„p in the specific search range,
which is relative time delay to Ï„p . The real time delay
of K path signals would be
Ï„ = [Ï„1 âˆ’ Ï„p , Â· Â· Â· , Ï„K âˆ’ Ï„p ].

(39)

In fact, we always believe that the arrival time Ï„d of the
direct signal on the antenna is the shortest. Assumed
that Ï„d = 0, Ï„d âˆ’ Ï„p is the minimum element in Ï„ .
Thus, we have
d = arg min[Ï„k âˆ’ Ï„p ].
k

(40)

Finally, the real delay time of each arrival signal to
the direct signal can be obtained by the calculation as
follow
Ï„ âˆ’ (Ï„d âˆ’ Ï„p ).

(41)
3819

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

If we want to link DOA with the right TDOA, signals
in other arrival directions provided by the beamformer
are considered as reference signals to estimate relative
time delays by the MUSIC-like method, respectively.
According to the relations of the positions of spectral
peaks in multiple searching, the DOA and TDOA can
be paired correctly.
V. SIMULATION RESULTS

In this section, we conduct several simulations to demonstrate the performance of the proposed algorithm. The incident narrow-band multipath signals with carrier frequency
fc = 300MHz and sampling rate fs =1GHz under the
AWGN background are received by a 10-element uniform
linear array (ULA), in which the distance between adjacent
elements is half-wavelength. And the number of snapshots
is 100.
(a) Suppose number of multipaths are K = 3 and incident
directions of three related signals are Î¸ = [âˆ’30â—¦ , 15â—¦ , 60â—¦ ]
corresponding to time delays Ï„ = [3.2, 0, 6.7]ns. And
1
1
the fading coefficient are Î² = [0.4ej 3 Ï€ , 1, 0.7ej 5 Ï€ ].
We consider that the direct signal comes from the direction
of Î¸ = 15â—¦ . Under the condition of SNR=20dB, RISR
algorithm is applied to estimate DOA with phase angle Ïˆ
quantization N = 720, see (6). After iterating 10 times,
the pseudo-spectrum for DOA estimation is shown in Fig.2.
Three spectral peaks of the spatial energy distribution by
RISR are very sharp, corresponding to three estimation values
[âˆ’29.82â—¦ , 14.97â—¦ , 60.39â—¦ ].

FIGURE 2. DOA estimation in 20dB with RISR pseudospectrum.

After getting incident angles of the signals, we need to
estimate the time function of signals using the beamforming before realizing the high-resolution time delay estimation of each arrival signal. We firstly choose the signal
from the direction Î¸Ì‚p = âˆ’29.82â—¦ as the reference signal,
and use LCMP beamforming in this direction to calculating
the desired signal function sÌ‚p (t) as sp (t) = Î²p sd (t âˆ’ tp ).
From the pseudo-spectrum of MUSIC-like search in Fig.3(a),
we can see three peaks corresponding to the time delay
3820

FIGURE 3. Pseudo-spectral of time delay estimation in SNR=20dB.
(a) Signal from Î¸Ì‚1 = âˆ’29.82â—¦ as the reference signal function. (b) Signal
from Î¸Ì‚1 = 14.97â—¦ as the reference signal. (c) Signal from Î¸Ì‚1 = 60.39â—¦ as
the reference signal.

Ï„Ì‚ = [âˆ’3.2, 0, 3.5]ns, which is the relative delays to the signal sÌ‚p (t) from Î¸Ì‚p = âˆ’29.82â—¦ . The spectrum peaks of the time
delays should be positioned in Ï„ = [Ï„1 âˆ’ Ï„p , Ï„2 âˆ’ Ï„p , Ï„3 âˆ’ Ï„p ].
Since the minimum value in Ï„Ì‚ is Ï„1 âˆ’ Ï„p = âˆ’3.2ns, we can
know that real time delays of the signals are [0, 3.2, 6.7]ns
and the reference signal from Î¸Ì‚ = âˆ’29.82â—¦ with time delay
3.2ns is not the direct signal. Consider the incident signal
VOLUME 4, 2016

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

from Î¸Ì‚p = 14.97â—¦ as the reference signal, the relative delays
to it are Ï„Ì‚ = [0, 3.2, 6.7]ns in Fig.3(b). The signal which
comes from Î¸Ì‚ = 14.97â—¦ is the direct signal, since the relative
time delay in the three peaks are all positive in this spectrum.
From the calculation above, we can also know that the signal
of Î¸ = 60.39â—¦ has the time delay Ï„ = 6.7ns. Thus, the
TDOA and DOA of each signal is paired. Fig.3(c) shows
that delay time of the signals from three directions relative
to the third incident angle of Î¸ = 60.34â—¦ , which is not
necessary for pairing the DOA and TDOA in general. In the
Fig.4, we show Root Mean Square Error (RMSE) of DOA
and time delay estimation for the signal with the Cramer-Rao
bound (CRB) [6] versus SNR by 500 Monte Carlo trials.

FIGURE 4. RMSE of DOA and TDOA for the three signal versus SNR.

(b) In order to further illustrate the DOA estimation performance of the proposed algorithm, it is compared with
MUSIC [17], spatial smoothing MUSIC [20] and Topelize
algorithm [21] in the separation ability for coherent signals. It is also assumed that the number of sources is an
prior knowledge and the ULA of 10-element is divided into
7 overlapped sub-arrays (each sub-array have 4 elements)
for smoothing MUSIC. In order to show clearly the performance of these algorithms, we reset the incident DOAs
of the multipath signals. In Fig.5(a), the incident angle is
Î¸ = [10â—¦ , 13â—¦ , 60â—¦ ] with the time delay [0, 3.2, 6.7]ns.
We can see that MUSIC algorithm canâ€™t separate the coherent signals at all; Toeplize algorithm can barely distinguish
between two adjacent signals. By comparison, the spatial
smoothing and proposed algorithm can clearly distinguish
all the signals. With the angle of incidence between the two
coherent signals closing, Toeplize algorithm failed in Fig.5(b)
and smoothing MUSIC in Fig.5(c). It can be seen that the proposed algorithm can form a substantially deeper null between
the two closely spaced sources. Fig.6 shows the performance
of the probability of separation with regard to the incident
angle difference of two sources in SNR=20dB for the four
methods . As we expected, the MUSIC algorithm for separating adjacent spatial sources is invalid when the sources with
a strong temporal correlation, other algorithms are able to
VOLUME 4, 2016

FIGURE 5. DOA separation for correlated sources in SNR=20dB.
(a) Î¸ = 10â—¦ , 13â—¦ , 60â—¦ with Ï„ = 0ns, 3.2ns, 6.7ns. (b) Î¸ = 10â—¦ , 12â—¦ , 60â—¦ with
Ï„ = 0ns, 3.2ns, 6.7ns. (c) Î¸ = 10â—¦ , 11â—¦ , 60â—¦ with Ï„ = 0ns, 3.2ns, 6.7ns.

separate the adjacent sources. And proposed method exhibits
the remarkable DOA separation ability among the methods.
(c) We compare RMSE of the delay estimates of the proposed method, the Minimum Variance (MV) [22] and the
3821

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

direction of each relevant signal source can be distinguished
and the number of the signal sources can be determined
clearly. MUSIC-like searching process is used to obtain time
delays of the sources by the phase shifts in frequency domain,
so time delay within a fraction of the sampling time can
be estimated. Monte Carlo simulations show the proposed
algorithm has good performance for joint DOA and TOA
estimation.
REFERENCES

FIGURE 6. Probability of separation for correlated signals versus 1Î¸ .

FIGURE 7. RMSE of time delay versus SNR.

GP [11] (which utilizes the geometrical properties of the
signal in the frequency domain alternately for the time delay
variables) algorithms. We reset the incident angles and the
corresponding time delays of multipaths same to (a). In Fig.7,
it shows RMSE of time delay estimation of the signal from
Î¸ = 60â—¦ as an example with respect to the SNR. The RMSE
value is calculated for 500 Monte Carlo simulations. The
RMSE of the time delay estimated by the proposed algorithm
is less than by utilizing the MV algorithm or GP algorithm.
It is proved that the estimation of the proposed method is more
effective.
VI. CONCLUSION

The paper proposes a novel algorithm which combines RISR
technique along with the LCMP beamforming techniques
and MUSIC-like searching algorithm to jointly estimate the
DOAs and TDOAs under the multipath propagation conditions. The algorithm transforms the multi-dimensional estimation involved into two simple one-dimensional estimation.
The DOA estimation process has super high-resolution based
on an iterative scheme, which can be used to separate the
relevant signals to any known array manifold without spatial
smoothing. According to the obtained RISR spectrum, the
3822

[1] A. Ghosh, R. Ratasuk, B. Mondal, N. Mangalvedhe, and T. Thomas,
â€˜â€˜LTE-advanced: Next-generation wireless broadband technology
[invited paper],â€™â€™ IEEE Wireless Commun., vol. 17, no. 3, pp. 10â€“22,
Jun. 2010.
[2] N. Abu-Ali, A. M. Taha, M. Salah, and H. Hassanein, â€˜â€˜Uplink scheduling
in LTE and LTE-advanced: Tutorial, survey and evaluation framework,â€™â€™
IEEE Commun. Surveys Tuts., vol. 16, no. 3, pp. 1239â€“1265, Dec. 2014.
[3] T. S. Rappaport, J. Reed, and B. D. Woerner, â€˜â€˜Position location using
wireless communications on highways of the future,â€™â€™ IEEE Commun.
Mag., vol. 34, no. 10, pp. 33â€“41, Oct. 1996.
[4] M. Wax and A. Leshem, â€˜â€˜Joint estimation of time delays and directions of
arrival of multiple reflections of a known signal,â€™â€™ in Proc. IEEE ICASSP,
Atlanta, GA, USA, May 1996, pp. 2622â€“2625.
[5] A. L. Swindlehurst, â€˜â€˜Time delay and spatial signature estimation using
known asynchronous signals,â€™â€™ IEEE Trans. Signal Process., vol. 46, no. 2,
pp. 449â€“462, Feb. 1998.
[6] A.-J. van der Veen, M. C. Vanderveen, and A. Paulraj, â€˜â€˜Joint angle and
delay estimation using shift-invariance techniques,â€™â€™ IEEE Trans. Signal
Process., vol. 46, no. 2, pp. 405â€“418, Feb. 1998.
[7] S. Al-Jazzar and J. Caffery, â€˜â€˜ESPRIT-based joint AOA/delay estimation for CDMA systems,â€™â€™ in Proc. IEEE Wireless Commun. Netw.
Conf. (WCNC), Atlanta, GA, USA, May 2004, pp. 2244â€“2249.
[8] J. Picheral and U. Spagnolini, â€˜â€˜Angle and delay estimation of space-time
channels for TD-CDMA systems,â€™â€™ IEEE Trans. Wireless Commun., vol. 3,
no. 3, pp. 758â€“769, May 2004.
[9] X. Zhang, G. Feng, and D. Xu, â€˜â€˜Blind direction of angle and time delay
estimation algorithm for uniform linear array employing multi-invariance
music,â€™â€™ Prog. Electromagn. Res. Lett., vol. 13, no. 2, pp. 11â€“20, Feb. 2010.
[10] Y. Wang, J. Chen, and W. Fang, â€˜â€˜TST-MUSIC for joint doa-delay estimation,â€™â€™ IEEE Trans. Signal Process., vol. 49, no. 4, pp. 721â€“729, Apr. 2001.
[11] P. Singh and P. Sircar, â€˜â€˜Time delays and angles of arrival estimation using
known signals,â€™â€™ Signal Image Video Process., vol. 6, no. 2, pp. 171â€“178,
2012.
[12] M. Wax and A. Leshem, â€˜â€˜Joint estimation of time delays and directions
of arrival of multipath reflections of a known signal,â€™â€™ IEEE Trans. Signal
Process., vol. 45, no. 10, pp. 2477â€“2484, Oct. 1997.
[13] D. Grenier, B. Elahian, and A. Blanchard-Lapierre, â€˜â€˜Joint delay and
direction of arrivals estimation in mobile communications,â€™â€™ Signal, Image
Video Process., vol. 10, no. 1, pp. 45â€“54, Jan. 2016.
[14] T.-J. Shan, M. Wax, and T. Kailath, â€˜â€˜On spatial smoothing for directionof-arrival estimation of coherent signals,â€™â€™ IEEE Trans. Acoust., Speech,
Signal Process., vol. 33, no. 4, pp. 806â€“811, Apr. 1985.
[15] H. L. Van Trees, Optimum Array Processing: Part IV of Detection, Estimation, and Modulation Theory. New York, NY, USA: Wiley, 2002.
[16] S. D. Blunt and K. Gerlach, â€˜â€˜Adaptive pulse compression via MMSE
estimation,â€™â€™ IEEE Trans. Aerosp. Electron. Syst., vol. 42, no. 2,
pp. 572â€“584, Apr. 2006.
[17] R. O. Schmidt, â€˜â€˜Multiple emitter location and signal parameter estimation,â€™â€™ IEEE Trans. Antennas Propag., vol. 34, no. 3, pp. 276â€“280,
Mar. 1986.
[18] J. S. Wang and Z. X. Shen, â€˜â€˜An improved music TOA estimator for RFID
positioning,â€™â€™ in Proc. IEEE Radar Conf., Edinburgh, U.K., Oct. 2002,
pp. 478â€“482.
[19] R. Roy, â€˜â€˜ESPRIT-estimation of signal parameters via rotational invariance techniques,â€™â€™ Ph.D. dissertation, Dept. Elect. Eng., Stanford Univ.,
Stanford, CA, USA, 1987.
[20] S. U. Pillai and B. H. Kwon, â€˜â€˜Forward/backward spatial smoothing techniques for coherent signal identification,â€™â€™ IEEE Trans. Acoust., Speech,
Signal Process., vol. 37, no. 1, pp. 8â€“15, Jan. 1989.
VOLUME 4, 2016

L. Liu, H. Liu: Joint Estimation of DOA and TDOA of Multiple Reflections in Mobile Communications

[21] K. Takao, N. Kikuma, and T. Yano, â€˜â€˜Toeplitzization of correlation matrix
in multipath environment,â€™â€™ in Proc. IEEE Int. Conf. Acoust., Speech,
Signal Process., Tokyo, Japan, Apr. 1986, pp. 1873â€“1876.
[22] J. Vidal, M. Najar, and R. Jativa, â€˜â€˜High resolution time-of-arrival detection for wireless positioning systems,â€™â€™ in Proc. IEEE 56th Veh. Technol.
Conf. (VTC-Fall), vol. 4. Sep. 2002, pp. 2283â€“2287.

HUAN LIU was born in Harbin, China, in 1993.
She received the B.A. degree in telecommunication engineering from the Harbin University
of Science and Technology, China. She is currently pursuing the M.Sc. degree with the College
of Information and Telecommunication, Harbin
Engineering University, China.

LUTAO LIU was born in Harbin, China, in 1977.
He received the B.A. degree in electrical engineering from the Southeast University of China
in 2000, the M.Sc. degree in telecommunication engineering from the Harbin Institute of
Technology, China, in 2003, the M.Sc. degree
in microelectronics from the Delft University of
Technology, The Netherlands, in 2005, and the
Ph.D. degree in telecommunication engineering
from the Harbin Engineering University, China,
in 2011. In 2013, he was a Visiting Scholar with the Signal Processing
and Communication Laboratory, Stevens Institute of Technology, USA.
He is currently an Associate Professor with the College of Information
and Telecommunication, Harbin Engineering University, China. His research
interests are in the general area of signal processing for telecommunication.

VOLUME 4, 2016

3823

