MT-Diet : Automated Smartphone based
Diet Assessment with Infrared Images
Junghyo Lee (Speaker), Ayan Banerjee, and Sandeep K. S. Gupta
iMPACT Lab, CIDSE, Arizona Sate University, Tempe, AZ
{jlee375, abanerj3, Sandeep.Gupta}@asu.edu

Diet
â€¢ American Medical Association in 2013
â€¢ Recognized obesity as a disease officially [1]

â€¢ What is the effective method to treat and prevent the obesity?
â€¢ Existing Diet Monitoring and Problems
â€¢ Self-monitoring
â€¢ Low adherence, underreporting, and recall error

â€¢ Smartphone camera based monitoring (State-of-the-art )
â€¢ User inconvenience
â€¢ Segment multiple foods to each single food
â€¢ Select a food location in the image (Rectangle)

â€¢ Fairly low food type identification accuracy (63%)
2

MT-Diet
â€¢ MT-Diet: Automated Smartphone based Diet Assessment System using Cyber-Physical
Dynamics
â€¢ Thermal Interaction of a food plate with the environment
ğ‘‡ğ‘“ âˆ’ ğ‘‡ğ´
ğ‘“

ğ‘‡ğ‘– âˆ’ ğ‘‡ğ´
ğ’‡

= exp

âˆ’â„ğ´ğ‘¡
ğ‘“

ğ‘šğ‘“ ğ¶ğ‘

,

ğ‘‡ğ‘ âˆ’ ğ‘‡ğ´
ğ‘

ğ‘‡ğ‘– âˆ’ ğ‘‡ğ´

= exp

âˆ’â„ğ´ğ‘¡
ğ‘

ğ‘šğ‘ ğ¶ğ‘

ğ’‘

If ğ‘»ğ’Š â‰« ğ‘»ğ’Š , then ğ‘»ğ’‡ â‰« ğ‘»ğ’‘ , for at least ğ’• > ğŸğŸ ğ’ğ’Šğ’ğ’”
ğ‘“

ğ‘‡ğ‘“ - Temperature of food item at time ğ‘¡, ğ‘‡ğ‘– - initial food temperature, ğ‘šğ‘“ - mass of food item.
ğ‘
ğ‘‡ğ‘ - Temperature of food item at time ğ‘¡, ğ‘‡ğ‘– - initial food temperature, ğ‘šğ‘ - mass of plate.
ğ‘“
ğ‘
ğ‘‡ğ´ - Ambient temperature, â„ - heat transfer coefficient, ğ´- area of food item, ğ¶ğ‘ - specific heat of food, ğ¶ğ‘ - specific heat of plate.

â€¢ Contributions: Fuse Thermal and Visual Spectra
â€¢ Thermal and Color image correct each other
â€¢ Results
â€¢ Segment multiple foods to each single food automatically
â€¢ High accuracy of identifying types of food (88.93%)
â€¢ State-of-art systems have accuracy at most 63%

3

Overview

4

System Model

5

Usability
â€¢ Balanced diet recommendation
â€¢ Assume the plate has uniform depth
â€¢ Ratio of the surface area multiplied by the density of the food item

6

Diet Monitoring
â€¢ Food Segmentation
Food Recognition
â€¢ Food Identification
â€¢ Intake Amount
â€¢ Calorie Estimation
â€¢ Dietary Feedback
â€¢ Behavior Control

7

MT-Diet

8

Image Acquisition
â€¢ Prototype of MT-Diet
â€¢ Nexus 5
â€¢ Seek thermal sensor
â€¢ Micro USB wire

â€¢ Thermal Image
â€¢ Seek thermal sensor interfaced
with the Nexus 5

â€¢ Color Image
â€¢ From Built-in Nexus 5 Camera

9

Food Segmentation

10

Challenges for Image Based
Food Segmentation (1)
â€¢ Visual spectra may not have defined boundaries
â€¢ Thermal boundaries more significant
Better Contrast
in Infrared
Spectra

Food Item Location
DTT Output

4

8 â€“ connected
component labeling [2]

â€¢ Thermal signatures are not stable
1
Dynamic Thermal Thresholding (DTT)

3

2
11

Challenges for Image Based
Food Segmentation (2)
â€¢ Color (Gradient) and Texture are important features for identification
â€¢ Food items of same color as plate may be lost in visual spectra
â€¢ Fusion of visual and infrared spectra
Contour Detection
Image Segmentation

Hierarchical Image Segmentation (HIS) [3]
12

Challenges for Image Based
Food Segmentation (3)
â€¢ Food items not heated enough get deleted in DTT output
â€¢ Color image can recognize the food

Which portions
are food?
Food item
missing in DTT
Exact food portions and
locations along with
labels for connected
components
Food item
missing in HIS
13

Label Matching
â€¢ Identifies unique food items in both infrared and visual spectra
2

1

+
3

DTT output with
food labels

4

Contour and Image segments from
visual spectra

â€¢ Remove plate portions that are connected to food items with Grabcut
[4]
14

Food Identification

15

Feature Set
â€¢ Objective
â€¢ Classify the food type using SVM with kernels

â€¢ Feature Extraction
â€¢ Color feature
â€¢ RGB histogram: 32 histogram bins of each color channel

â€¢ Histogram of Oriented Gradient feature [4]
â€¢ 16 windows and 36 bins of oriented gradients of the each windows

â€¢ Texture feature [5]
â€¢ Resized food image (400 X 400), 5 scales, 8 orientations, 4 by 4 down sampling

16

Feature Fusion Methods
â€¢ Feature Fusion
â€¢ Three fusion methods
â€¢ Method of Dimensionality Reduction
â€¢ Kernel Principal Component Analysis
â€¢ Principal Component Analysis

17

Experimental Results

18

Segmentation Result

20 Food Types
in practice

19

Execution Time of Food Segmentation
â€¢ Execution time (s) of food segmentation using i7 processor
Min

Median

Max

Sum

Avg

STD

HIS

89.08

92.89

97.50

7403.9

92.55

1.66

DTT

2.83

3.13

3.9

256.12

3.2

0.24

ROF

0.39

0.78

1.01

62.77

0.78

0.09

Grabcut

2.4

14.24

41.15

1138.97

13.48

7.63

Total

95.51

111.59

145

8911.79

111.46

7.71
20

Food Identification Result
Feature

Texture
HOG
RGB
HOG & Texture
HOG & RGB
RGB & Texture
All

Best Methods
(Reduction, Kernel, Fusion)

KPCA, RBF
PCA, RBF
KPCA, Sigmoid
KPCA, RBF, 3
KPCA, RBF, 3
KPCA, RBF, 3
KPCA, RBF, 3

Accuracy(%) Execution(s)

45.08
63.11
88.11
59.43
88.93
88.93
87.7

5.13
0.35
0.57
5.13
0.7
5.62
5.43

Feature
Size
100
100
100
200
200
200
300
21

Conclusion
â€¢ MT-Diet : Automatic diet monitoring system that interfaces thermal
â€¢ High accuracy of automated food identification (88.93%)
â€¢ User-friendly diet monitoring system application
â€¢ Only one task (Click a button)
â€¢ Expected the promoted healthy eating habits

Even If your diet log is the emptyâ€¦..

22

References
[1] [Online]. Available: http://www.ama-assn.org/ama/pub/news/news/2013/2013-06-18-new-amapolicies-annual-meeting.page
[2] H. Samet and M. Tamminen (1988). "Efficient Component Labeling of Images of Arbitrary
Dimension Represented by Linear Bintrees". IEEE Transactions on Pattern Analysis and Machine
Intelligence (TIEEE Trans. Pattern Anal. Mach. Intell.) 10 (4): 579. doi:10.1109/34.3918.
[3] P. Arbelaez, M. Maire, C. Fowlkes, and J. Malik, â€œContour detection and hierarchical image
segmentation,â€ Pattern Analysis and Machine Intelligence, IEEE Transactions on, vol. 33, no. 5, pp.
898â€“916, 2011.
[4] Rother, C., Kolmogorov, V., & Blake, A. (2004, August). Grabcut: Interactive foreground
extraction using iterated graph cuts. In ACM transactions on graphics (TOG) (Vol. 23, No. 3, pp.
309-314). ACM.
[5] N. Dalal and B. Triggs, â€œHistograms of oriented gradients for human detection,â€ in Computer
Vision and Pattern Recognition, 2005. CVPR 2005. IEEE Computer Society Conference on, vol. 1.
IEEE, 2005, pp. 886â€“893.
[6] M. Haghighat, S. Zonouz, and M. Abdel-Mottaleb, â€œIdentification using encrypted biometrics,â€
in Computer Analysis of Images and Patterns. Springer, 2013, pp. 440â€“448.
23

Acknowledgment
Dr. Petteri Nurmi for shepherding out paper
Dr. Meg Bruening for her insights on diet monitoring
NSF IIS 1116385
NIBIB EB019202
GPSA for supporting the conference travel grant

24

25

