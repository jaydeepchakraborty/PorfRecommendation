MT-Diet : Automated Smartphone based Diet Assessment with Infrared Images
Junghyo Lee (Speaker), Ayan Banerjee, and Sandeep K. S. Gupta iMPACT Lab, CIDSE, Arizona Sate University, Tempe, AZ {jlee375, abanerj3, Sandeep.Gupta}@asu.edu

Diet
· American Medical Association in 2013
· Recognized obesity as a disease officially [1]

· What is the effective method to treat and prevent the obesity? · Existing Diet Monitoring and Problems
· Self-monitoring
· Low adherence, underreporting, and recall error

· Smartphone camera based monitoring (State-of-the-art )
· User inconvenience
· Segment multiple foods to each single food · Select a food location in the image (Rectangle)

· Fairly low food type identification accuracy (63%)
2

MT-Diet
· MT-Diet: Automated Smartphone based Diet Assessment System using Cyber-Physical Dynamics · Thermal Interaction of a food plate with the environment
 - 
 - 
 

= exp


-
 


,

 - 
 - 


= exp

-
 


If    , then    , for at least  >  
 - Temperature of food item at time ,  - initial food temperature,  - mass of food item.   - Temperature of food item at time ,  - initial food temperature,  - mass of plate.    - Ambient temperature,  - heat transfer coefficient, - area of food item,  - specific heat of food,  - specific heat of plate.


· Contributions: Fuse Thermal and Visual Spectra · Thermal and Color image correct each other · Results · Segment multiple foods to each single food automatically · High accuracy of identifying types of food (88.93%)
· State-of-art systems have accuracy at most 63%
3

Overview

4

System Model

5

Usability
· Balanced diet recommendation
· Assume the plate has uniform depth · Ratio of the surface area multiplied by the density of the food item

6

Diet Monitoring
· Food Segmentation Food Recognition · Food Identification · Intake Amount · Calorie Estimation · Dietary Feedback · Behavior Control

7

MT-Diet

8

Image Acquisition
· Prototype of MT-Diet
· Nexus 5 · Seek thermal sensor · Micro USB wire

· Thermal Image
· Seek thermal sensor interfaced with the Nexus 5

· Color Image
· From Built-in Nexus 5 Camera

9

Food Segmentation

10

Challenges for Image Based Food Segmentation (1)
· Visual spectra may not have defined boundaries
· Thermal boundaries more significant
Better Contrast in Infrared Spectra DTT Output Food Item Location

4

8 ­ connected component labeling [2]

· Thermal signatures are not stable
1
Dynamic Thermal Thresholding (DTT) 3
11

2

Challenges for Image Based Food Segmentation (2)
· Color (Gradient) and Texture are important features for identification · Food items of same color as plate may be lost in visual spectra · Fusion of visual and infrared spectra
Contour Detection Image Segmentation

Hierarchical Image Segmentation (HIS) [3]
12

Challenges for Image Based Food Segmentation (3)
· Food items not heated enough get deleted in DTT output
· Color image can recognize the food
Food item missing in DTT Exact food portions and locations along with labels for connected components Food item missing in HIS
13

Which portions are food?

Label Matching
· Identifies unique food items in both infrared and visual spectra
1 2

+
3 4 DTT output with food labels Contour and Image segments from visual spectra

· Remove plate portions that are connected to food items with Grabcut [4]
14

Food Identification

15

Feature Set
· Objective
· Classify the food type using SVM with kernels

· Feature Extraction
· Color feature
· RGB histogram: 32 histogram bins of each color channel

· Histogram of Oriented Gradient feature [4]
· 16 windows and 36 bins of oriented gradients of the each windows

· Texture feature [5]
· Resized food image (400 X 400), 5 scales, 8 orientations, 4 by 4 down sampling

16

Feature Fusion Methods
· Feature Fusion
· Three fusion methods · Method of Dimensionality Reduction
· Kernel Principal Component Analysis · Principal Component Analysis

17

Experimental Results

18

Segmentation Result

20 Food Types in practice

19

Execution Time of Food Segmentation
· Execution time (s) of food segmentation using i7 processor
Min Median Max Sum Avg STD

HIS
DTT

89.08
2.83

92.89
3.13

97.50
3.9

7403.9
256.12

92.55
3.2

1.66
0.24

ROF
Grabcut Total

0.39
2.4 95.51

0.78
14.24 111.59

1.01
41.15 145

62.77
1138.97 8911.79

0.78
13.48 111.46

0.09
7.63 7.71
20

Food Identification Result
Feature Best Methods
(Reduction, Kernel, Fusion)

Accuracy(%) Execution(s)

Texture HOG RGB HOG & Texture HOG & RGB RGB & Texture All

KPCA, RBF PCA, RBF KPCA, Sigmoid KPCA, RBF, 3 KPCA, RBF, 3 KPCA, RBF, 3 KPCA, RBF, 3

45.08 63.11 88.11 59.43 88.93 88.93 87.7

5.13 0.35 0.57 5.13 0.7 5.62 5.43

Feature Size 100 100 100 200 200 200 300
21

Conclusion
· MT-Diet : Automatic diet monitoring system that interfaces thermal · High accuracy of automated food identification (88.93%) · User-friendly diet monitoring system application
· Only one task (Click a button) · Expected the promoted healthy eating habits

Even If your diet log is the empty.....

22

References
[1] [Online]. Available: http://www.ama-assn.org/ama/pub/news/news/2013/2013-06-18-new-amapolicies-annual-meeting.page [2] H. Samet and M. Tamminen (1988). "Efficient Component Labeling of Images of Arbitrary Dimension Represented by Linear Bintrees". IEEE Transactions on Pattern Analysis and Machine Intelligence (TIEEE Trans. Pattern Anal. Mach. Intell.) 10 (4): 579. doi:10.1109/34.3918. [3] P. Arbelaez, M. Maire, C. Fowlkes, and J. Malik, "Contour detection and hierarchical image segmentation," Pattern Analysis and Machine Intelligence, IEEE Transactions on, vol. 33, no. 5, pp. 898­916, 2011. [4] Rother, C., Kolmogorov, V., & Blake, A. (2004, August). Grabcut: Interactive foreground extraction using iterated graph cuts. In ACM transactions on graphics (TOG) (Vol. 23, No. 3, pp. 309-314). ACM. [5] N. Dalal and B. Triggs, "Histograms of oriented gradients for human detection," in Computer Vision and Pattern Recognition, 2005. CVPR 2005. IEEE Computer Society Conference on, vol. 1. IEEE, 2005, pp. 886­893. [6] M. Haghighat, S. Zonouz, and M. Abdel-Mottaleb, "Identification using encrypted biometrics," in Computer Analysis of Images and Patterns. Springer, 2013, pp. 440­448.
23

Acknowledgment
Dr. Petteri Nurmi for shepherding out paper Dr. Meg Bruening for her insights on diet monitoring NSF IIS 1116385 NIBIB EB019202 GPSA for supporting the conference travel grant

24

25

